#### 第8章：信道——信号传输的舞台 🌌

我们通信故事的核心，就是信号如何从信源（Source）成功抵达信宿（Destination）。而这段旅程所经过的路径，就是**信道 (Channel)**。

■ **通信原理的核心思想** 🎯
一言以蔽之：在**给定**一个信道的前提下，通过精心**设计**编码与调制方案，来实现信源与信宿之间**可靠**且**高效**的通信。

![](Pic/Pasted%20image%2020250612205223.png)

本章主要探讨两个核心问题：
*   信道对信号做了什么？ ➡️ **信道模型 (Channel Model)**
*   信道的传输能力有多强？ ➡️ **信道容量 (Channel Capacity)**

##### 1. 信道的不同视角 👀

**a. 物理视角 🔭**
从物理层面看，信道是传输信号的**物理媒介**。

*   **信号的物理形态**: 电压、电流、电磁波、光、声波等。
*   **信道的物理形态**:
    *   **有线信道**: 导线、电缆、波导、光纤等。
    *   **无线信道**: 无线电波、可见光、水声等。无线信道还受到频段（中波、短波、微波...）和复杂传播环境（多普勒、反射、散射、绕射...）的影响。
*   从这个角度看的信道，也称为**狭义信道**。

**b. 数学视角 📐**
从数学层面看，我们不关心信道的具体物理实现，而是把它看作一个**黑箱 (Black Box)**，它对输入信号进行某种变换，然后产生输出信号。

*   信道是一个 **Transformer**。
*   这个变换过程被描述为**信道的数学模型**，它决定了信道的特性。模型可以是：
    *   **确定映射**: 输出由输入唯一确定。
    *   **随机映射**: 输出是与输入相关的随机变量（更常见）。
*   信道的数学模型是进行通信系统设计和性能分析的基础。

##### 2. 信道的分类与模型 🧩

**a. 广义信道 (Generalized Channel)**
在研究不同问题时，我们关注的“信道”范围也不同。广义信道指从研究者定义的“发端”到“收端”之间的一切环节。
![](Pic/Pasted%20image%2020250612205420.png)

**b. 按时间特性分类**

*   **时间连续信道 (波形信道/模拟信道)**: 输入输出都是连续时间波形，如 $X(t)$ 和 $Y(t)$。
*   **时间离散信道**: 输入输出都是离散时间序列，如 $\{X_n\}$ 和 $\{Y_n\}$。

> **知识回顾** 🧠：根据**奈奎斯特采样定理**，一个带宽受限的波形信道可以等价为一个时间离散信道，这为我们用数字方法分析和处理模拟信号提供了理论基础。
> $$ X(t) = \sum_{n=-\infty}^{\infty} X_n \text{sinc}(2Wt-n) $$

**c. 按记忆性分类**

*   **无记忆信道 (Memoryless Channel)**: 当前的输出 $y_n$ **只**与当前的输入 $x_n$ 有关。
    *   其特性可用**转移概率**来描述。对于时不变无记忆信道，转移概率与时间 $n$ 无关，可记为 $P(y|x)$ (离散取值) 或 $p(y|x)$ (连续取值)。
*   **有记忆信道 (Channel with Memory)**: 当前的输出 $y_n$ 与当前及**过去**的多个输入 $\{x_k\}$ 都有关。例如，由多径传播引起的**码间串扰 (ISI)** 就是有记忆信道的一种典型表现。

##### 3. 几种重要的信道模型 ⭐

**模型一：二元对称信道 (Binary Symmetric Channel, BSC)**
这是最经典的离散无记忆信道模型。

*   **输入/输出**: 都是二进制集合 $\{0, 1\}$。
*   **特性**: 传输发生错误的概率是固定的，且与传输的是'0'还是'1'无关。
    *   “0”传成“1”的概率 = “1”传成“0”的概率 = $\mu$ (交叉概率/误比特率BER)。
    *   正确传输的概率 = $1-\mu$。
* ![](Pic/Pasted%20image%2020250612211704.png)
*   **数学模型**: $Y = X + Z \pmod 2$，其中 $Z$ 是一个与 $X$ 独立的二进制随机变量，$P(Z=1) = \mu$ 代表错误发生。

**模型二：加性高斯白噪声信道 (AWGN Channel)**
这是最基本、最重要的波形信道模型。

*   **特性**: 信号通过信道时，唯一的影响是被叠加上了一个功率谱密度为常数（白噪声）、幅度服从高斯分布（高斯噪声）的噪声。
*   **时间连续AWGN信道**: $Y(t) = X(t) + n_w(t)$
*   **限带AWGN信道**: 信号和噪声的带宽都被限制在 $B$ 以内。噪声功率为 $\sigma^2 = N_0 B$。
*   **时间离散AWGN信道**: 对限带AWGN信道按奈奎斯特速率采样得到。
    $$ Y_k = X_k + n_k $$
    其中 $\{n_k\}$ 是独立同分布的高斯随机变量序列，服从 $N(0, \sigma^2)$。

**模型三：无线衰落信道 (Wireless Fading Channel)**
无线信道除了噪声，还存在由多径传播引起的信号幅度和相位的随机变化，即**衰落**。

*   **模型**: 可建模为一个**线性时变系统**，其特性由时变传递函数 $H(f,t)$ 描述。
    $$ r(t) = (x * h)(t, \tau) + n(t) $$
*   **分类**:
    *   **平衰落 (Flat Fading)**: $H(f,t)$ 不随频率 $f$ 变化，信号所有频率分量经历相同的衰落。
    *   **频率选择性衰落 (Frequency-Selective Fading)**: $H(f,t)$ 随频率 $f$ 变化，不同频率分量经历不同衰落，这会导致**码间串扰 (ISI)**。

##### 4. 信道容量 (Channel Capacity) 🚀

信道容量是衡量信道传输能力极限的终极指标。

*   **定义**: 信道容量 $C$ 定义为信道输入 $X$ 与输出 $Y$ 之间**互信息 $I(X;Y)$ 的最大值**。这个最大值是通过优化输入信号的概率分布 $P(X)$ 来实现的。
    $$ C = \max_{P(X)} \{I(X;Y)\} $$
    单位通常是 **bit/symbol** (离散信道) 或 **bit/second** (波形信道)。

*   **香农第二定理 (信道编码定理)**
    这是一个里程碑式的定理，它揭示了信道容量的深刻物理意义。

    > $$\boxed{
     \begin{aligned}
     & \text{1. 如果信息传输速率 } R < C \text{，则一定存在一种编码方式，} \\
     & \text{   使得信息传输的错误率可以任意小 (趋近于零)。} \\
     & \text{2. 如果信息传输速率 } R > C \text{，则不可能实现任意小的错误率。}
     \end{aligned}
     }$$

    简单说，**信道容量C是该信道上可以实现无差错传输的最大速率**。

**a. BSC信道容量的计算**
对于BSC信道，其容量为：
$$ C = 1 - H_b(\mu) \quad [\text{bit/symbol}] $$
其中 $H_b(\mu) = -\mu \log_2(\mu) - (1-\mu)\log_2(1-\mu)$ 是**二元熵函数**。
*   **意义**: 即使信道的误比特率 $\mu > 0$，只要我们的码率 $R = k/n < C$，理论上总能找到一种编码方法，使得最终译码错误率任意小。

**b. AWGN信道容量的计算 (香农公式)**
对于一个带宽为 $B$，信号功率为 $S$，噪声单边功率谱密度为 $N_0$ 的AWGN信道，其容量由著名的**香农公式**给出：

> $$\boxed{
 C = B \log_2\left(1 + \frac{S}{N_0 B}\right) \quad [\text{bit/s}]
 }$$

这里的 $S/(N_0 B)$ 就是信道的**信噪比 (SNR)**。

*   **关键结论**:
    1.  **带宽 $B$** 和 **信噪比 SNR** 是决定信道容量的两个关键资源，可以相互置换。
    2.  即使信号功率很小，只要我们有无限的带宽，理论上也能获得任意大的容量。
    3.  即使带宽有限，只要我们能提供足够高的信噪比，也能获得很高的容量。

*   **香农极限 (Shannon Limit)**
    为了实现可靠通信（$C > 0$），每比特能量与噪声功率谱密度之比 $E_b/N_0$ 必须满足一个下限。这个极限值是：
    $$ \frac{E_b}{N_0} \ge \ln 2 \approx 0.693 \implies -1.6 \text{ dB} $$
    这意味着，任何通信系统，如果其 $E_b/N_0$ 低于-1.6dB，就不可能实现可靠通信。这个值是所有通信工程师追求的理论极限。

![](Pic/Pasted%20image%2020250612213456.png)

---

#### 第9章：差错控制编码——与错误作斗争 🛡️

信道编码，也叫**差错控制编码 (Error Control Coding)**，其目的就是通过在原始信息中增加一些冗余信息（校验位），把一个**不可靠**的信道（如BSC）变成一个对上层应用来说**可靠**的信道。
![](Pic/Pasted%20image%2020250612214602.png)
##### 1. 数学基础：有限域 GF(2)

编码理论的数学基石是**有限域 (Finite Field)**，也称**伽罗华域 (Galois Field)**。最简单的就是**二元域 GF(2)**。

*   **元素**: $\{0, 1\}$
*   **运算**:
    *   **加法**: 模2加 (异或 XOR, $\oplus$)  
        $0+0=0, 0+1=1, 1+0=1, \mathbf{1+1=0}$
    *   **乘法**: 普通乘法 (与 AND)  
        $0 \times 0=0, 0 \times 1=0, 1 \times 0=0, 1 \times 1=1$

##### 2. 编码的基本概念 💡

*   **系统模型**:
    ![](Pic/Pasted%20image%2020250612214848.png)
    *   **信息向量 $\mathbf{u}$**: 长度为 $k$ 的原始信息比特。
    *   **编码器 $f_{enc}$**: 将 $k$ 比特信息映射为 $n$ 比特码字。
    *   **码字 (Codeword) $\mathbf{c}$**: 长度为 $n$ 的编码后比特 ($n>k$)。
    *   **码本 (Codebook) $C$**: 所有可能码字的集合，共有 $M=2^n$ 个码字。
    *   **错误图样 (Error Pattern) $\mathbf{e}$**: 长度为 $n$ 的向量，'1'表示该位置出错。
    *   **接收向量 $\mathbf{y}$**: $\mathbf{y} = \mathbf{c} + \mathbf{e}$ (在GF(2)中)。
*   **码率 (Code Rate)**: $R = k/n$，衡量编码效率。
*   **汉明重量 $w(\mathbf{c})$**: 码字 $\mathbf{c}$ 中 "1" 的个数。
*   **汉明距离 $d(\mathbf{c}_1, \mathbf{c}_2)$**: 两个码字 $\mathbf{c}_1, \mathbf{c}_2$ 对应位置上不同比特的个数。  
    **重要关系**: $d(\mathbf{c}_1, \mathbf{c}_2) = w(\mathbf{c}_1 + \mathbf{c}_2)$。
*   **最小码距 $d_{min}$**: 码本中**任意两个不同码字之间**的汉明距离的最小值。

> **星座图 vs. 码本** 🌟
>
> *   **调制 (AWGN信道)**: 信号是星座图中的点，性能由**最小欧氏距离**决定。
> *   **编码 (BSC信道)**: 信号是码本中的码字，性能由**最小汉明距离**决定。

*   **纠错能力**
    一个码的最小码距 $d_{min}$ 决定了它的纠错和检错能力。

    > $$\boxed{
     \begin{aligned}
     & \text{为纠正 } t \text{ 个错误，需要 } d_{min} \ge 2t+1 \\
     & \text{为检测 } t \text{ 个错误，需要 } d_{min} \ge t+1
     \end{aligned}
     }$$

    ![](Pic/Pasted%20image%2020250612215502.png)
    **直观理解**: 以每个码字为中心，画一个半径为 $t$ 的“球”（汉明球）。要能纠正 $t$ 个错，这些球之间必须不能重叠。

##### 3. 重要的编码类型 🛠️

**a. 线性分组码 (Linear Block Codes)**
这类码的编码过程是一个线性变换，可以用矩阵表示： $\mathbf{c} = \mathbf{u} \cdot \mathbf{G}$。

*   **生成矩阵 (Generator Matrix) $\mathbf{G}$**: 一个 $k \times n$ 的矩阵。
*   **性质**:
    1.  全零码字 $\mathbf{0}$ 一定是码本中的一个码字。
    2.  任意两个码字的和仍然是一个码字（对加法封闭）。
    3.  最小码距 $d_{min}$ 等于**所有非零码字**的最小汉明重量。
*   **校验矩阵 (Parity-Check Matrix) $\mathbf{H}$**: 一个 $(n-k) \times n$ 的矩阵，所有码字 $\mathbf{c}$ 都满足 $\mathbf{H} \cdot \mathbf{c}^T = \mathbf{0}$。
    *   **用途**: $\mathbf{G}$ 用于**编码**，$\mathbf{H}$ 用于**译码**时进行错误校验。收到 $\mathbf{y}$后，计算**校验子 (Syndrome)** $\mathbf{s} = \mathbf{H} \cdot \mathbf{y}^T$。若 $\mathbf{s} \ne \mathbf{0}$，则说明传输有误。

*   **系统码 (Systematic Codes)**
    码字可以直接分为信息位和校验位：$\mathbf{c} = (\mathbf{u}, \mathbf{p})$。其生成矩阵和校验矩阵有特殊结构：
    $$ \mathbf{G} = [\mathbf{I}_k | \mathbf{Q}] \quad \text{和} \quad \mathbf{H} = [-\mathbf{Q}^T | \mathbf{I}_{n-k}] = [\mathbf{Q}^T | \mathbf{I}_{n-k}] \pmod 2 $$
    其中 $\mathbf{p} = \mathbf{u} \cdot \mathbf{Q}$。
一个线性分组码的最小码距 d，等于其校验矩阵 H 中，线性相关的最小列数。
**b. 循环码 (Cyclic Codes)**
一类特殊的线性分组码，具有**循环特性**：一个码字循环移位后，仍然是码本中的一个码字。

*   **表示**: 常用多项式来表示码字，如 $c(x) = c_{n-1}x^{n-1} + \dots + c_1x + c_0$。
*   **生成多项式 $g(x)$**:
    1.  每个码字多项式 $c(x)$ 都是 $g(x)$ 的倍式。
    2.  $g(x)$ 的次数为 $n-k$。
    3.  $g(x)$ 是 $x^n+1$ 的一个因子。
*   **编码**: (系统码) 将信息多项式 $u(x)$ 乘以 $x^{n-k}$，然后除以 $g(x)$，得到的**余式**就是校验位多项式 $p(x)$。
* ![](Pic/Pasted%20image%2020250612220848.png)
*   **优点**: 编码和译码电路可以用简单的移位寄存器实现，非常高效。
*   **CRC (循环冗余校验)** 不是循环码，是线性分组码。

**c. 卷积码 (Convolutional Codes)**
与分组码不同，卷积码的编码过程是连续的，编码器有**记忆**。

*   **编码器**: 由带反馈的移位寄存器构成，可以看作是一个或多个**FIR滤波器**。
*   **参数**: $(n, k, K)$，其中 $k$ 是输入比特数， $n$ 是输出比特数，$K$ 是约束长度（表示记忆深度）。
*   **表示方法**:
    1.  **状态转移图**: 描述了编码器在不同输入下状态如何跳转及对应的输出。
    2.  **树图**: 将状态转移按时间展开。
    3.  **格图 (Trellis)**: 将树图中相同状态的节点合并，是卷积码最重要和最直观的表示方法，也是**维特比译码 (Viterbi Algorithm)** 的基础。

**d. 交织 (Interleaving)** 🃏
*   **问题**: 实际信道中，错误常常是**突发**的（连续多个比特出错），而多数纠错码对**随机**（独立）错误效果更好。
*   **解决方案**: **交织**。
    *   **发送端**: 将编码后的数据流“洗牌”，打乱其顺序。
    *   **接收端**: 进行逆向操作（反交织），恢复原始顺序。
*   **效果**: 信道中的一段**突发错误**，经过反交织后，会变成**分散的单个错误**，从而落入纠错码的纠正能力范围之内。

---

#### 第10章：扩频通信——隐身与抗扰的艺术 🕵️‍♂️

**扩频通信 (Spread Spectrum)** 是一种特殊的调制技术，它将信号的带宽**主动地、人为地**扩展到远大于其原始信息所需带宽的程度。

*   **核心操作**: 在发送端用一个高速的**伪随机码 (PN code)** 去“调制”原始信息信号，在接收端用**同步**的同一个PN码去解扩。
    *   **发送**: $b(t) = d(t) \cdot c(t)$ (信号 $\times$ 扩频码)
    *   **接收**: $d(t) = b(t) \cdot c(t) = d(t) \cdot c^2(t) = d(t)$  (因为 $c(t)$ 是 $\pm 1$ 序列, $c^2(t)=1$)
![](Pic/Pasted%20image%2020250613130431.png)

*扩频后，信号功率谱密度降低，淹没在噪声中，但总功率不变。*

**■ 为什么要扩频？**
1.  **信号隐藏/低截获概率 (LPI)**: 信号功率谱密度被展宽摊薄，可以低于噪声水平，使敌方难以发现。
2.  **抗干扰 (Anti-Jamming)**:
    *   在接收端，有用信号被解扩，能量集中回窄带。
    *   而窄带干扰信号则被扩频码**展宽**，其大部分能量会被后续的窄带滤波器滤除，从而大大提高了信干比。
3.  **抗多径衰落**: 扩频提供了频率分集，能有效抵抗频率选择性衰落。
4.  **码分多址 (CDMA)**: 为每个用户分配一个**相互正交**的扩频码。所有用户可以在相同的时间、相同的频率上传输信号。接收机通过其特有的扩频码，可以从混合信号中“提取”出自己想要的用户信号，而将其他用户信号视为噪声并加以抑制。

**■ 扩频码 (PN序列)**
扩频通信的性能严重依赖于扩频码的特性。它不是真正的随机序列，而是具有良好随机特性的**确定性序列**。

*   **理想特性**:
    1.  **长周期**: 理想为无限不循环。
    2.  **平衡性**: 序列中 '0' 和 '1' (或 '+1' 和 '-1') 的个数大致相等。
    3.  **尖锐的自相关函数**: 序列与其自身移位后的相关性，在零移位时为最大值，在非零移位时非常小。这是实现精确同步和抗多径的关键。
*   **典型例子**: **m序列 (Maximum Length Sequence)**，由线性反馈移位寄存器 (LFSR) 产生。
![](Pic/Pasted%20image%2020250613125223.png)

---

#### 第11章：OFDM——高速公路上的并行车道 🚗🚗🚗

**■ 问题提出**
随着数据速率的提高，符号间隔 $T_s$ 变得越来越短。在多径信道中，当多径时延扩展与 $T_s$ 相当或更大时，会产生严重的**码间串扰 (ISI)**，导致通信失败。

![](Pic/Pasted%20image%2020250613130533.png)
*高速率下，多径时延导致眼图完全闭合。*

**■ 解决方案：多载波并行传输**
*   **核心思想**: 与其在一个很宽的频带上高速传输（容易产生ISI），不如将这个宽带划分成**大量**的窄带**子信道**，在每个子信道上低速传输。
    *   **低速传输** $\implies$ **符号间隔 $T_s$ 很长**。
    *   只要 $T_s$ 远大于信道的多径时延扩展，ISI的影响就可以忽略不计。

**■ 正交频分复用 (Orthogonal Frequency Division Multiplexing, OFDM)**
OFDM 是多载波传输的一种高效实现方式。

*   **FDM vs. OFDM**:
    *   **传统FDM**: 各个子载波之间需要设置**保护带 (Guard Band)** 以免相互干扰，导致频谱利用率不高。
    *   **OFDM**: 子载波的频谱是**相互重叠**的，但通过精心设计，它们在数学上是**正交**的。这使得OFDM在不使用保护带的情况下也能分离信号，大大提高了频谱效率。

![](Pic/Pasted%20image%2020250613130746.png)
*OFDM的频谱像sinc函数，在每个子载波的中心频率处，其他所有子载波的频谱值都恰好为零，从而实现正交。*

*   **用 IFFT/FFT 实现**
    OFDM的调制和解调过程在数学上分别等价于**离散傅里叶逆变换 (IDFT)** 和 **离散傅里叶变换 (DFT)**。这两种运算都可以用**快速傅里叶变换 (FFT)** 算法高效实现。

    *   **发送端**: 将要发送的QAM/PSK符号序列作为频域信号，通过 **IFFT** 变换到时域，生成OFDM信号。
    *   **接收端**: 将收到的时域信号通过 **FFT** 变换回频域，恢复出原始的QAM/PSK符号。


**■ 克服多径：循环前缀 (Cyclic Prefix, CP)** 🛡️
*   **问题**: 尽管每个子载波上的ISI可以忽略，但多径时延会破坏子载波之间的**正交性**，导致**子载波间干扰 (ICI)**。
*   **解决方案**: **循环前缀 (CP)**。
    *   在发送每个OFDM符号之前，将该符号**尾部的一小段**复制到其**头部**。
    *   这个头部冗余部分就叫CP，其长度 $T_g$ 一般要大于信道的最大时延扩展。
*   **作用**:
    1.  **提供保护间隔**: 吸收多径带来的ISI和ICI，只要在接收端FFT处理窗口内，信号仍然保持正交性。
    2.  **将线性卷积变为循环卷积**: 使得信道的影响在频域上可以简单地用乘积来表示，极大地简化了均衡的复杂度。

**■ OFDM的缺点**
1.  **高峰均功率比 (PAPR)**: 信号包络起伏大，对功放的线性度要求高。
2.  **对频率和定时偏差敏感**: 微小的载波频率偏移或定时错误都会破坏子载波的正交性，导致性能急剧下降。