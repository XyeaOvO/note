# 5.3 AWGN信道下数字基带信号的接收

#### 数字通信系统的KPI (关键绩效指标) 📊

*   **发端**的关键是如何设计波形，主要看发送信号的**频谱特性**如何 $\rightarrow$ **效率** (例如: 带宽效率)
*   **收端**的关键是如何识别波形，主要看识别的**正确率**如何 $\rightarrow$ **质量** (例如: 误比特率)

**基本流程:**
$1011001\dots \xrightarrow{\text{波形设计 (signaling)}} \text{信号} \xrightarrow{\text{波形传输 (channel)}} \text{含噪信号} \xrightarrow{\text{波形识别 (detection)}} 1011001\dots$
*   波形设计关注：发送功率谱密度
*   波形识别关注：差错率

#### 误比特率 (Bit Error Rate, BER) 分析 📉

*   对于二进制通信，传输 $K$ 个比特是将“传输1个比特”这个行为执行了 $K$ 次。
*   假设各次传输互不影响，则 $K$ 次传输是 $K$ 次独立的随机试验。
*   发端发送 $s_1(t)$ 或 $s_2(t)$ 以表示1或0。收端收到被噪声污染的信号 $r(t)$，需要通过“波形识别”来辨明发端发送的是 $s_1(t)$ 还是 $s_2(t)$。

**模型:**
$s_1(t) \text{或} s_2(t) \xrightarrow{+} r(t) \xrightarrow{\text{波形识别}} 1 \text{或} 0$
$\quad\quad\quad\quad \uparrow n_w(t) \text{ (AWGN噪声)}$

#### 思考: 如何接收PAM信号? 🤔

*   考虑二进制PAM (2PAM)，$s_1(t)$、$s_2(t)$ 是同一波形 $g(t)$ 不同幅度：
    $$
    \begin{cases}
    s_1(t) = A_1 g(t), \text{发1} \\
    s_2(t) = A_2 g(t), \text{发0}
    \end{cases}
    $$
*   接收信号是发送波形叠加噪声：$r(t) = s_i(t) + n_w(t)$ (例如，若发送 $s_1(t)$, 则 $r(t) = A_1 g(t) + n_w(t)$)
*   **关键问题**: 接收端如何得知所收信号 $r(t)$ 中含的 $g(t)$ 有多大? $\rightarrow$ **求内积**
*   **方法原理**: 若 $a(t) = c \cdot b(t) + z(t)$，$c$ 反映 $a(t)$ 包含了多少 $b(t)$，$c$ 的大小体现在 $a(t)$ 与 $b(t)$ 的内积中：
    $$
    \int_{-\infty}^{\infty} a(t)b(t)dt = c \cdot \int_{-\infty}^{\infty} b^2(t)dt + \int_{-\infty}^{\infty} z(t)b(t)dt = c \cdot E_b + E_{zb}
    $$
    其中 $E_b$ 是信号 $b(t)$ 的能量。

*   由此可推出2PAM的接收方式如下图所示（相关器）：
    $r(t) \xrightarrow{\otimes} \int_{-\infty}^{\infty} (\cdot) dt \xrightarrow{\text{判决}} \text{输出}$
    $\quad\quad\quad \uparrow g(t)$
    相关器像是一个传感器，其输出的读数反映的是 $r(t)$ 中所包含的 $g(t)$ 的量。
*   图中的 $g(t)$ 乘以任意系数无实质性差别。若 $A_1 \neq 0$，可将 $g(t)$ 换成 $A_1 g(t) = s_1(t)$，相应的接收机如下（仍为相关器，只是参考信号变为 $s_1(t)$）：
    $r(t) \xrightarrow{\otimes} \int_{-\infty}^{\infty} (\cdot) dt \xrightarrow{\text{判决}} y \rightarrow \text{输出}$
    $\quad\quad\quad \uparrow s_1(t)$

*   相关器的功能可以用**匹配滤波器**来完成 ✨。
    $r(t) \xrightarrow{\text{匹配滤波器 } h(t)} \text{输出} \xrightarrow{\text{采样 (在 } t_0 \text{ 时刻)}} y \xrightarrow{\text{判决}} \text{输出}$
    其中的匹配滤波器对 $s_1(t)$ 匹配：
    $\boxed{h(t) = s_1(t_0 - t)}$
    匹配滤波器最佳采样点的输出为：
    $$
    y = \int_{-\infty}^{\infty} r(\tau)h(t_0 - \tau)d\tau = \int_{-\infty}^{\infty} r(\tau)s_1(\tau)d\tau
    $$
    第一个积分是**卷积**在 $t=t_0$ 的输出，第二个积分是**内积 (相关)**。

#### 错误率问题 😥

**接收模型:**
$s_1(t) \text{或} s_2(t) \xrightarrow{+} r(t) \xrightarrow{h(t)} \text{滤波输出} \xrightarrow{t_0 \text{采样}} y \xrightarrow{\text{判决 (与}V_T\text{比较)}} \text{输出}$
$\quad\quad\quad\quad \uparrow n_w(t)$

*   如果没有噪声，匹配滤波器采样输出 $y$ 与2PAM的两个幅度 $A_1, A_2$ (对应的信号能量) 成正比，接收端可以准确识别出发送的是哪个。
*   受AWGN的影响，$y$ 是**连续随机变量**，只能划一个门限 $V_T$ 来推断。
    $$
    \begin{cases}
    \text{if } y > V_T, \text{判定发} s_1 \\
    \text{if } y < V_T, \text{判定发} s_2
    \end{cases}
    $$
*   **错误率**:
    $P_e = P(\text{判决结果与实际发送不同})$
    $P_e = P(s_1)P(e|s_1) + P(s_2)P(e|s_2)$
    其中 $P(s_1)$ 和 $P(s_2)$ 是先验概率，$P(e|s_i)$ 是发送 $s_i$ 条件下判决错误的概率。

#### Case 1: 双极性NRZ的BER分析  bipolar NRZ ↕️

*   **系统模型**
    *   2PAM信号: $s_i(t)$
    *   $R_b = 1/T_b$, $0 \le t \le T_b$
    *   $s_1(t) = A$ (幅度为A的矩形脉冲，代表"1")
    *   $s_2(t) = -A$ (幅度为-A的矩形脉冲，代表"0")
    *   波形图 $g(t)$: 幅度为 $A$, 宽度为 $T_b$ 的矩形脉冲。
        $s_1(t) = g(t)$, "1" sent
        $s_2(t) = -g(t)$, "0" sent
    *   两种发送波形极性相反，有相同的能量 $E_1 = E_2 = E_b = \int_0^{T_b} A^2 dt = A^2 T_b$。
    *   接收信号 $r(t) = s_i(t) + n_w(t) = \begin{cases} A + n_w(t), & 0 \le t \le T_b \\ -A + n_w(t), & 0 \le t \le T_b \end{cases}$
    *   接收端结构: $r(t) \rightarrow \text{匹配滤波器} \rightarrow y(t) \xrightarrow{t=T_b \text{ 采样}} y \rightarrow \text{判决器} \rightarrow \text{输出}$ (判决门限为 $V_T$)

*   **判决量分析**
    *   匹配滤波器对 $g(t)$ (即幅度为A的矩形脉冲) 匹配。
        $h(t) = c \cdot g(t_0 - t)$。简单起见取 $c=1, t_0 = T_b$。
        则 $h(t) = g(T_b - t)$。这是一个幅度为 $A$, 从 $t=0$ 到 $t=T_b$ 的脉冲。
        能量 $E_h = E_g = E_b$ (这里 $g(t)$ 代表 $s_1(t)$)。
    *   匹配滤波器的输出 $y(t)$ 在 $t=T_b$ 时采样:
        $y(T_b) = \int_{-\infty}^{\infty} r(\tau)h(T_b - \tau)d\tau = \int_{-\infty}^{\infty} r(\tau)g(\tau)d\tau$
        (假设 $g(t)$ 是幅度为1，能量为 $E_g'$ 的归一化脉冲，则 $s_1(t) = A g(t)$, $s_2(t) = -A g(t)$, $E_b = A^2 E_g'$.
        匹配滤波器 $h(T_b - \tau) = g(\tau)$.
        $y(T_b) = \int_0^{T_b} s_i(\tau)g(\tau)d\tau + \int_0^{T_b} n_w(\tau)g(\tau)d\tau$)
        按照幻灯片p10的表示, 若发送 $s_1(t)=g(t)$ (能量为 $E_b$), 匹配滤波器也用 $g(t)$ (能量为 $E_b$):
        $y(T_b) = \int_{-\infty}^{\infty} (\pm g(\tau) + n_w(\tau))g(\tau)d\tau = \pm \int_{-\infty}^{\infty} g^2(\tau)d\tau + \int_{-\infty}^{\infty} n_w(\tau)g(\tau)d\tau$
        $$
        y(T_b) = \begin{cases} +E_b + Z & \text{if } s_1(t) \text{ is sent} \\ -E_b + Z & \text{if } s_2(t) \text{ is sent} \end{cases}
        $$
        其中 $Z = \int_{-\infty}^{\infty} n_w(\tau)g(\tau)d\tau$。
        $n_w(t)$ 是均值为0，功率谱密度为 $N_0/2$ 的高斯白噪声。
        $E[Z] = 0$。
        $D[Z] = \sigma_Z^2 = E[Z^2] = E\left[\int\int n_w(\tau_1)g(\tau_1)n_w(\tau_2)g(\tau_2)d\tau_1 d\tau_2\right]$
        $= \int\int g(\tau_1)g(\tau_2)E[n_w(\tau_1)n_w(\tau_2)]d\tau_1 d\tau_2 = \int\int g(\tau_1)g(\tau_2)\frac{N_0}{2}\delta(\tau_1-\tau_2)d\tau_1 d\tau_2$
        $= \frac{N_0}{2}\int g^2(\tau)d\tau = \frac{N_0 E_g}{2} = \frac{N_0 E_b}{2}$。
        所以，判决量 $y \equiv y(T_b) \sim N(\pm E_b, \frac{N_0 E_b}{2})$。
        令 $\sigma^2 = \frac{N_0 E_b}{2}$。

*   **判决门限和误比特率 (BER)**
    *   判决规则: $y \underset{s_2}{\overset{s_1}{\gtrless}} V_T$
    *   发送 $s_1(t)$ 条件下，$y \sim N(E_b, \sigma^2)$。条件概率密度为:
        $p_1(y) \equiv p(y|s_1) = \frac{1}{\sqrt{2\pi}\sigma^2} e^{-\frac{(y-E_b)^2}{2\sigma^2}}$
        发送 $s_1(t)$，判决出错的概率 (判为 $s_2$):
        $P(e|s_1) = P(y < V_T | s_1) = \int_{-\infty}^{V_T} p_1(y)dy$
        回顾 🧠: Q函数 $Q(x) = \int_x^\infty \frac{1}{\sqrt{2\pi}} e^{-u^2/2}du$。若 $X \sim N(\mu, \sigma_x^2)$, 则 $P(X < V) = P(\frac{X-\mu}{\sigma_x} < \frac{V-\mu}{\sigma_x}) = \Phi(\frac{V-\mu}{\sigma_x}) = 1 - Q(\frac{V-\mu}{\sigma_x}) = Q(\frac{\mu-V}{\sigma_x})$。
        $P(e|s_1) = Q\left(\frac{E_b - V_T}{\sigma}\right) = \frac{1}{2}\text{erfc}\left(\frac{E_b - V_T}{\sqrt{2}\sigma}\right)$

    *   发送 $s_2(t)$ 条件下，$y \sim N(-E_b, \sigma^2)$。条件概率密度为:
        $p_2(y) \equiv p(y|s_2) = \frac{1}{\sqrt{2\pi}\sigma^2} e^{-\frac{(y+E_b)^2}{2\sigma^2}}$
        发送 $s_2(t)$，判决出错的概率 (判为 $s_1$):
        $P(e|s_2) = P(y > V_T | s_2) = \int_{V_T}^{\infty} p_2(y)dy = Q\left(\frac{V_T - (-E_b)}{\sigma}\right) = Q\left(\frac{V_T + E_b}{\sigma}\right) = \frac{1}{2}\text{erfc}\left(\frac{V_T + E_b}{\sqrt{2}\sigma}\right)$

    *   平均比特错误率:
        $P_b = P(s_1)P(e|s_1) + P(s_2)P(e|s_2)$
        $P_b = P(s_1)Q\left(\frac{E_b - V_T}{\sigma}\right) + P(s_2)Q\left(\frac{V_T + E_b}{\sigma}\right)$

    *   **使BER最小的 $V_T$ (最佳门限)**: $\frac{\partial P_b}{\partial V_T} = 0$
        $P(s_1)p(V_T|s_1) - P(s_2)p(V_T|s_2) = 0$ (利用 $Q'(x) = - \frac{1}{\sqrt{2\pi}}e^{-x^2/2}$)
        $P(s_1) \frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(V_T-E_b)^2}{2\sigma^2}} = P(s_2) \frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(V_T+E_b)^2}{2\sigma^2}}$
        $\ln\left(\frac{P(s_1)}{P(s_2)}\right) = \frac{(V_T-E_b)^2}{2\sigma^2} - \frac{(V_T+E_b)^2}{2\sigma^2} = \frac{1}{2\sigma^2}(-4V_T E_b)$
        $\boxed{V_T^{opt} = \frac{\sigma^2}{2E_b} \ln\left(\frac{P(s_2)}{P(s_1)}\right) = \frac{N_0 E_b/2}{2E_b} \ln\left(\frac{P(s_2)}{P(s_1)}\right) = \frac{N_0}{4} \ln\left(\frac{P(s_2)}{P(s_1)}\right)}$
        *   若 $P(s_1) = P(s_2) = 1/2$ (等概出现)，则 $\ln(1) = 0 \implies V_T^{opt} = 0$。接收端按极性判决。
        *   若 $P(s_2) > P(s_1)$, 则 $\ln(\cdot) > 0 \implies V_T^{opt} > 0$ (门限偏向 $s_1$ 一侧, 即更倾向于判为 $s_2$)
        *   若 $P(s_2) < P(s_1)$, 则 $\ln(\cdot) < 0 \implies V_T^{opt} < 0$ (门限偏向 $s_2$ 一侧, 即更倾向于判为 $s_1$)

*   **等概时的BER** (即 $P(s_1)=P(s_2)=1/2$, $V_T=0$)
    $P_b = \frac{1}{2}Q\left(\frac{E_b}{\sigma}\right) + \frac{1}{2}Q\left(\frac{E_b}{\sigma}\right) = Q\left(\frac{E_b}{\sigma}\right)$
    将 $\sigma = \sqrt{\frac{N_0 E_b}{2}}$ 代入:
    $P_b = Q\left(\frac{E_b}{\sqrt{N_0 E_b/2}}\right) = Q\left(\sqrt{\frac{2E_b}{N_0}}\right)$
    使用 $Q(x) = \frac{1}{2}\text{erfc}\left(\frac{x}{\sqrt{2}}\right)$:
    $\boxed{P_b = \frac{1}{2}\text{erfc}\left(\sqrt{\frac{E_b}{N_0}}\right)}$ (双极性NRZ, 等概)

#### Case 2: 单极性NRZ的BER分析 Unipolar NRZ ⏯️

*   **系统模型**
    *   在 $[0, T_b]$ 时间内，发端等概发送如下两个波形之一：
        $s_1(t) = A$ (幅度为A的矩形脉冲 $g(t)$, 代表"1")
        $s_2(t) = 0$ (代表"0")
    *   信号能量：$E_1 = \int_0^{T_b} A^2 dt = A^2 T_b$，$E_2 = 0$。
    *   **平均比特能量** $E_b = P(s_1)E_1 + P(s_2)E_2 = \frac{1}{2}E_1 + \frac{1}{2}(0) = \frac{1}{2}A^2 T_b$。
        因此 $E_1 = 2E_b$。
    *   接收信号 $r(t) = s_i(t) + n_w(t) = \begin{cases} A + n_w(t), & 0 \le t \le T_b \\ n_w(t), & 0 \le t \le T_b \end{cases}$

*   **判决量分析**
    *   匹配滤波器 $h(t) = g(t_0-t)$。这里 $g(t)$ 指的是 $s_1(t)$ (幅度为A的脉冲)。$t_0=T_b$。
    *   $y(T_b) = \int_0^{T_b} r(\tau)g(\tau)d\tau$ (这里 $g(\tau)$ 代表 $s_1(\tau)$)。
        $y(T_b) = \begin{cases} \int_0^{T_b} s_1(\tau)s_1(\tau)d\tau + \int_0^{T_b} n_w(\tau)s_1(\tau)d\tau = E_1 + Z' & \text{if } s_1(t) \text{ is sent} \\ \int_0^{T_b} s_2(\tau)s_1(\tau)d\tau + \int_0^{T_b} n_w(\tau)s_1(\tau)d\tau = 0 + Z' & \text{if } s_2(t) \text{ is sent} \end{cases}$
        其中 $Z' = \int_0^{T_b} n_w(\tau)s_1(\tau)d\tau$。
        $E[Z'] = 0$。
        $D[Z'] = \sigma'^2 = \frac{N_0 E_1}{2}$。
        用平均比特能量表示: $E_1 = 2E_b$, 所以 $\sigma'^2 = \frac{N_0 (2E_b)}{2} = N_0 E_b$。
        判决量 $y \equiv y(T_b)$:
        *   发送 $s_1$: $y \sim N(E_1, \sigma'^2) = N(2E_b, N_0 E_b)$
        *   发送 $s_2$: $y \sim N(0, \sigma'^2) = N(0, N_0 E_b)$

*   **平均BER** (等概情况 $P(s_1)=P(s_2)=0.5$)
    *   最佳门限 $V_T^{opt}$ 位于两个条件均值 $E_1$ 和 $0$ 的中间 (因为噪声方差相同且等概)：
        $V_T^{opt} = \frac{E_1 + 0}{2} = \frac{E_1}{2} = \frac{2E_b}{2} = E_b$。
    *   $P(e|s_1) = P(y < V_T | s_1) = Q\left(\frac{E_1 - V_T}{\sigma'}\right) = Q\left(\frac{E_1 - E_1/2}{\sqrt{N_0 E_1/2}}\right) = Q\left(\frac{E_1/2}{\sqrt{N_0 E_1/2}}\right) = Q\left(\sqrt{\frac{E_1}{2N_0}}\right)$
    *   $P(e|s_2) = P(y > V_T | s_2) = Q\left(\frac{V_T - 0}{\sigma'}\right) = Q\left(\frac{E_1/2}{\sqrt{N_0 E_1/2}}\right) = Q\left(\sqrt{\frac{E_1}{2N_0}}\right)$
    *   $P_b = \frac{1}{2}P(e|s_1) + \frac{1}{2}P(e|s_2) = Q\left(\sqrt{\frac{E_1}{2N_0}}\right)$
        代入 $E_1=2E_b$:
        $P_b = Q\left(\sqrt{\frac{2E_b}{2N_0}}\right) = Q\left(\sqrt{\frac{E_b}{N_0}}\right)$
        使用 $Q(x) = \frac{1}{2}\text{erfc}\left(\frac{x}{\sqrt{2}}\right)$:
        $\boxed{P_b = \frac{1}{2}\text{erfc}\left(\sqrt{\frac{E_b}{2N_0}}\right)}$ (单极性NRZ, 等概)

#### 2PAM一般情况下分析BER的思路 🗺️

1.  **确定匹配滤波器**: 根据发送信号波形确定其冲激响应 $h(t)$、最佳采样时刻 $t_0$。
2.  **确定判决量 $y$**: 计算在发送 $s_1(t)$ 或 $s_2(t)$ 条件下，采样时刻 $t_0$ 的匹配滤波器输出 $y$ 的条件均值、方差、概率密度函数。
3.  **确定判决门限 $V_T$**:
    *   平均BER是门限的函数。
    *   根据最小化平均BER准则确定最佳门限。
    *   等概时门限通常居中 (如果噪声影响对称)；非等概时，门限会偏向概率较小的信号，使得对概率较大的信号判决更有利。
4.  **确定BER**: 计算错误率 (噪声越过门限的概率)。

#### 双极性和单极性的BER比较 🆚

*   双极性NRZ (等概): $P_b = \frac{1}{2}\text{erfc}\left(\sqrt{\frac{E_b}{N_0}}\right)$
*   单极性NRZ (等概): $P_b = \frac{1}{2}\text{erfc}\left(\sqrt{\frac{E_b}{2N_0}}\right)$

📈 观察BER曲线图 (BER vs $E_b/N_0$ dB):
*   在相同的 $E_b/N_0$下，双极性NRZ的BER远小于单极性NRZ。
*   要达到相同的BER，双极性NRZ所需的 $E_b/N_0$ 比单极性NRZ小。
*   **双极性的性能比单极性好3dB**。例如，对于BER=$10^{-3}$：
    *   双极性需要的 $E_b/N_0 \approx 6.8 \text{ dB}$
    *   单极性需要的 $E_b/N_0 \approx 9.8 \text{ dB}$ (即 $6.8 \text{ dB} + 3 \text{ dB}$)

*   **原因分析** 💡:
    *   单极性信号 $(A, 0)$ 可以看作是双极性信号 $(A/2, -A/2)$ 叠加一个直流分量 $A/2$。
        $s_{\text{单}}(t) = a_{\text{单}} \cdot g'(t)$, 其中 $a_{\text{单}} \in \{A, 0\}$
        $s_{\text{双}}(t) = a_{\text{双}} \cdot g'(t)$, 其中 $a_{\text{双}} \in \{\pm A/2\}$ (假设 $g'(t)$ 为幅度为1的脉冲)
        $A \cdot g'(t) = (A/2) \cdot g'(t) + (A/2) \cdot g'(t)$
        $0 \cdot g'(t) = (-A/2) \cdot g'(t) + (A/2) \cdot g'(t)$
        所以 $s_{\text{单}}(t) = s'_{\text{双}}(t) + \frac{A}{2}g'(t)$
        $s'_{\text{双}}(t)$ 是幅度为 $\pm A/2$ 的双极性信号。
        $\frac{A}{2}g'(t)$ 是一个直流（固定）分量。
    *   **单极性信号有一半能量不携带信息** (用于维持那个直流分量)。这个直流分量在差分检测或交流耦合系统中会被滤除，但它在传输时消耗了功率。
    *   更直观地看，双极性信号 $A$ 和 $-A$ 之间的“距离”是 $2A$。单极性信号 $A$ 和 $0$ 之间的“距离”是 $A$。在相同的峰值功率下，双极性信号间的区分度更大。在相同的平均比特能量 $E_b$ 下，双极性信号两个符号间的欧氏距离的平方 $(2\sqrt{E_b})^2 = 4E_b$，而单极性信号两个符号间的欧氏距离的平方 $(\sqrt{2E_b}-0)^2=2E_b$。这导致了性能差异。

---