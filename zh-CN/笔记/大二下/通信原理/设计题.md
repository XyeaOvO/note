### **通信系统设计方案**

**设计目标:** 将一个带宽为7kHz-9kHz、幅值在[-1V, +1V]内均匀分布的模拟信号`x(t)`，通过一个6000kHz-6025kHz的短波信道进行数字传输，要求量化信噪比（SQNR）不低于45dB。

---

#### **一、 系统总体设计思路**

本设计采用脉冲编码调制（PCM）对模拟信号进行数字化，然后使用正交相移键控（QPSK）进行数字调制，最后将信号上变频至指定的短波信道进行传输。接收端进行相应的解调和解码，恢复出原始模拟信号。

**系统框图如下：**

*   **发送端:**
    
    `模拟信号源 -> 带通滤波器 -> 采样器 -> 量化器 -> 编码器 (PCM) -> QPSK调制器 -> 脉冲成型滤波器 -> 上变频器 -> 功率放大器 -> 天线`

*   **接收端:**
    
    `天线 -> 低噪声放大器 -> 下变频器 -> 匹配滤波器 -> QPSK解调器 -> PCM解码器 (D/A转换) -> 低通/带通重构滤波器 -> 输出信号`

---

#### **二、 关键参数设计与计算**

**1. 模拟信号预处理与采样**

*   **信号特性分析:**
    *   信号为带通信号，中心频率 `f_center = (7+9)/2 = 8` kHz。
    *   信号带宽 `W = 9 - 7 = 2` kHz。
*   **采样率 (fs) 的确定:**
    *   根据带通采样定理，对一个带宽为 `W` 的带通信号，最低采样率 `fs_min = 2W`。
    *   因此，理论最低采样率为 `fs_min = 2 * 2 kHz = 4` kSps (千样本/秒)。
    *   为了在实际系统中留有裕量，便于后续滤波器设计，我们选择一个稍高的采样率。**取 `fs = 5` kHz**。这个选择既满足了采样定理，又避免了因采样率过高（如采用奈奎斯特低通采样 `fs >= 2 * 9kHz = 18kHz`）而导致的数据率浪费。

**2. 量化与PCM编码**

*   **量化比特数 (v) 的确定:**
    *   **要求:** 量化信噪比 `SQNR >= 45` dB。
    *   **信号功率 (S):** 信号 `x(t)` 在 `[-1V, +1V]` 区间均匀分布，其概率密度函数 `p(x) = 1/2`。信号功率（即方差）为：
        `S = E[x^2] = ∫[-1,1] x^2 * p(x) dx = ∫[-1,1] x^2 * (1/2) dx = (1/2) * [x^3/3]|[-1,1] = 1/3` W。
    *   **量化噪声功率 (Nq):** 对于均匀量化器，量化噪声功率 `Nq = Δ^2 / 12`，其中 `Δ` 是量化阶距。对于 `v` 比特量化，量化电平数 `L = 2^v`，`Δ = (1 - (-1)) / L = 2 / L`。
        `Nq = (2/L)^2 / 12 = 4 / (12 * L^2) = 1 / (3 * L^2)`。
    *   **SQNR 计算:**
        `SQNR = S / Nq = (1/3) / (1 / (3 * L^2)) = L^2 = (2^v)^2 = 2^(2v)`。
    *   **转换为dB:**
        `SQNR_dB = 10 * log10(2^(2v)) = 20 * v * log10(2) ≈ 6.02 * v` dB。
    *   **求解 v:**
        `6.02 * v >= 45`
        `v >= 45 / 6.02 ≈ 7.47`
    *   由于比特数 `v` 必须为整数，我们向上取整，**选择 `v = 8` 比特/样本**。此时 `SQNR = 6.02 * 8 ≈ 48.16` dB，满足大于45dB的要求。

*   **系统比特率 (Rb) 的计算:**
    *   经过PCM编码后，系统的总信息比特率为：
        `Rb = fs * v = 5 kSps * 8 bit/sample = 40` kbps。

**3. 数字调制方案**

*   **信道特性分析:**
    *   可用信道带宽 `B_ch = 6025 kHz - 6000 kHz = 25` kHz。
*   **调制方式选择与带宽计算:**
    *   我们需要将 `Rb = 40` kbps 的数据流在 `B_ch = 25` kHz 的带宽内传输。
    *   已调信号的传输带宽 `B_T` 与符号速率 `Rs` 和滚降系数 `α` 相关：`B_T = (1 + α) * Rs`。
    *   符号速率 `Rs = Rb / log2(M)`，其中 `M` 是调制阶数。
    *   因此，`B_T = (1 + α) * Rb / log2(M)`。
    *   我们选择一个工程上常用的滚降系数 `α = 0.25` 的升余弦滤波器进行脉冲成型，以减少码间串扰并有效利用频谱。
    *   将已知数值代入 `B_T <= B_ch` 的约束条件：
        `(1 + 0.25) * 40 kbps / log2(M) <= 25 kHz`
        `1.25 * 40 / log2(M) <= 25`
        `50 / log2(M) <= 25`
        `log2(M) >= 50 / 25 = 2`
    *   这意味着 `M` 必须大于等于4。为了在满足带宽要求的同时，保证系统的功率效率和抗噪性能，我们选择最低阶的 `M=4` 调制方式。
    *   **选择调制方式：QPSK (4-PSK)**。
        *   `M=4`，每个符号携带 `k = log2(4) = 2` 比特信息。
        *   **符号速率 (Rs):** `Rs = Rb / k = 40 kbps / 2 = 20` kbaud。
        *   **所需传输带宽 (BT):** `BT = (1 + α) * Rs = (1 + 0.25) * 20 kbaud = 25` kHz。
    *   这个结果 `BT = 25` kHz 恰好等于可用的信道带宽 `B_ch`，说明我们的设计是频谱高效且可行的。

**4. 载波调制**

*   **载波频率 (fc) 的确定:**
    *   为了使已调信号的频谱完全落在给定的信道频带内，我们将载波频率设置在信道中心。
    *   `fc = (6000 + 6025) / 2 = 6012.5` kHz。
*   **频谱位置:**
    *   QPSK信号上变频后，其频谱将占据 `fc ± BT/2` 的范围，即 `6012.5 kHz ± 12.5 kHz`，也就是 `6000 kHz` 到 `6025 kHz`，与信道频带完全匹配。

---

#### **三、 设计方案总结**

| 参数 | 设计值 | 设计依据 |
| :--- | :--- | :--- |
| **采样频率 (fs)** | 5 kHz | 带通采样定理 (`fs >= 2W = 4kHz`) |
| **量化比特数 (v)** | 8 比特/样本 | SQNR 要求 (`>= 45dB`) |
| **信息比特率 (Rb)** | 40 kbps | `Rb = fs * v` |
| **数字调制方式** | QPSK (M=4) | 满足带宽约束，兼顾性能与复杂度 |
| **符号速率 (Rs)** | 20 kbaud | `Rs = Rb / log2(M)` |
| **脉冲成型** | 升余弦滚降滤波器 (α=0.25) | 减小码间串扰，有效利用带宽 |
| **传输带宽 (BT)** | 25 kHz | `BT = (1+α)Rs`，恰好等于信道带宽 |
| **载波频率 (fc)** | 6012.5 kHz | 将信号频谱置于信道中心 |

---

#### **四、 优缺点分析**

**优点:**

1.  **满足所有指标：** 本设计方案严格按照题目要求，满足了量化信噪比不低于45dB和在指定信道内传输的技术指标。
2.  **频谱效率高：** 通过精确计算，选用的QPSK调制和脉冲成型参数，使得信号带宽恰好等于信道带宽，实现了对频谱资源的高效利用。
3.  **方案合理且主流：** 采用的PCM+QPSK是数字通信中非常经典和成熟的方案，技术实现难度适中，性能稳定。
4.  **数据率优化：** 采用带通采样而非低通采样，显著降低了采样率和最终的比特率，减轻了后续数字处理和传输的负担。

**缺点:**

1.  **对信道变化的敏感性：** 短波信道通常存在严重的衰落、多径效应和噪声干扰。本基础设计未包含信道编码（如卷积码、Turbo码）和均衡等抗衰落措施，在实际恶劣信道下性能可能会急剧下降。
2.  **同步要求高：** QPSK是相干解调，接收端需要精确恢复载波的频率和相位，以及符号的定时。在移动或变化的短波信道中，载波和符号同步环路的设计会比较复杂。
3.  **对功放线性度有要求：** 经过升余弦滤波后的QPSK信号不再是恒定包络，若使用非线性功率放大器，会产生频谱再生（spectral regrowth）和信号失真，干扰邻近信道。因此需要使用线性度较好的功放，但这通常会牺牲功率效率。
4.  **未考虑实际裕量：** 设计中假设了理想的滤波器和信道条件，实际工程中通常会预留更多的带宽裕量和性能裕量（例如选择更高的采样率或使用更强的信道编码）。