# 5.2 数字脉冲幅度调制 (PAM) 📈

数字脉冲幅度调制（Pulse Amplitude Modulation, PAM）是一种基本的数字基带传输技术。

### PAM信号

*   **M进制通信**：需要设计 $M$ 种不同的波形 $s_1(t), s_2(t), \dots, s_M(t)$ 来传输 $k = \log_2 M$ 个比特。
*   **脉冲幅度调制 (PAM)**：将 $M$ 个波形设计为**形状相同、幅度不同**：
    $s_i(t) = A_i g(t)$, 其中 $i=1, \dots, M$
    $A_i$ 是幅度， $g(t)$ 是基本脉冲形状。

*   **示例**：某4进制PAM系统（$M=4$，传输 $k=\log_2 4 = 2$ bit）。
    *   四个波形具有相同的形状 $g(t)$（例如三角脉冲）。
    *   设计四种幅度 $\{A_1, A_2, A_3, A_4\} = \{-3, -1, +1, +3\}$ 来传输2bit。
    *   所形成的4种波形为：
        *   $s_1(t) = -3g(t)$  (例如，代表比特 `00`)
        *   $s_2(t) = -1g(t)$  (例如，代表比特 `01`)
        *   $s_3(t) = +1g(t)$  (例如，代表比特 `10`)
        *   $s_4(t) = +3g(t)$  (例如，代表比特 `11`)
    *   其中 $g(t)$ 是一个在 $(0, T_s)$ 区间内非零的脉冲。

![](Pic/Pasted%20image%2020250506223053.png)

*   **发送PAM信号序列**：
    若要发送一串比特，例如12个比特 `00 10 11 11 00 01`。
    使用上述4进制PAM，每2个比特映射为一个幅度值。
    `00` $\rightarrow -3$
    `10` $\rightarrow +1$
    `11` $\rightarrow +3$
    `11` $\rightarrow +3$
    `00` $\rightarrow -3$
    `01` $\rightarrow -1$
    得到6个幅度值序列 $a_0, a_1, \dots, a_5 = \{-3, +1, +3, +3, -3, -1\}$。
    发送的PAM信号为：
    $s(t) = a_0 g(t) + a_1 g(t-T_s) + a_2 g(t-2T_s) + a_3 g(t-3T_s) + a_4 g(t-4T_s) + a_5 g(t-5T_s)$
    $s(t) = -3g(t) + 1g(t-T_s) + 3g(t-2T_s) + 3g(t-3T_s) -3g(t-4T_s) -1g(t-5T_s)$

*   **一般情况** 📝：
    一个PAM信号可以表示为一系列幅度调制的脉冲之和：
    $$s(t) = \sum_{n=-\infty}^{\infty} a_n g(t - nT_s)$$
    其中：
    *   $a_n$ 是第 $n$ 个符号的幅度，取自集合 $\{A_1, A_2, \dots, A_M\}$。
    *   $g(t)$ 是基本脉冲波形。
    *   $T_s$ 是符号周期。

### PAM信号的模型 🛠️

PAM信号可建模为：
一个幅度序列 $\{a_n\}$ 形成的脉冲序列 $d(t)$ 通过一个线性滤波器 $g(t)$。
$$d(t) = \sum_{n=-\infty}^{\infty} a_n \delta(t - nT_s)$$
通过具有冲激响应 $g(t)$ 的滤波器后，输出为：
$$s(t) = d(t) * g(t) = \sum_{n=-\infty}^{\infty} a_n g(t - nT_s)$$

*   $g(t)$ 决定发送信号的**脉冲形状**，称该滤波器为**脉冲成形 (pulse shaping)** 滤波器。
*   $G(f) = \mathcal{F}\{g(t)\}$ 决定发送信号的**功率谱密度**，称该滤波器为**频谱成形 (spectrum shaping)** 滤波器。
*   若 $d(t)$ 的功率谱密度为 $P_d(f)$，则 $s(t)$ 的功率谱密度为：
    $\boxed{P_s(f) = |G(f)|^2 P_d(f)}$

### PAM系统 🏗️

一个典型的PAM通信系统框图如下：
$d(t) \rightarrow \text{发送滤波器 } G_T(f) \rightarrow s(t) \xrightarrow{n_w(t)} r(t) \rightarrow \text{接收滤波器 } G_R(f) \rightarrow y(t) \rightarrow \text{定时提取} \rightarrow \text{采样} \rightarrow \text{判决}$

*   **发送滤波器 $G_T(f)$** (其冲激响应为 $g_T(t)$ 即脉冲成形函数):
    *   控制发送信号的功率谱密度。
    *   决定发送频谱。
*   **信道**：模型中常考虑AWGN（加性高斯白噪声）信道 $C(f)$，噪声为 $n_w(t)$。
*   **接收滤波器 $G_R(f)$**:
    *   抑制噪声。
    *   (与发送滤波器配合) 改善信噪比，减少码间串扰。
*   **采样与判决**:
    *   在每个符号周期内的特定时刻（由定时提取模块确定）对 $y(t)$进行**采样**，获得电压测量值。
    *   基于测量值**判决**发送信号的幅度，进而得到发送的比特信息。
    *   “根据采样值识别幅度”。

### 最简单的PAM信号 👍

*   **幅度最简 - 二进制**：$a_n$ 只有两种可能的取值。
    *   **单极性 (Unipolar)**：幅度为 $\{0, A\}$ (或 $\{0, 1\}$ 经幅度放大)。
    *   **双极性 (Bipolar)** / 极性 (Polar)：幅度为 $\{\pm A\}$ (或 $\{\pm 1\}$ 经幅度放大)。
*   **脉冲最简 - 矩形脉冲**：
    *   **不归零 (Non-Return-to-Zero, NRZ)**：脉冲宽度等于符号周期 $T_s$ (占空比为100%)。
        ![NRZ 脉冲](https://i.imgur.com/rP49w5o.png)
    *   **归零 (Return-to-Zero, RZ)**：脉冲宽度 $\tau$ 小于符号周期 $T_s$ (例如，占空比为50%，$\tau = T_s/2$) 。脉冲在 $T_s$ 结束前返回到零电平。
        ![RZ 脉冲](https://i.imgur.com/165vJ8U.png)
*   **组合**：上述特性组合起来有4种基本二进制码型：
    1.  单极性不归零码 (Unipolar NRZ)
    2.  双极性不归零码 (Bipolar NRZ / Polar NRZ)
    3.  单极性归零码 (Unipolar RZ)
    4.  双极性归零码 (Bipolar RZ / Polar RZ)
*   **差分编码**：还可以配合差分码的运用，形成差分的单/双极性、不归零/归零波形。

#### 不归零码 (NRZ)
NRZ码：采用不归零矩形脉冲。
基本脉冲 $g(t) = \begin{cases} A, & 0 \le t \le T_s \\ 0, & \text{else} \end{cases}$
信号 $s(t) = \sum_{n=-\infty}^{\infty} a_n g(t - nT_s)$

1.  **单极性NRZ码**:
    比特 $b_n \in \{0, 1\} \implies$ 幅度 $a_n \in \{0, A\}$ (或 $a_n \in \{0, 1\}$ 乘以脉冲幅度 $A$)
    *   特点：含有直流分量 (均值不为0，若0和1等概出现)。
    ![单极性NRZ](https://i.imgur.com/8T3g1Ww.png)

2.  **双极性NRZ码 (极性NRZ码)**:
    比特 $b_n \in \{0, 1\} \implies$ 幅度 $a_n \in \{-A, +A\}$ (或 $a_n \in \{-1, +1\}$ 乘以脉冲幅度 $A$)
    *   特点：若比特0和1等概出现，则均值为0 (无直流分量)。
    ![双极性NRZ](https://i.imgur.com/9U205yH.png)

#### 归零码 (RZ)
RZ码：采用归零矩形脉冲。
基本脉冲 $g(t) = \begin{cases} A, & 0 \le t \le \tau \\ 0, & \text{else} \end{cases}$，其中 $\tau < T_s$ (例如 $\tau = T_s/2$)
信号 $s(t) = \sum_{n=-\infty}^{\infty} a_n g(t - nT_s)$

1.  **单极性RZ码**:
    比特 $b_n \in \{0, 1\} \implies$ 幅度 $a_n \in \{0, A\}$
    *   特点：含有直流分量。含有离散的频率分量（包括在 $1/T_s$ 处的时钟分量，如果 $\tau$ 选择合适）。
    ![单极性RZ](https://i.imgur.com/8lO51iR.png)

2.  **双极性RZ码 (极性RZ码)**:
    比特 $b_n \in \{0, 1\} \implies$ 幅度 $a_n \in \{-A, +A\}$
    *   特点：若比特0和1等概出现，则均值为0 (无直流分量)。含有离散的频率分量（包括在 $1/T_s$ 处的时钟分量，如果 $\tau$ 选择合适，例如 $\tau = T_s/2$）。
    ![双极性RZ](https://i.imgur.com/3k1E5Hl.png)

#### 码型转换与直流/时钟分量 💡

*   **双极性NRZ + 直流 = 单极性NRZ**:
    $s_{\text{单极性NRZ}}(t) = s_{\text{双极性NRZ}}(t) + \text{直流}$
    例如，若双极性NRZ的幅度为 $\{-A/2, +A/2\}$，加上直流 $A/2$，则得到单极性NRZ的幅度 $\{0, A\}$。
    如果原始数据1、0等概，则 $E[s_{\text{双极性NRZ}}(t)] = 0$。
    凡随机过程均值不为零者，皆可分离为零均值随机过程叠加确定信号（直流分量）。

*   **双极性RZ + 周期方波 = 单极性RZ**:
    若 $a_n^{\text{双}} \in \{\pm 1\}$ (双极性幅度)， $a_n^{\text{单}} \in \{0, 2\}$ (单极性幅度)。
    则可以令 $a_n^{\text{单}} = a_n^{\text{双}} + 1$。
    $s_{\text{单RZ}}(t) = \sum (a_n^{\text{双}} + 1)g(t-nT_s) = \sum a_n^{\text{双}}g(t-nT_s) + \sum g(t-nT_s)$
    $s_{\text{单RZ}}(t) = s_{\text{双RZ}}(t) + \text{周期方波时钟}$
    $\sum g(t-nT_s)$ 是一个周期为 $T_s$ 的方波序列（时钟信号）。
    因此，单极性RZ信号中包含时钟分量，便于接收端提取位同步。

#### 差分编码 🔄
用相邻码元是否**变化**来代表信息比特0或1。
例如，设原始信息比特序列为 $\{a_n\}$，$a_n \in \{0,1\}$。
差分编码后的序列为 $\{b_n\}$，$b_n \in \{0,1\}$。
编码规则：$b_n = a_n \oplus b_{n-1}$ (模2加法)
*   $a_n=0 \implies b_n = b_{n-1}$ (当前码元与前一码元相同)
*   $a_n=1 \implies b_n \neq b_{n-1}$ (当前码元与前一码元相反)
$b_n$ 序列再进行NRZ或RZ调制。
*   **绝对码 $a_n$**: 拟传输的原始数据。
*   **相对码 $b_n$**: 差分编码后的数据，其前后变化体现原始数据。
差分编码可以解决某些信道中出现的相位模糊问题（例如反相）。

---

### 功率谱密度 (PSD) 📊

#### 基带PAM信号的功率谱密度

*   **目的**：求PAM信号 $s(t) = \sum a_n g_T(t - nT_s)$ 的功率谱密度 $P_s(f)$。
    这里 $g_T(t)$ 是发送滤波器的脉冲形状。
*   **方法**：先求 $d(t) = \sum a_n \delta(t-nT_s)$ 的功率谱密度 $P_d(f)$，然后利用 $s(t) = d(t) * g_T(t)$，得到：
    $\boxed{P_s(f) = P_d(f) |G_T(f)|^2}$
*   **假设**：
    *   $\{a_n\}$ 是一个实平稳随机序列（幅度序列）。
    *   $g_T(t)$ 是实信号（脉冲形状）。

1.  **$d(t)$的自相关函数**
    $R_d(t+\tau, t) = E[d(t+\tau)d(t)] = E\left[\sum_n a_n \delta(t+\tau-nT_s) \sum_m a_m \delta(t-mT_s)\right]$
    $= \sum_n \sum_m E[a_n a_m] \delta(t+\tau-nT_s)\delta(t-mT_s)$
    令 $R_a(k) = E[a_m a_{m+k}]$ 为序列 $\{a_n\}$ 的自相关函数 ($k=n-m$)。
    $R_d(t+\tau, t) = \sum_m \left[ \sum_k R_a(k) \delta(\tau-kT_s) \right] \delta(t-mT_s)$
    这是一个关于 $t$ 的周期函数，周期为 $T_s$。

2.  **平均自相关函数 $\bar{R}_d(\tau)$**
    $\bar{R}_d(\tau) = \frac{1}{T_s} \int_0^{T_s} R_d(t+\tau, t) dt$
    由于 $\sum_m \delta(t-mT_s)$ 在一个周期 $T_s$ 上的平均是 $1/T_s$ (如果积分区间包含一个脉冲)。
    $\bar{R}_d(\tau) = \frac{1}{T_s} \sum_{k=-\infty}^{\infty} R_a(k) \delta(\tau - kT_s)$

3.  **$P_d(f)$ 的傅氏变换**
    *(知识回顾 🧠：维纳-辛钦定理指出，广义平稳随机过程的功率谱密度是其自相关函数的傅里叶变换。)*
    $P_d(f) = \mathcal{F}\{\bar{R}_d(\tau)\} = \frac{1}{T_s} \sum_{k=-\infty}^{\infty} R_a(k) e^{-j2\pi f k T_s}$
    令 $P_a(f) = \sum_{k=-\infty}^{\infty} R_a(k) e^{-j2\pi f k T_s}$ (这是序列 $R_a(k)$ 的离散时间傅里叶变换DTFT，但变量是 $f T_s$ 而不是 $\omega$）。
    则 $P_d(f) = \frac{1}{T_s} P_a(f)$。

4.  **$s(t)$ 的功率谱密度 $P_s(f)$**
    $\boxed{P_s(f) = \frac{1}{T_s} P_a(f) |G_T(f)|^2}$
    这个**一般形式**表明，PAM信号的功率谱密度取决于：
    *   符号幅度序列 $\{a_n\}$ 的**自相关特性** (体现在 $P_a(f)$ 中)。
    *   基本脉冲 $g_T(t)$ 的**频谱特性** (体现在 $|G_T(f)|^2$ 中)。

#### Case 1: $\{a_n\}$ 是不相关序列 (Uncorrelated Sequence)
当序列 $\{a_n\}$ 中的各个符号 $a_n$ 互不相关时。设 $E[a_n] = m_a$ (均值)，$E[a_n^2] = \overline{a_n^2}$。
方差 $\sigma_a^2 = E[(a_n-m_a)^2] = \overline{a_n^2} - m_a^2$。
自相关函数 $R_a(k) = E[a_n a_{n+k}]$:
*   $R_a(0) = E[a_n^2] = \sigma_a^2 + m_a^2$
*   $R_a(k) = E[a_n]E[a_{n+k}] = m_a^2$ for $k \neq 0$ (因为不相关)
所以 $R_a(k) = \sigma_a^2 \delta(k) + m_a^2$。
(这里 $\delta(k)$ 是克罗内克 $\delta$ 函数，$\delta(0)=1$，$\delta(k)=0$ for $k \neq 0$)
则 $P_a(f) = \sum_{k=-\infty}^{\infty} (\sigma_a^2 \delta(k) + m_a^2) e^{-j2\pi f k T_s} = \sigma_a^2 + m_a^2 \sum_{k=-\infty}^{\infty} e^{-j2\pi f k T_s}$
使用泊松求和公式：$\sum_{k=-\infty}^{\infty} e^{-j2\pi f k T_s} = \frac{1}{T_s} \sum_{m=-\infty}^{\infty} \delta(f - \frac{m}{T_s})$。
所以 $P_a(f) = \sigma_a^2 + \frac{m_a^2}{T_s} \sum_{m=-\infty}^{\infty} \delta(f - \frac{m}{T_s})$。
代入 $P_s(f)$:
$P_s(f) = \frac{1}{T_s} \left( \sigma_a^2 + \frac{m_a^2}{T_s} \sum_{m=-\infty}^{\infty} \delta(f - \frac{m}{T_s}) \right) |G_T(f)|^2$
$P_s(f) = \underbrace{\frac{\sigma_a^2}{T_s} |G_T(f)|^2}_{\text{连续谱}} + \underbrace{\frac{m_a^2}{T_s^2} \sum_{m=-\infty}^{\infty} |G_T(\frac{m}{T_s})|^2 \delta(f - \frac{m}{T_s})}_{\text{离散谱 (谱线)}}$

*   **若 $m_a = 0$ (均值为0)**:
    $P_s(f) = \frac{\sigma_a^2}{T_s} |G_T(f)|^2$
    此时功率谱完全是**连续谱**，其形状取决于 $|G_T(f)|^2$。
*   **若 $m_a \neq 0$ (均值不为0)**:
    功率谱由**连续谱**（由方差 $\sigma_a^2$ 贡献）和**离散谱**（由均值 $m_a$ 贡献的谱线）组成。
    离散谱线出现在 $f = m/T_s$ 处 (包括 $f=0$ 的直流分量，以及 $f=1/T_s$ 的时钟分量等)。

**示例1: 双极性NRZ码**
$G_T(f) = A T_s \text{sinc}(f T_s) e^{-j\pi f T_s}$
$|G_T(f)|^2 = (A T_s)^2 \text{sinc}^2(f T_s)$。
$P_s(f) = \frac{\sigma_a^2}{T_s} |G_T(f)|^2 = \frac{1}{T_s} (A T_s)^2 \text{sinc}^2(f T_s) = A^2 T_s \text{sinc}^2(f T_s)$。

主瓣带宽 (到第一个零点)：$fT_s = 1 \implies f = 1/T_s$。
$B_{ML} = 1/T_s = R_s$ (符号速率)。若为二进制， $R_s = R_b$ (比特率)。

**示例2: 双极性RZ码**
$G_T(f) = A \tau \text{sinc}(f \tau) e^{-j\pi f \tau}$
$|G_T(f)|^2 = (A \tau)^2 \text{sinc}^2(f \tau)$。
$P_s(f) = \frac{\sigma_a^2}{T_s} |G_T(f)|^2 = \frac{1}{T_s} (A \tau)^2 \text{sinc}^2(f \tau) = \frac{A^2 \tau^2}{T_s} \text{sinc}^2(f \tau)$。

主瓣带宽：$f\tau = 1 \implies f = 1/\tau$。
$B_{ML} = 1/\tau$。若 $\tau = T_s/2$, 则 $B_{ML} = 2/T_s = 2R_s$。

**示例3: 单极性NRZ码 (方法1: 直接套用公式)** 
$a_n \in \{0, A_0\}$ (为了简化，设为 $\{0, 1\}$，脉冲幅度为 $A$)
假设 $P(a_n=0) = P(a_n=1) = 0.5$。
$m_a = E[a_n] = 0 \cdot 0.5 + 1 \cdot 0.5 = 0.5$。
$E[a_n^2] = 0^2 \cdot 0.5 + 1^2 \cdot 0.5 = 0.5$。
$\sigma_a^2 = E[a_n^2] - m_a^2 = 0.5 - (0.5)^2 = 0.25$。

$G_T(f) = A T_s \text{sinc}(f T_s) e^{-j\pi f T_s}$。
$P_s(f) = \frac{\sigma_a^2}{T_s} |G_T(f)|^2 + \frac{m_a^2}{T_s^2} \sum_{m=-\infty}^{\infty} |G_T(\frac{m}{T_s})|^2 \delta(f - \frac{m}{T_s})$
$|G_T(m/T_s)|^2 = (A T_s)^2 \text{sinc}^2(m T_s/T_s) = (A T_s)^2 \text{sinc}^2(m)$。
$\text{sinc}^2(m) = 1$ for $m=0$, and $0$ for $m \neq 0$ (整数)。

所以离散谱只有 $m=0$ (直流) 项：
$P_s(f) = \frac{0.25}{T_s} (A T_s)^2 \text{sinc}^2(f T_s) + \frac{(0.5)^2}{T_s^2} (A T_s)^2 \text{sinc}^2(0) \delta(f - 0)$
$P_s(f) = 0.25 A^2 T_s \text{sinc}^2(f T_s) + 0.25 A^2 \delta(f)$
即 $P_s(f) = \frac{A^2 T_s}{4} \text{sinc}^2(f T_s) + \frac{A^2}{4} \delta(f)$。
包含连续谱和直流分量谱线。主瓣带宽 $B_{ML} = 1/T_s = R_s$。

**示例4: 单极性NRZ码 (方法2: 双极性NRZ + 直流)**
单极性NRZ信号 (幅度 $0, A$) 可以看作一个幅度为 $\{-A/2, +A/2\}$ 的双极性NRZ信号 $s_b(t)$ 加上一个直流分量 $A/2$。
$s(t) = s_b(t) + A/2$
$s_b(t) = \sum c_n g_T(t-nT_s)$，其中 $c_n \in \{\pm A/2\}$ (若原比特 $a_n \in \{0,1\}$ 映射到 $c_n = (a_n - 1/2)A$)
$E[c_n]=0$, $\sigma_c^2 = (A/2)^2 = A^2/4$.
$P_{s_b}(f) = \frac{A^2/4}{T_s} (T_s)^2 \text{sinc}^2(fT_s) = \frac{A^2 T_s}{4} \text{sinc}^2(fT_s)$ (这里假设 $g_T(t)$ 是单位幅度的脉冲, 幅度 $A/2$ 在 $c_n$ 中体现)。

直流分量 $A/2$ 的功率谱是 $(A/2)^2 \delta(f) = \frac{A^2}{4} \delta(f)$。
总功率谱 $P_s(f) = P_{s_b}(f) + \frac{A^2}{4} \delta(f) = \frac{A^2 T_s}{4} \text{sinc}^2(f T_s) + \frac{A^2}{4} \delta(f)$。
结果与方法1相同。

**示例5: 单极性RZ码 (方法1)**
$a_n \in \{0, 1\}$, $m_a=0.5, \sigma_a^2=0.25$.
脉冲 $g_T(t)$ 为幅度 $A$、宽度 $\tau$ 的矩形脉冲。
$|G_T(f)|^2 = (A\tau)^2 \text{sinc}^2(f\tau)$
$P_s(f) = \frac{\sigma_a^2}{T_s} |G_T(f)|^2 + \frac{m_a^2}{T_s^2} \sum_{m=-\infty}^{\infty} |G_T(\frac{m}{T_s})|^2 \delta(f - \frac{m}{T_s})$
$P_s(f) = \frac{0.25}{T_s} (A\tau)^2 \text{sinc}^2(f\tau) + \frac{(0.5)^2}{T_s^2} \sum_{m=-\infty}^{\infty} (A\tau)^2 \text{sinc}^2(\frac{m\tau}{T_s}) \delta(f - \frac{m}{T_s})$

若占空比为50%，即 $\tau = T_s/2$:
$P_s(f) = \frac{0.25}{T_s} (A \frac{T_s}{2})^2 \text{sinc}^2(\frac{fT_s}{2}) + \frac{0.25}{T_s^2} \sum_{m=-\infty}^{\infty} (A \frac{T_s}{2})^2 \text{sinc}^2(\frac{m T_s/2}{T_s}) \delta(f - \frac{m}{T_s})$
$P_s(f) = \frac{A^2 T_s}{16} \text{sinc}^2(\frac{fT_s}{2}) + \frac{A^2}{16} \sum_{m=-\infty}^{\infty} \text{sinc}^2(\frac{m}{2}) \delta(f - \frac{m}{T_s})$

$\text{sinc}^2(m/2)$ 在 $m=0$ (直流)时为1； $m=\pm 1, \pm 3, \dots$ (奇数) 时不为0 (例如 $m=1$, $\text{sinc}^2(1/2) = (\frac{\sin(\pi/2)}{\pi/2})^2 = (2/\pi)^2 = 4/\pi^2$)；$m=\pm 2, \pm 4, \dots$ (偶数非零) 时为0。
所以，功率谱密度中有直流、时钟 $(f=1/T_s, m=1)$ 及其他离散谱线。

主瓣带宽 $B_{ML} = 1/\tau = 2/T_s = 2R_s$ (对于50%占空比)。
*(方法2: 单极性RZ = 双极性RZ + 周期方波时钟，也可以用于推导)*

#### Case 2: $\{a_n\}$ 是相关序列
当 $\{a_n\}$ 中的符号相关时，需要使用其完整的自相关函数 $R_a(m)$。
$P_s(f) = \frac{1}{T_s} \left( \sum_{m=-\infty}^{\infty} R_a(m) e^{-j2\pi f m T_s} \right) |G_T(f)|^2$

**示例: 差分编码后的NRZ (一种线路码，如AMI码的简化形式)**
假设相关序列 $a_n$ 满足 $a_n = b_n' + b_{n-1}'$，其中 $\{b_n'\}$ 是一个均值为0、方差为1的互不相关序列 ($R_{b'}(k) = \delta(k)$)。$g_T(t)$ 是NRZ脉冲 (幅度 $A$, 宽度 $T_s$)。
$R_a(m) = E[a_n a_{n+m}] = E[(b_n' + b_{n-1}')(b_{n+m}' + b_{n+m-1}')]$
$= E[b_n'b_{n+m}'] + E[b_n'b_{n+m-1}'] + E[b_{n-1}'b_{n+m}'] + E[b_{n-1}'b_{n+m-1}']$
$= R_{b'}(m) + R_{b'}(m-1) + R_{b'}(m+1) + R_{b'}(m)$
$= 2\delta(m) + \delta(m-1) + \delta(m+1)$
所以：
$R_a(0) = 2$
$R_a(1) = 1$
$R_a(-1) = 1$
$R_a(m) = 0$ for $|m| > 1$.

$P_a(f) = \sum_{m=-\infty}^{\infty} R_a(m) e^{-j2\pi f m T_s} = R_a(-1)e^{j2\pi f T_s} + R_a(0) + R_a(1)e^{-j2\pi f T_s}$
$= e^{j2\pi f T_s} + 2 + e^{-j2\pi f T_s} = 2 + 2\cos(2\pi f T_s)$
$= 2(1 + \cos(2\pi f T_s)) = 4\cos^2(\pi f T_s)$
*(利用 $1+\cos(2\theta) = 2\cos^2(\theta)$)*

$P_s(f) = \frac{1}{T_s} [4\cos^2(\pi f T_s)] |G_T(f)|^2$
其中 $|G_T(f)|^2 = (A T_s)^2 \text{sinc}^2(f T_s)$ for NRZ pulse.
$P_s(f) = \frac{4}{T_s} \cos^2(\pi f T_s) (A T_s)^2 \text{sinc}^2(f T_s)$
$P_s(f) = 4 A^2 T_s \cos^2(\pi f T_s) \text{sinc}^2(f T_s)$
$= 4 A^2 T_s \cos^2(\pi f T_s) \left(\frac{\sin(\pi f T_s)}{\pi f T_s}\right)^2 = 4 A^2 T_s \frac{\cos^2(\pi f T_s) \sin^2(\pi f T_s)}{(\pi f T_s)^2}$
$= A^2 T_s \frac{(2\sin(\pi f T_s)\cos(\pi f T_s))^2}{(\pi f T_s)^2} = A^2 T_s \frac{\sin^2(2\pi f T_s)}{(\pi f T_s)^2}$
这种码型的特点是 $P_s(0)=0$，即在直流处有零点，有利于消除直流漂移。

**总结** ✨:
如果将不相关序列进一步编码为相关序列 (即在符号之间引入记忆)，可改变功率谱特性。
这是一种**通过编码来进行频谱成型**的方法，常用于设计具有特定频谱特性的**线路码型** (Line Codes)。例如，消除直流分量、在特定频率产生谱零点、或在时钟频率处产生谱峰等。

---
### 例题与练习 ✏️

1.  **数据速率是1000 bit/s，双极性NRZ码的主瓣带宽是?**
    *   $R_b = 1000$ bit/s. 对于二进制NRZ, $T_s = T_b = 1/R_b = 1/1000$ s.
    *   主瓣带宽 $B_{ML} = 1/T_s = R_b = \boxed{1000 \text{ Hz}}$.

2.  **数据速率是1000 bit/s，半占空单极性RZ码的主瓣带宽是?**
    *   $R_b = 1000$ bit/s. $T_s = 1/1000$ s.
    *   半占空意味着脉冲宽度 $\tau = T_s/2$.
    *   主瓣带宽 $B_{ML} = 1/\tau = 1/(T_s/2) = 2/T_s = 2R_b = 2 \times 1000 = \boxed{2000 \text{ Hz}}$.

3.  **下列中，哪个是单极性RZ码的功率谱密度?**
    (参考幻灯片P26的图)
    *   双极性NRZ码的PSD是连续谱，过原点不为零。 (图1)
    *   双极性RZ码的PSD是连续谱 (若$\tau$与$T_s$不成简单整数比时)，或含有零点 (若$a_n$相关) (图2的形状类似双极性NRZ)
    *   单极性RZ码的PSD具有连续谱部分，同时在 $f=m/T_s$ 处有离散谱线（包括直流 $m=0$ 和时钟 $m=1$ 等）。 (图3)
    *   因此，图3 ✅ (带有离散谱线的图形) 是单极性RZ码的功率谱密度。
    ![PSD示例图](https://i.imgur.com/sC54xWl.png) *(示意图，请参考幻灯片P26原图)*