---
create: 2025-04-09 09:59
---
# 3.6 快速傅里叶变换 (FFT) 及其反变换 (IFFT)

本节主要内容：
*   问题的提出 (Why FFT?)
*   基 2 时域抽取 FFT (DIT-FFT)
*   基 2 频域抽取 FFT (DIF-FFT)
*   DIT-IFFT (基于 DIT 的快速反变换)
*   DIF-IFFT (基于 DIF 的快速反变换)

#### 问题的提出 🤔

*   **DFT 定义**: 对于 N 点有限长序列 $x(n)$，其离散傅里叶变换 (DFT) 定义为：
    $\boxed{X(k) = \sum_{n=0}^{N-1} x(n) W_N^{nk}, \quad k=0, 1, \dots, N-1}$
    其中 $W_N = e^{-j\frac{2\pi}{N}}$ 称为旋转因子。

*   **计算复杂度**: 直接按定义计算 DFT 需要：
    *   $N^2$ 次复数乘法
    *   $N(N-1)$ 次复数加法
    *   总运算量约为 $O(N^2)$。

*   **实时处理的挑战**: 当序列长度 N 较大时（例如 N=1024 或 8192），$O(N^2)$ 的计算量非常巨大，使得许多需要实时处理的应用（如语音识别、机器翻译、无线通信等）难以实现。
    *   N=512: 约 26 万次复数乘法
    *   N=1024: 约 105 万次复数乘法
    *   N=8192: 约 6700 万次复数乘法 (!!!) 😱

*   **示例 (N=4)**: 计算 $x(n) = \{1, 1, 1, -1\}$ 的 4 点 DFT。
    *   $X(0) = \sum x(n) W_4^{0n} = 1W_4^0 + 1W_4^0 + 1W_4^0 - 1W_4^0 = 2$
    *   $X(1) = \sum x(n) W_4^{1n} = 1W_4^0 + 1W_4^1 + 1W_4^2 - 1W_4^3 = 1 - j - 1 - (-j)(-1) = -2j$ (注意: $W_4^1 = e^{-j\pi/2} = -j$, $W_4^2 = -1$, $W_4^3 = j$)
    *   $X(2) = \sum x(n) W_4^{2n} = 1W_4^0 + 1W_4^2 + 1W_4^4 - 1W_4^6 = 1 - 1 + 1 - (-1) = 2$
    *   $X(3) = \sum x(n) W_4^{3n} = 1W_4^0 + 1W_4^3 + 1W_4^6 - 1W_4^9 = 1 + j - 1 - (j)(1) = 2j$
    直接计算需要 $4^2=16$ 次复数乘法和 $4 \times 3 = 12$ 次复数加法。

#### FFT 的基本思路 💡

FFT (Fast Fourier Transform) 并非一种新的变换，而是**计算 DFT 的一种高效算法**。其核心思想是：

1.  **分解**: 将一个长序列 (N 点) 的 DFT 分解为若干个较短序列 (如 N/2 点) 的 DFT 的组合。
2.  **利用旋转因子的性质**: 充分利用 $W_N^{nk}$ 的周期性、对称性和可约性来减少冗余计算。
*   **旋转因子 $W_N = e^{-j\frac{2\pi}{N}}$ 的性质**:
    *   **周期性**: $W_N^{k+N} = W_N^k$, $W_N^{n+N} = W_N^n \implies W_N^{(k+N)n} = W_N^{kn}$, $W_N^{k(n+N)} = W_N^{kn}$
    *   **对称性**: $W_N^{k + N/2} = -W_N^k$ (非常重要！)
    *   **可约性**: $W_N^{nk} = W_{N/M}^{nk/M}$ (若 N/M 为整数)，特别地 $W_N^{2k} = W_{N/2}^k$ (当 M=2)

#### FFT 算法发展历程 ⏳

虽然常归功于 1965 年的 Cooley 和 Tukey，但其思想可追溯至高斯 (Gauss) 在 1805 年的工作。后续有 Bergland (基-4), Duhamel & Hollmann 等改进。

#### 基 2 时域抽取 FFT (DIT-FFT) 🦋

DIT-FFT (Decimation-in-Time) 的核心思想是对**输入时域序列** $x(n)$ 按**奇偶**进行分组 (抽取)。 **前提**: 序列长度 N 必须是 2 的整数次幂 ($N=2^M$)。

1.  **分组**: 将 $x(n)$ 分为偶数下标子序列 $x_1(r)$ 和奇数下标子序列 $x_2(r)$：
    *   偶数组: $x_1(r) = x(2r)$, $r = 0, 1, \dots, N/2 - 1$
    *   奇数组: $x_2(r) = x(2r+1)$, $r = 0, 1, \dots, N/2 - 1$

2.  **推导**: 将 DFT 求和式按 n 的奇偶分开：
    $X(k) = \sum_{n=0}^{N-1} x(n) W_N^{nk} = \sum_{r=0}^{N/2-1} x(2r) W_N^{k(2r)} + \sum_{r=0}^{N/2-1} x(2r+1) W_N^{k(2r+1)}$
    利用 $W_N^{2kr} = W_{N/2}^{kr}$ 和 $W_N^{k(2r+1)} = W_N^k W_N^{2kr} = W_N^k W_{N/2}^{kr}$：
    $X(k) = \sum_{r=0}^{N/2-1} x_1(r) W_{N/2}^{kr} + W_N^k \sum_{r=0}^{N/2-1} x_2(r) W_{N/2}^{kr}$
    令 $X_1(k)$ 和 $X_2(k)$ 分别为 $x_1(r)$ 和 $x_2(r)$ 的 N/2 点 DFT：
    $X(k) = X_1(k) + W_N^k X_2(k)$, $k = 0, 1, \dots, N-1$

3.  **利用对称性**: 考虑 $k+N/2$：
    $X(k+N/2) = X_1(k+N/2) + W_N^{k+N/2} X_2(k+N/2)$
    由于 $X_1(k)$ 和 $X_2(k)$ 是 N/2 点 DFT，它们具有周期 N/2 ($X_1(k+N/2)=X_1(k)$, $X_2(k+N/2)=X_2(k)$)。利用 $W_N^{k+N/2} = -W_N^k$：
    $X(k+N/2) = X_1(k) - W_N^k X_2(k)$

4.  **蝶形运算 (Butterfly)**: 上述两式构成了 DIT-FFT 的核心计算单元——蝶形运算。对于 $k = 0, 1, \dots, N/2 - 1$：
    $\boxed{X(k) = X_1(k) + W_N^k X_2(k)}$
    $\boxed{X(k+N/2) = X_1(k) - W_N^k X_2(k)}$
    这个运算将两个 N/2 点 DFT 的结果 $X_1(k)$ 和 $X_2(k)$ 组合成 N 点 DFT 的结果 $X(k)$ 和 $X(k+N/2)$。
	![Pasted image 20250409101716](Pic/Pasted%20image%2020250409101716.png)

5.  **递归结构**: N 点 DFT 被分解为 2 个 N/2 点 DFT。这 2 个 N/2 点 DFT 又可以分别被分解为 4 个 N/4 点 DFT，以此类推，直到分解为 N/2 个 2 点 DFT。
    *   **2 点 DFT**: $N=2$, $k=0$. $X_1(0)=x(0)$, $X_2(0)=x(1)$, $W_2^0=1$.
        $X(0) = x(0) + W_2^0 x(1) = x(0) + x(1)$
        $X(1) = x(0) - W_2^0 x(1) = x(0) - x(1)$
        (只需要一次加法，一次减法)

6.  **DIT-FFT 流图**: 将递归结构展开，形成 M = log₂N 级的计算流图。
    *   **N=4 示例**: 
        *   第一级: 计算两个 2 点 DFT (对 {x (0), x (2)} 和 {x (1), x (3)}) 得到 $X_1(0), X_1(1)$ 和 $X_2(0), X_2(1)$。
        *   第二级: 进行蝶形运算，计算 $X(0), X(1), X(2), X(3)$。
        ![475](Pic/Pasted%20image%2020250409102250.png)
    *   **N=8 示例**: 
        *   共 3 级 (log₂8 = 3)。
        *   输入端序列需要按**码位倒置**顺序排列。
        *   输出端序列是**自然顺序**。
        ![500](Pic/Pasted%20image%2020250409102305.png)

7.  **码位倒置 / 倒序重排**: 
    DIT-FFT 算法要求输入序列 $x(n)$ 按其下标 n 的二进制码位倒置后的顺序排列，这样输出 $X(k)$ 才能是自然顺序 ($k=0, 1, ..., N-1$)。
    *   **原因**: 每一级奇偶分组，相当于按 n 的二进制最低位 (LSB) 分组；下一级对子序列分组，相当于按次低位分组，以此类推。最后等效于按 n 的二进制表示从低位到高位排序，即码位倒置。
    *   **示例 (N=4, M=2)**:
    * ![500](Pic/Pasted%20image%2020250409103505.png)
    *   输入流图时，应按 $x(0), x(2), x(1), x(3)$ 的顺序输入。对于 N=8，则按 $x(0), x(4), x(2), x(6), x(1), x(5), x(3), x(7)$ 顺序输入。

8.  **同址计算**: 
    FFT 的蝶形运算具有一个重要特性：计算 $X(k)$ 和 $X(k+N/2)$ 只需要 $X_1(k)$ 和 $X_2(k)$ 的值。计算完成后，$X_1(k)$ 和 $X_2(k)$ 不再需要。因此，可以将计算结果 $X(k)$ 和 $X(k+N/2)$ 直接存放在原来存储 $X_1(k)$ 和 $X_2(k)$ 的单元中，无需额外的存储空间。这大大节省了内存。

9.  **计算量**:
    *   共 $M = \log_2 N$ 级。
    *   每级有 $N/2$ 个蝶形运算。
    *   每个蝶形运算包含 1 次复数乘法和 2 次复数加法 (注意: 乘以 $W_N^k$)。
    *   **总复数乘法次数**: $M_F = (N/2) \log_2 N$
    *   **总复数加法次数**: $A_F = N \log_2 N$
    *   运算量级为 $O(N \log_2 N)$，远小于 DFT 的 $O(N^2)$。🎉
	
10. **DIT-FFT 总结**:
    *   基本计算单元是蝶形。
    *   输入序列按**码位倒置**排列。
    *   输出序列按**自然顺序**排列。
    *   可以进行**同址计算**。
    *   运算量为 $O(N \log_2 N)$。

#### 基 2 频域抽取 FFT (DIF-FFT) 🦋

DIF-FFT (Decimation-in-Frequency) 的核心思想是根据**输出频域序列** $X(k)$ 的下标 k 的**奇偶**性，将 N 点 DFT 分解。

1.  **分组**: 将输入序列 $x(n)$ 分为**前后两半**:
    *   前半: $x(n)$, $n = 0, 1, \dots, N/2 - 1$
    *   后半: $x(n+N/2)$, $n = 0, 1, \dots, N/2 - 1$

2.  **推导**: 将 DFT 求和式分为前后两半：
    $X(k) = \sum_{n=0}^{N/2-1} x(n) W_N^{nk} + \sum_{n=N/2}^{N-1} x(n) W_N^{nk}$
    令第二项的 $n = m + N/2$, $m=0, \dots, N/2-1$：
    $\sum_{m=0}^{N/2-1} x(m+N/2) W_N^{k(m+N/2)} = \sum_{m=0}^{N/2-1} x(m+N/2) W_N^{km} W_N^{kN/2}$
    利用 $W_N^{kN/2} = (W_N^{N/2})^k = (-1)^k$：
    $X(k) = \sum_{n=0}^{N/2-1} [x(n) + (-1)^k x(n+N/2)] W_N^{nk}$

3.  **按 k 的奇偶讨论**:
    *   **k 为偶数 (k=2r)**: $(-1)^k = (-1)^{2r} = 1$。 $W_N^{nk} = W_N^{n(2r)} = W_{N/2}^{nr}$。
        $X(2r) = \sum_{n=0}^{N/2-1} [x(n) + x(n+N/2)] W_{N/2}^{nr}$
    *   **k为奇数(k=2r+1)**: $(-1)^k = (-1)^{2r+1} = -1$。 $W_N^{nk} = W_N^{n(2r+1)} = W_N^n W_N^{2nr} = W_N^n W_{N/2}^{nr}$。
        $X(2r+1) = \sum_{n=0}^{N/2-1} [x(n) - x(n+N/2)] W_N^n W_{N/2}^{nr}$

4.  **蝶形运算**: 定义两个 N/2 点序列：
    $\boxed{g(n) = x(n) + x(n+N/2)}$
    $\boxed{h(n) = [x(n) - x(n+N/2)] W_N^n}$
    则 $X(2r)$ 是 $g(n)$ 的 N/2 点 DFT，$X(2r+1)$ 是 $h(n)$ 的 N/2 点 DFT。
    计算 $g(n)$ 和 $h(n)$ 的过程构成了 DIF-FFT 的蝶形运算。
	
5.  **DIF-FFT 流图**: 
    *   输入序列按**自然顺序**排列。
    *   输出序列按**码位倒置**顺序排列 ($X(0), X(4), X(2), X(6), X(1), X(5), X(3), X(7)$ for N=8)。
    *   同样是 M = log₂N 级，每级 N/2 个蝶形。
    *   可以进行**同址计算**。
    *   计算量与 DIT-FFT 相同 ($O(N \log_2 N)$)。
    ![Pasted image 20250409105801](Pic/Pasted%20image%2020250409105801.png)

#### DIT-FFT 与 DIF-FFT 的比较 🔄

| 特性         | DIT-FFT (时域抽取)       | DIF-FFT (频域抽取)       |
| :--------- | :------------------- | :------------------- |
| **基本思想**   | 对输入 $x(n)$ 按奇偶分组     | 对输出 $X(k)$ 按奇偶分组     |
| **蝶形运算**   | 先乘 $W_N^k$，后加减       | 先加减，后乘 $W_N^n$       |
| **输入顺序**   | **码位倒置**             | **自然顺序**             |
| **输出顺序**   | **自然顺序**             | **码位倒置**             |
| **旋转因子位置** | 输出端 (与 $X_2(k)$ 相乘)  | 输出端 (与差值项相乘)         |
| **计算量**    | $O(N \log_2 N)$      | $O(N \log_2 N)$      |
| **同址计算**   | 可以                   | 可以                   |
| **流图关系**   | 互为**转置** (Transpose) | 互为**转置** (Transpose) |

---
-  **流图转置**: 将 DIT 流图的所有箭头反向，并将输入输出互换，即可得到 DIF 流图的结构。
- ![Pasted image 20250409111153](Pic/Pasted%20image%2020250409111153.png)

#### 快速傅里叶反变换 (IFFT) 🔙

IDFT 定义：
 $$\boxed{x(n) = \frac{1}{N} \sum_{k=0}^{N-1} X(k) W_N^{-nk}, \quad n=0, 1, \dots, N-1}$$

*   **与 DFT 的关系**:
    1.  求和项相似，只是旋转因子指数为负 ($W_N^{-nk}$ vs $W_N^{nk}$)，即 $W_N^{-nk} = (W_N^{nk})^* = W_N^{*nk}$ (复共轭)。
    2.  整个求和结果需要乘以 $1/N$。

*   **利用 FFT 算法计算 IFFT**: 由于结构相似，计算 IFFT 的快速算法 (IFFT) 可以直接利用 FFT 的流图结构。

1.  **DIT-IFFT**: 
    *   基于 DIT-FFT 的思想，对输入 $X(k)$ 按 k 的奇偶分组。
    *   推导出的蝶形运算为:
        $\boxed{x_1(k) = \frac{1}{2}[X(k) + X(k+N/2)]}$
        $\boxed{x_2(k) = \frac{1}{2}W_N^{-k}[X(k) - X(k+N/2)]}$
        (注意 $1/2$ 因子和 $W_N^{-k}$)
        或者将 $1/N$ 因子放在最后一次性乘以输出结果，蝶形运算为：
        $x_1(k) = X(k) + X(k+N/2)$
        $x_2(k) = W_N^{-k}[X(k) - X(k+N/2)]$
    *   **流图结构**: 类似于 **DIF-FFT** 的结构。
    *   输入 $X(k)$ 按**自然顺序**。
    *   输出 $x(n)$ 按**码位倒置**顺序。
    *   旋转因子为 $W_N^{-k}$ (或 $W_N^{*k}$)。
    *   需要处理 $1/N$ 因子 (可以在每级蝶形乘以 1/2，或最后乘以 1/N)。
    ![Pasted image 20250409112250](Pic/Pasted%20image%2020250409112250.png)
2.  **DIF-IFFT**:
    *   基于 DIF-FFT 的思想，将输出 $x(n)$ 分为前后两半。
    *   推导出的蝶形运算为：
        $\boxed{x(n) = \frac{1}{2}[x_1(n) + W_N^{-n}x_2(n)]}$
        $\boxed{x(n+N/2) = \frac{1}{2}[x_1(n) - W_N^{-n}x_2(n)]}$
        (注意 $1/2$ 因子和 $W_N^{-n}$)
    *   **流图结构**: 类似于 **DIT-FFT** 的结构。
    *   输入 $X(k)$ 按**码位倒置**顺序。
    *   输出 $x(n)$ 按**自然顺序**。
    *   旋转因子为 $W_N^{-n}$ (或 $W_N^{*n}$)。
    *   需要处理 $1/N$ 因子。
3.  **共轭法求 IFFT**:
    利用关系式：
    $\boxed{x(n) = \text{IDFT}\{X(k)\} = \frac{1}{N} [\text{DFT}\{X^*(k)\}]^*}$
    计算步骤：
    *   (1) 求输入 $X(k)$ 的复共轭 $X^*(k)$。
    *   (2) 对 $X^*(k)$ 进行 **DFT** (可以用任何标准的 FFT 算法，如 DIT-FFT 或 DIF-FFT)。
    *   (3) 将 DFT 的结果取复共轭。
    *   (4) 将结果除以 N。
    *   **优点**: 可以直接调用现成的 FFT 函数库来计算 IFFT。
    *   **流程图**:
        $X(k) \xrightarrow{\text{共轭}} X^*(k) \xrightarrow{\text{FFT/DFT}} Nx^*(n) \xrightarrow{\text{共轭}} Nx(n) \xrightarrow{\text{乘 } 1/N} x(n)$

#### FFT 的应用 🌐

FFT 极大地降低了 DFT 的计算复杂度，使其在众多领域得到广泛应用：
*   **信号处理**: 频谱分析、滤波、卷积、相关运算等。
*   **通信系统**: OFDM (正交频分复用) 调制解调 (如 WiFi, 4 G/5 G LTE)。 (Page 35)
*   **图像处理**: 图像增强、压缩、模式识别。
*   **雷达信号处理**: 目标检测、测距、测速。
*   **卫星导航**: 信号捕获与跟踪 (如北斗系统)。 (Page 34)
*   **数值计算**: 快速求解偏微分方程等。