# 3.1~3.4 离散傅里叶变换 📑

**本章学习路线图** 🗺️：

1.  离散傅里叶变换 (DFT) 定义
2.  DFT 与 Z 变换和 DTFT 的关系
3.  DFT 的性质
4.  DFT 的应用：线性卷积的分段计算 (*注：此部分在提供的内容中未详细展开*)
5.  快速傅里叶变换及反变换 (FFT-IFFT) (*注：此部分在提供的内容中未详细展开*)
6.  FFT 的应用 (*注：此部分在提供的内容中未详细展开*)

---

**1. 问题的提出：离散信号的变换 🤔**

*   **回顾基础** 🧠：我们已经学习了两种处理离散信号 $x[n]$ 的变换方法：
    *   **离散时间傅里叶变换 (DTFT)**：提供了**绝对可和**序列在**连续**频域 $\omega$ 中的表示。
        $$ X(e^{j\omega}) = \sum_{n=-\infty}^{\infty} x[n]e^{-jn\omega} $$
        适用于无限长序列，但结果 $X(e^{j\omega})$ 是 $\omega$ 的**连续函数**。
    *   **Z 变换**：提供了序列在复平面 $z$ 域的表示。
        $$ X(z) = \sum_{n=-\infty}^{\infty} x[n]z^{-n} $$
        也适用于无限长序列，结果 $X(z)$ 是 $z$ 的**连续函数**。

*   **计算性问题** 💻： DTFT 和 Z 变换的结果都是连续函数，这在计算机数值计算中难以直接处理。我们需要一种在**时域和频域都是离散**的变换，便于计算机实现。

*   **解决思路** ✨：
    *   **频域离散化**：对 DTFT $X(e^{j\omega})$ 在频域 $[0, 2\pi)$ 内进行**等间隔采样**，得到离散频域表示。这引出了 **离散傅里叶级数 (DFS)**。
    *   **时域有限化**：考虑**有限长**序列（或将无限长序列截断），再进行变换。将 DFS 应用于有限长序列（取其一个周期），得到 **离散傅里叶变换 (DFT)**。

*   **DFT 的重要性** ⭐：
    *   DFT 已成为数字信号处理 (DSP) 算法中的**核心变换**。
    *   是分析**有限长序列**的基本傅里叶方法。
    *   存在**快速算法 (FFT)**，极大提高了计算效率。

---

**2. 四种信号的傅里叶分析回顾 🔄**

为了更好地理解 DFT，我们先回顾一下四种基本信号类型及其对应的傅里叶分析方法：

| 时间域特性         | 信号类型                    | 傅里叶分析方法          | 频率域特性         |
| :------------ | :---------------------- | :--------------- | :------------ |
| 连续、非周期        | 非周期连续时间信号 $x(t)$        | 傅里叶变换 (FT)       | **连续**、非周期    |
| 连续、周期         | 周期连续时间信号 $\tilde{x}(t)$ | 傅里叶级数 (FS)       | **离散**、非周期    |
| **离散**、非周期    | 非周期离散时间序列 $x[n]$        | 离散时间傅里叶变换 (DTFT) | **连续**、**周期** |
| **离散**、**周期** | 周期离散时间序列 $\tilde{x}[n]$ | 离散傅里叶级数 (DFS)    | **离散**、**周期** |

**关键对应关系** 🔑：

*   时域**连续** $\Leftrightarrow$ 频域**非周期**
*   时域**离散** $\Leftrightarrow$ 频域**周期**
*   时域**非周期** $\Leftrightarrow$ 频域**连续**
*   时域**周期** $\Leftrightarrow$ 频域**离散**

**从 DTFT 到 DFS (频域采样)** 采样过程：

*   DTFT $X(e^{j\omega})$ 是关于 $\omega$ 的 $2\pi$ 周期函数。
*   在 $[0, 2\pi)$ 区间内对 $X(e^{j\omega})$ 进行 $N$ 点等间隔采样，采样点为 $\omega_k = \frac{2\pi}{N}k$, $k=0, 1, \dots, N-1$。
*   采样结果 $\tilde{X}[k] = X(e^{j\omega})|_{\omega = \frac{2\pi}{N}k}$ 构成了离散傅里叶级数 (DFS)。

**频域采样定理** 📜：

*   对非周期序列 $x[n]$ 的 DTFT $X(e^{j\omega})$ 进行 $N$ 点等间隔采样得到 $\tilde{X}[k]$ (DFS系数)。
*   对 $\tilde{X}[k]$ 进行反离散傅里叶级数 (IDFS) 变换，得到的时域序列 $\tilde{x}[n]$ 是原序列 $x[n]$ 以 $N$ 为周期的**周期延拓**。
    $$ \tilde{x}[n] = \text{IDFS}\{\tilde{X}[k]\} = \sum_{r=-\infty}^{\infty} x[n+rN] $$
*   **核心**： $\boxed{\text{频域离散化 } \rightarrow \text{ 时域周期化}}$

**频域采样注意事项** ⚠️：

*   设 $x[n]$ 的长度为 $L$ (非零值范围)，频域采样点数为 $N$。
*   **Case 1: $N \ge L$** ✅：进行 IDFS 恢复时，时域不会发生混叠。恢复的 $\tilde{x}[n]$ 在主值区间 $[0, N-1]$ 内（特别是在 $[0, L-1]$ 内）与原序列 $x[n]$ 完全相同。此时，频域采样值 $\tilde{X}[k]$ 可以唯一表示原序列的 DTFT。
*   **Case 2: $N < L$** ❌：进行 IDFS 恢复时，时域发生**混叠失真**。恢复的 $\tilde{x}[n]$ 在主值区间 $[0, N-1]$ 内与原序列 $x[n]$ 不完全相同。此时，频域采样值 $\tilde{X}[k]$ 不能准确表示原序列的 DTFT。

---

**3. 有限长序列的离散傅里叶变换 (DFT) ⚙️**

*   **从 DFS 到 DFT**：DFS $\tilde{X}[k]$ 是一个无限长的周期序列。我们通常只关心其在一个周期（主值区间）内的值。
    *   取 DFS $\tilde{X}[k]$ 在 $k=0, 1, \dots, N-1$ 上的 $N$ 个点，定义为 **N 点离散傅里叶变换 (DFT)**，记为 $X[k]$。
    $$ X[k] = \tilde{X}[k] R_N[k] $$
    其中 $R_N[k]$ 是一个长度为 $N$ 的矩形窗，表示取主值。

*   **DFT 定义**：对于  长度为 $N$ 的有限长序列 $x[n]$ ($n=0, 1, \dots, N-1$)，其 N 点 DFT $X[k]$ ($k=0, 1, \dots, N-1$) 定义为：
    $$ \boxed{X[k] = \sum_{n=0}^{N-1} x[n] W_N^{nk}} \quad k=0, 1, \dots, N-1 $$
    其中 $W_N = e^{-j\frac{2\pi}{N}}$ 称为**旋转因子** (Twiddle Factor)。

*   **反离散傅里叶变换 (IDFT)**：由 DFT $X[k]$ 恢复原序列 $x[n]$：
    $$ \boxed{x[n] = \frac{1}{N} \sum_{k=0}^{N-1} X[k] W_N^{-nk}} \quad n=0, 1, \dots, N-1 $$

*   **DFT 与 DFS 的关系**：DFT 是 DFS 的**主值序列**，DFS 是 DFT 的**周期延拓**。

*   **旋转因子 $W_N$ 的性质**：
    *   周期性：$W_N^{k+N} = W_N^k$, $W_N^{n+N} = W_N^n$
    *   对称性：$W_N^{k + N/2} = -W_N^k$ (N为偶数)
    *   $W_N^0 = 1$（N任意）, $W_N^{N/2} = -1$ (N为偶数)
    *   正交性：$\sum_{n=0}^{N-1} W_N^{nk} (W_N^{nl})^* = \sum_{n=0}^{N-1} W_N^{nk} W_N^{-nl} = N \delta[k-l]$。这表明 DFT 基向量 $\{W_N^{nk}\}$ 构成一组**正交基**。DFT 本质是将 $x[n]$ 在这组正交基上进行分解。

*   **DFT 频谱分辨率** 📏：
    *   N 点 DFT 覆盖了从 0 到 $f_s$ (采样频率) 的频率范围。
    *   频率轴被分成了 $N$ 个点，相邻点之间的频率间隔为**频率分辨率** $\Delta f$。
        $$ \Delta f = \frac{f_s}{N} = \frac{1}{NT_s} = \frac{1}{T_0} $$
        其中 $T_s$ 是采样间隔，$T_0 = NT_s$ 是观测时间长度 (记录长度)。
    *   $N$ 越大 (观测时间越长或采样点数越多)，$\Delta f$ 越小，**分辨率越高**。👍
    *   **零填充 (Zero-Padding)**：在 $x[n]$ 后面补零增加序列长度 $N$。这会使 DFT 的频点**更密集**，谱线看起来更平滑，但**不能提高**区分两个相近频率的能力 (即**分辨率不变**)。💡 分辨率取决于原始数据的观测时长 $T_0$。

---

**4. DFT 与 Z 变换、DTFT 的关系 🔗**

*   **DFT 是单位圆上的采样 Z 变换**：
    *   回顾 Z 变换：$X(z) = \sum_{n=0}^{N-1} x[n]z^{-n}$ (对于有限长序列)
    *   在 Z 平面的**单位圆**上，取 $N$ 个等间隔角度的点 $z_k = e^{j\frac{2\pi}{N}k} = W_N^{-k}$，进行采样：
        $$ X(z)|_{z=W_N^{-k}} = \sum_{n=0}^{N-1} x[n](W_N^{-k})^{-n} = \sum_{n=0}^{N-1} x[n]W_N^{nk} = X[k] $$
    *   所以，$\boxed{X[k] = X(z)|_{z=e^{j\frac{2\pi}{N}k}}}$

*   **DFT 是特定频率点的 DTFT 采样**：
    *   回顾 DTFT：$X(e^{j\omega}) = \sum_{n=0}^{N-1} x[n]e^{-jn\omega}$
    *   在 $\omega_k = \frac{2\pi}{N}k$ 处对 DTFT 进行采样：
        $$ X(e^{j\omega})|_{\omega = \frac{2\pi}{N}k} = \sum_{n=0}^{N-1} x[n]e^{-jn\frac{2\pi}{N}k} = \sum_{n=0}^{N-1} x[n]W_N^{nk} = X[k] $$
    *   所以，$\boxed{X[k] = X(e^{j\omega})|_{\omega = \frac{2\pi}{N}k}}$

*   **关系总结**：
    *   $x[n] \xrightarrow{ZT} X(z)$
    *   $X(z)|_{z=e^{j\omega}} \rightarrow X(e^{j\omega})$ (DTFT 是 Z 变换在单位圆上的取值)
    *   $X(e^{j\omega})$ 在 $\omega = \frac{2\pi}{N}k$ 采样 $\rightarrow X[k]$ (DFT 是 DTFT 的频域采样)
    *   $X(z)$ 在 $z=e^{j\frac{2\pi}{N}k}$ 采样 $\rightarrow X[k]$ (DFT 是 Z 变换在单位圆上的采样)
    *   $X[k]$ 可以通过**内插**恢复 $X(z)$ 或 $X(e^{j\omega})$ (*注：内插公式复杂，此处省略*)

*   **预备知识：周期序列与有限长序列关系** 🕰️：
    *   有限长序列 $x[n]$ ($n=0..N-1$)
    *   其周期延拓 $\tilde{x}[n] = \sum_{r=-\infty}^{\infty} x[n-rN]$
    *   主值序列 $x[n] = \tilde{x}[n] R_N[n]$
    *   **模运算 (Modulo)**：$((n))_N = n \pmod N$ 表示 $n$ 对 $N$ 取余数。
        *   $\tilde{x}[n] = x((n))_N$
        *   $\tilde{X}[k] = X((k))_N$
    *   **重要**：在 DFT 相关运算（如循环移位、循环卷积）中，序列索引和频率索引都是在模 N 意义下进行的。

---

**5. DFT 的性质 ✨**

假设 $x[n], x_1[n], x_2[n]$ 都是长度为 $N$ 的序列，其 N 点 DFT 分别为 $X[k], X_1[k], X_2[k]$。

*   **线性** 👍：
    $$ \boxed{\text{DFT}[ax_1[n] + bx_2[n]] = aX_1[k] + bX_2[k]} $$
    *注意*：进行线性组合前，若序列长度不同，需**补零**至相同长度 $N$，且 DFT 点数也需为 $N$。

*   **循环移位** ⏱️➡️ / 🔊➡️：
    *   **时域循环移位**：将序列 $x[n]$ 在 $n=0..N-1$ 范围内循环移动 $m$ 位。
        $$ x_m[n] = x((n-m))_N R_N[n] $$
        （$m>0$ 右移，$m<0$ 左移，移出部分从另一端移入）
        $$ \boxed{x((n-m))_N R_N[n] \quad \stackrel{DFT}{\longleftrightarrow} \quad W_N^{mk} X[k]} $$
        结论：时域循环移位引起频域**线性相位**变化 $e^{-j\frac{2\pi}{N}mk}$，幅度不变。
    *   **频域循环移位 (调制特性)**：
        $$ \boxed{W_N^{-nl} x[n] \quad \stackrel{DFT}{\longleftrightarrow} \quad X((k-l))_N R_N[k]} $$
        结论：时域乘以复指数（调制）引起频域循环移位。

*   **循环反褶** 🔄：
    $$ x_{rev}[n] = x((-n))_N R_N[n] = x(N-n) \quad \text{for } n=1..N-1, \text{ and } x(0) $$
    $$ \boxed{x((-n))_N R_N[n] \quad \stackrel{DFT}{\longleftrightarrow} \quad X((-k))_N R_N[k] = X(N-k)} $$
![](Pic/Pasted%20image%2020250422060131.png)
*   **对称性** ✨：
    *   若 $x[n]$ 为**实数序列**：
        *   $X[k]$ 具有**共轭对称性**：$\boxed{X[k] = X^*(N-k)}$
        *   幅度谱偶对称：$|X[k]| = |X(N-k)|$
        *   相位谱奇对称：$\angle X[k] = -\angle X(N-k)$
        *   实部偶对称：$\text{Re}\{X[k]\} = \text{Re}\{X(N-k)\}$
        *   虚部奇对称：$\text{Im}\{X[k]\} = -\text{Im}\{X(N-k)\}$
    *   利用对称性，可以用**一次 N 点复数 DFT** 计算**两个 N 点实数序列**的 DFT。

*   **帕塞瓦尔定理** 💪：能量守恒
    $$ \boxed{\sum_{n=0}^{N-1} |x[n]|^2 = \frac{1}{N} \sum_{k=0}^{N-1} |X[k]|^2} $$
    结论：序列在时域计算的总能量等于其在频域计算的总能量（差一个因子 $1/N$）。

*   **循环卷积**：
    *   定义：两个长度为 $N$ 的序列 $x_1[n]$ 和 $x_2[n]$ 的 N 点循环卷积 $y_c[n]$ 定义为：
        $$ \boxed{y_c[n] = x_1[n] \circledast_N x_2[n] = \sum_{m=0}^{N-1} x_1[m] x_2((n-m))_N} \quad n=0, 1, \dots, N-1 $$
        结果 $y_c[n]$ 仍是长度为 $N$ 的序列。
    *   **计算方法**：
        1.  **时域方法 (作图法/解析法/同心圆法)**：序列反褶、循环移位、相乘求和。
        2. ![](Pic/Pasted%20image%2020250422061138.png)
        3.  **频域方法**：利用循环卷积定理。
    *   **循环卷积定理**：
        *   **时域循环卷积定理**：
            $$ \boxed{x_1[n] \circledast_N x_2[n] \quad \stackrel{DFT}{\longleftrightarrow} \quad X_1[k] X_2[k]} $$
            结论：时域循环卷积对应于频域**逐点相乘**。
        *   **频域循环卷积定理 (对偶性)**：
            $$ \boxed{x_1[n] x_2[n] \quad \stackrel{DFT}{\longleftrightarrow} \quad \frac{1}{N} X_1[k] \circledast_N X_2[k]} $$
            结论：时域逐点相乘对应于频域**循环卷积** (并除以 N)。
    *   **重要应用**：利用 DFT/FFT **快速计算线性卷积**。通过对 $x_1[n]$ 和 $x_2[n]$ **补零**至足够长度 $L \ge N_1 + N_2 - 1$，然后计算 $L$ 点循环卷积，其结果与线性卷积相同。

---

**下一步：**

*   **DFT的应用：线性卷积的分段计算**
*   **快速傅里叶变换 (FFT) 及其反变换 (IFFT)**
*   **FFT 的应用**