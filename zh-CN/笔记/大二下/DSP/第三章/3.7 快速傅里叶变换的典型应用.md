---
create: 2025-04-09 11:53
---
# 3.7 快速傅里叶变换的典型应用
本节主要内容：

*   实序列的 DFT 的计算 (提高 FFT 运算效率的方法)
*   信号的频谱分析 (参数选择、频谱泄露、栅栏效应及其改善方法)

### 提高 FFT 运算效率的方法 🚀 (实序列的 DFT 计算)

由于实际应用中，信号通常是实数序列，本节介绍两种利用 FFT 计算实序列 DFT 的优化方法，以提高运算效率。

1.  **同时计算两个实序列的 FFT** 👯

    当需要同时计算两个同长度实序列 $x(n)$ 和 $y(n)$ 的 DFT 时，可以将它们组合成一个复数序列进行 FFT 计算，从而一次运算得到两个实序列的 FFT 结果，节省计算量。

    *   **构造复数序列**:  $u(n) = x(n) + jy(n)$
    *   **计算 U (k) = DFT[u (n)]** (用 FFT 快速算法)
    *   **利用共轭对称性**:  已知 $U(k) = \text{DFT}[u(n)]$，则其共轭序列 $u^*(n) = x(n) - jy(n)$ 的 DFT 为：

        $\boxed{DFT[u^*(n)] = \sum_{n=0}^{N-1} u^*(n) W_N^{kn} = [\sum_{n=0}^{N-1} u(n) W_N^{(-k)n}]^* = U^*((-k))_N}$

        这里 $((-k))_N$ 表示 $-k$ 对 $N$ 取模，由于 DFT 结果是周期性的，也可以写成 $U^*((-k))_N = U^*(N-k)$ (当 $k \ne 0$) 或 $U^*(0)$ (当 $k = 0$)。

    *   **分离 X (k) 和 Y (k)**:  利用线性性质和共轭关系，可以从 $U(k)$ 和 $U^*((-k))_N$ 中分离出 $X(k) = \text{DFT}[x(n)]$ 和 $Y(k) = \text{DFT}[y(n)]$：

        $\boxed{X(k) = \frac{1}{2}[U(k) + U^*((-k))_N]}$

        $\boxed{Y(k) = \frac{1}{2j}[U(k) - U^*((-k))_N]}$

    *   **效率提升**: 这样做计算两个实序列的 FFT，其运算量只比计算一个复序列的 FFT 略多一些，因此可以**提高运算效率一倍**。 🥇

    *   **示例**: 已知 $x(n) = \{1, 0, 1, 0\}$ 和 $y(n) = \{0, 1, 0, 1\}$，用一次 4 点 FFT 运算求出 $X(k)$ 和 $Y(k)$。
        *   构造 $w(n) = x(n) + jy(n) = \{1, j, 1, j\}$
        *   计算 $W(k) = \text{DFT}[w(n)] = \{2+2j, 0, 2-2j, 0\}$ (使用 DIT-FFT 流图，图中 $w(4)$ 应为 $w(3) = j$)
        *   分离 $X(k) = [W(k) + W^*(4-k)]/2 = \{2, 0, 2, 0\}$
        *   分离 $Y(k) = [W(k) - W^*(4-k)]/(2j) = \{2, 0, -2, 0\}$ 

2.  **用 N 点变换计算 2 N 点实序列的变换** 🧮

    *   **示例**:  一个 8 点实序列 $x(n) = \{1, 2, 0, 1, 2, 2, 1, 1\}$，利用 1 次 4 点 DIT-FFT 计算其 DFT。
        *   分解为 4 点序列:
            *   $x_1(n) = x(2n) = \{x(0), x(2), x(4), x(6)\} = \{1, 0, 2, 1\}$
            *   $x_2(n) = x(2n+1) = \{x(1), x(3), x(5), x(7)\} = \{2, 1, 2, 1\}$
        *   构造复数序列 $x_3(n) = x_1(n) + jx_2(n) = \{1+2j, j, 2+2j, 1+j\}$
        *   计算 $X_3(k) = \text{DFT}[x_3(n)]$ (用 4 点 DIT-FFT 流图，注意旋转因子和节点值)
        *   分离 $X_1(k) = [X_3(k) + X_3^*(4-k)]/2 = \{4, -1+j, 2, -1-j\}$
        *   分离 $X_2(k) = [X_3(k) - X_3^*(4-k)]/(2j) = \{6, 0, 2, 0\}$
        *   组合得到 8 点 DFT:
            *   $X(k) = X_1(k) + W_8^k X_2(k)$, $k = 0, 1, 2, 3$
            *   $X(k+4) = X_1(k) - W_8^k X_2(k)$, $k = 0, 1, 2, 3$
            *   最终结果 $X(k) = \{10, -1+j, 2-2j, -1-j, -2, -1+j, 2+2j, -1-j\}$, $k=0, 1, \dots, 7$
### 信号的频谱分析 🎶

通过前面的学习，我们知道信号可以在时域或频域中表示。频谱分析就是研究信号在频域中的特性，即信号包含哪些频率成分以及这些成分的强度（幅度）和相位。

#### 1. DFT 与频谱分析的关系 🔗

DFT 是连接时域有限长序列 $x[n]$ ($0 \le n \le N-1$) 和其频域离散表示 $X[k]$ ($0 \le k \le N-1$) 的桥梁。

回顾一下基础流程：
*   模拟信号 $x_a(t)$ 经过 **抽样** (Sampling) 得到离散时间信号 $x[n]$。
    *   时域关系：$t = nT_s$，其中 $T_s$ 是抽样间隔，$f_s = 1/T_s$ 是抽样频率。
    *   频域关系：$x[n]$ 的 DTFT $X(e^{j\omega})$ 是 $x_a(t)$ 的 FT $X_a(j\Omega)$ 周期延拓的结果 (经过频率尺度变换 $\omega = \Omega T_s$)。 💡 **知识回顾**：采样定理要求 $f_s \ge 2f_h$，其中 $f_h$ 是 $x_a(t)$ 的最高频率，以避免混叠。
*   离散时间信号 $x[n]$ (可能是无限长的) 经过 **截断** (Truncation) 得到有限长序列 $x_N[n] = x[n]w[n]$，其中 $w[n]$ 是长度为 $N$ 的窗函数 (例如矩形窗)。
    *   频域关系：$X_N(e^{j\omega})$ 是 $X(e^{j\omega})$ 与窗函数频谱 $W(e^{j\omega})$ 的 **周期卷积**。 $\boxed{X_N(e^{j\omega}) = \frac{1}{2\pi} X(e^{j\omega}) * W(e^{j\omega})}$ 。这一步是产生 **频谱泄漏** 的根源。
*   有限长序列 $x_N[n]$ 的 DTFT $X_N(e^{j\omega})$ 在频域 $[0, 2\pi)$ 上进行 **抽样**，得到 DFT $X[k]$。
    *   频域关系：$X[k] = X_N(e^{j\omega})|_{\omega = 2\pi k/N}$。
    *   这相当于对时域序列 $x_N[n]$ 进行 **周期延拓** 得到 $\tilde{x}_N[n]$，然后计算其离散傅里叶级数（DFS）。DFT 取 DFS 的一个主周期。

![](Pic/Pasted%20image%2020250416102852.png)

因此，DFT $X[k]$ 可以看作是原模拟信号 $x_a(t)$ 频谱的一种离散近似。理解这个过程中的每一步及其影响对于正确解读 DFT 结果至关重要。

#### 2. 频谱分析中的参数选择 ⚙️

进行基于 DFT 的频谱分析时，需要合理选择以下参数：

*   **时域取样间隔 $T$ (或 $T_s$)**：决定了 **时域取样频率 $f_s = 1/T$**。必须满足奈奎斯特采样定理 $\boxed{f_s \ge 2f_h}$，其中 $f_h$ 是信号 $x_a(t)$ 的最高频率。
*   **信号记录长度 $T_0$**：分析的信号时间段长度。它决定了 **频率分辨率 $F_0 = \Delta f = 1/T_0$**。$T_0$ 越长，频率分辨率越高 (能区分开更近的频率)。
*   **取样点数 $N$**：在一个记录长度 $T_0$ 内的样本数量。

这些参数之间相互关联：
$\boxed{T_0 = N T = N / f_s}$
$\boxed{N = T_0 / T = T_0 f_s}$
$\boxed{f_s = N / T_0 = N F_0}$
$\boxed{N = \frac{f_s}{F_0} = \frac{\Omega_s}{\Omega_0}}$ (其中 $\Omega_s = 2\pi f_s$, $\Omega_0 = 2\pi F_0$)

**核心矛盾**：
1.  **提高信号最高频率 $f_h$** ⬆️：需要提高采样频率 $f_s$ ⬆️ (奈奎斯特)。如果 $N$ 固定，则 $T_0 = N/f_s$ ⬇️，导致频率分辨率 $F_0 = 1/T_0$ ⬆️ (分辨率变差)。
2.  **提高频率分辨率 (即 $F_0$ ⬇️)**：需要增大记录长度 $T_0$ ⬆️。如果 $N$ 固定，则 $T = T_0/N$ ⬆️，导致采样频率 $f_s = 1/T$ ⬇️。为了避免混叠，必须降低允许的信号最高频率 $f_h$ ⬇️。

**结论** ✨：要 **同时** 提高能分析的信号最高频率 $f_h$ 和频率分辨率 $F_0$，**唯一的方法是增加采样点数 $N$**，即采集更长时间的数据 ($T_0$ 增大) 且保持足够高的采样率 ($f_s$ 足够大)。

**FFT 计算考虑** ⚡️：为了高效计算 DFT (使用快速傅里叶变换 FFT 算法)，通常选择 $N$ 为 2 的整数次幂，即 $\boxed{N = 2^r}$ ($r$ 为正整数)。

#### 3. DFT 输出与物理频率

DFT 的定义式为：
$\boxed{X[k] = \sum_{n=0}^{N-1} x[n] e^{-j \frac{2\pi}{N} nk}}, \quad 0 \le k \le N-1$

DFT 的输出 $X[k]$ 是一个复数序列。第 $k$ 个 DFT 系数 $X[k]$ 对应于模拟频率 $f_k$ 或数字频率 $\omega_k$：

*   **模拟频率 (Hz)**：
    $\boxed{f_k = k \cdot \frac{f_s}{N} = k \cdot F_0}, \quad k = 0, 1, \dots, N-1$
    其中 $f_s/N = F_0 = 1/T_0$ 是频率分辨率。 DFT 分析的最高频率是 $f_{N/2} = (N/2)(f_s/N) = f_s/2$ （对应于 $k=N/2$）。
*   **数字角频率 (rad/sample)**：
    $\omega_k = \Omega_k T_s = (2\pi f_k) T_s = (2\pi k \frac{f_s}{N}) \frac{1}{f_s} = \boxed{\frac{2\pi k}{N}}, \quad k = 0, 1, \dots, N-1$

**频谱类型**：
从复数 $X[k] = U[k] + jV[k]$ 可以导出：
*   **幅度谱 (Amplitude Spectrum)**：$A[k] = |X[k]| = \sqrt{U[k]^2 + V[k]^2}$
*   **相位谱 (Phase Spectrum)**：$\Phi[k] = \angle X[k] = \arctan \left( \frac{V[k]}{U[k]} \right)$
*   **功率谱 (Power Spectrum)**：$G[k] = |X[k]|^2$

**示例**：模拟信号 $f_h=8$kHz, $f_s=16$kHz 取样, $N=1024$ 点 DFT。求 $k=384$ 对应的模拟频率 $f$？
$f = k \frac{f_s}{N} = 384 \times \frac{16000 \text{ Hz}}{1024} = 384 \times 15.625 \text{ Hz} = 6000 \text{ Hz} = \boxed{6 \text{ kHz}}$

#### 4. 频谱分析的局限性与改进 🤔

##### 4.1 频谱泄漏 💧

*   **原因**：对无限长或长时信号进行 **截断** (加窗)，相当于时域乘以窗函数 $w[n]$。根据卷积定理，频域表现为信号真实频谱 $X(e^{j\omega})$ 与窗函数频谱 $W(e^{j\omega})$ 的 **周期卷积**。
    $\boxed{x[n]w[n] \leftrightarrow \frac{1}{2\pi} X(e^{j\omega}) * W(e^{j\omega})}$
*   **矩形窗**：最简单的窗，$w_R[n] = 1$ for $0 \le n \le N-1$。其频谱 $\boxed{W_R(e^{j\omega}) = \frac{\sin(\omega N/2)}{\sin(\omega/2)} e^{-j\omega(N-1)/2}}$ 具有一个 **主瓣** (Main Lobe) 和无穷多个 **旁瓣** (Side Lobes)。主瓣宽度 $\Delta\omega \approx 4\pi/N$。旁瓣衰减缓慢。
* ![](Pic/Pasted%20image%2020250422091523.png)
*   **效应**：窗函数频谱的旁瓣会将一个频率分量的能量 "泄漏" 到其他频率位置。卷积过程会导致：  
    *   原频谱中的 **尖峰变宽** (主瓣卷积)。
    *   在原频谱平坦或为零的区域产生 **纹波/虚假峰** (旁瓣卷积)。
    *   谱线间的 **干扰**。
*   **改善方法**：
    1.  **增加窗长 $N$** 👍：可以使窗谱的主瓣变窄 (提高分辨率)，旁瓣相对幅度减小，从而减轻泄漏。但不能完全消除，且需要更长的数据。
    2.  **使用非矩形窗** 👍👍：如 Hanning (汉宁), Hamming (汉明), Blackman (布莱克曼) 等。这些窗函数时域上两端逐渐衰减到零 ("缓慢截断")，其频谱 **旁瓣衰减更快**，代价是 **主瓣通常比相同长度的矩形窗更宽** (分辨率略有下降)。
        *   **注意** ⚠️：窗函数应在 **补零之前** 乘上。窗口宽度 $N$ 应与实际数据长度一致。
![](Pic/Pasted%20image%2020250422093301.png)
##### 4.2 栅栏效应 (Picket Fence Effect) 🚧

*   **原因**：DFT 只计算 $N$ 个离散频率点 $\omega_k = 2\pi k/N$ 上的频谱值，相当于透过栅栏的缝隙观察连续的 DTFT 频谱。如果信号的真实频谱峰值恰好落在两个 DFT 采样点之间，DFT 的结果可能无法显示真实的峰值大小和位置。
*   **改善方法/观察方法**：
    1.  **增加数据长度 $N$ (提高 $T_0$)** ✅：这是 **真正提高频率分辨率** 的方法 ($F_0 = f_s/N$ 减小)。如果 $N$ 足够大，使得分辨率足够高，就能更准确地捕捉频谱细节
    2.  **时域补零 (Zero-Padding)** 🧐：在 $N$ 点数据 $x[n]$ 后补 $L-N$ 个零，得到 $L$ 点序列 ($L>N$)，然后计算 $L$ 点 DFT。这相当于在原 DTFT $X(e^{j\omega})$ 上进行更密集的采样 ($\omega_k = 2\pi k/L$)。
        *   **效果**：补零 **不能提高频率分辨率** (分辨率仍由原始数据长度 $N$ 或 $T_0$ 决定)，但能 **提高频谱的显示密度 (插值)**，使得观察到的频谱曲线更平滑，有助于更精确地定位落在原栅栏缝隙中的峰值。(P19 方法2, P20-P21 对比)
        *   **结论** ✨：补零能改善 **显示分辨率**，看清谱线细节；增加有效数据长度能改善 **频谱分辨率**，区分相近频率。

##### 4.3 频率分辨率 🔬

*   **定义**：指能区分开两个相邻谱线的最小频率间隔。通常认为，这个间隔约等于 DFT 的 **频率轴采样间隔**。
*   **计算**：
    *   模拟频率分辨率 (Hz): $\boxed{\Delta f = F_0 = \frac{f_s}{N} = \frac{1}{T_0}}$
    *   模拟角频率分辨率 (rad/s): $\boxed{\Delta \Omega = 2\pi \Delta f = \frac{2\pi f_s}{N} = \frac{2\pi}{T_0}}$
    *   数字角频率分辨率 (rad/sample): $\boxed{\Delta \omega = \Delta \Omega \cdot T_s = \frac{2\pi}{N}}$
*   **意义**：若信号包含两个频率 $f_1, f_2$，只有当 $|f_1 - f_2| \ge \Delta f$ 时，DFT 谱才可能将它们分辨为两个独立的峰。

##### 4.4 周期性匹配与频率偏差

*   **理想情况**：如果被分析的信号 $x[n]$ 本身是周期的，且其周期 $N_p$ 恰好是 DFT 长度 $N$ 的约数 (即 $N = r N_p$, $r$ 为正整数，窗口内包含整数个周期)，并且信号只包含频率为 $m f_s / N$ ($m$为整数) 的分量，那么 DFT 谱线会非常干净，能量集中在对应的 $k=m$ 处，几乎没有泄漏。
    *   **余弦/正弦序列** ($N=rN_p$)：频谱在 $[0, N-1]$ 内有 **两个** 非零值 (对称)。
    *   **复指数序列** ($N=rN_p$)：频谱在 $[0, N-1]$ 内只有 **一个** 非零值。
    [推导-2](../推导/推导-2.md)
*   **非理想情况**：
    1.  **信号频率不是 $f_s/N$ 的整数倍** (即 $k$ 不是整数) ：即使信号是纯正弦波，其能量也会泄漏到最接近的整数 $k$ 值及其邻近的 DFT 频点上，导致谱峰变宽、幅值降低、位置偏移 ("频率偏差")。
    2.  **窗口长度 $N$ 不是信号周期的整数倍**：即使信号频率是 $f_s/N$ 的整数倍，也会发生频谱泄漏，因为截断破坏了周期性。
*   **结论** ✨：DFT 本质上是一个滤波器组。当信号频率正好落在某个子带滤波器的中心频率 ($2\pi k/N$) 上时，能得到理想谱线。否则，就会出现泄漏和模糊。

##### 4.5 非平稳信号分析的局限性 ⏳

*   **DFT 假设**：标准的 DFT (以及 FFT) 分析假设信号在所选的分析窗口 $N$ (时间长度 $T_0$) 内是 **平稳** 的，即其统计特性 (如频率成分) 不随时间变化。
*   **问题**：对于频率成分随时间变化的 **非平稳信号** (如语音、音乐、雷达信号等)，DFT 只能给出整个时间段 $T_0$ 内的 **平均频谱**，无法反映频率随时间的变化情况。它能告诉你 *存在哪些频率*，但不能告诉你 *这些频率何时出现*。
*   **替代方法**：需要使用 **时频分析** 方法，如短时傅里叶变换 (STFT)、小波变换 (Wavelet Transform) 等，它们能同时提供信号的 时间 和 频率 信息。

---

**总结** 📝：

DFT 是进行数字信号频谱分析的强大工具，但其应用伴随着一些固有的限制，如频谱泄漏、栅栏效应、有限的频率分辨率以及对信号平稳性的要求。理解这些现象的成因，并掌握相应的改善方法 (选择合适的窗函数、足够长的记录长度 N、补零以改善显示效果)，对于从 DFT 结果中准确提取有用的频谱信息至关重要。对于非平稳信号，则需要考虑更高级的时频分析技术。