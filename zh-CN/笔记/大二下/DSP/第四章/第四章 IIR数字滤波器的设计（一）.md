# 第四章 IIR数字滤波器的设计（一）

你可能会注意到这份笔记风格与其他的笔记风格有些许不同，这是我的一次新的尝试！

我把这份笔记打磨得更像一份循序渐进、引人入胜的讲义。我会尝试在保持原有信息完整性的基础上，增强其逻辑性、可读性和引导性，加入更多承上启下和解释“为什么”的部分。

---

**【阅读第四章之前：一点小小的“剧透”与学习导航】**

你好！即将开始的第四章将带我们深入探索IIR（无限冲激响应）数字滤波器的设计世界。这是一个非常重要且实用的领域。

在正式启程之前，我想先给你一个小小的“剧透”或者说学习导航：你可能会注意到，**虽然我们的最终目标是设计出数字滤波器 $H(z)$，但本章会花费大量的篇幅来讨论模拟滤波器及其特性**，比如它的系统函数 $H_a(s)$、频率响应 $H_a(j\Omega)$，甚至是归一化的模拟低通原型 $H(p)$。

**请不要因此感到困惑或以为我们“跑题”了！**

这恰恰是IIR数字滤波器设计的一条非常经典且成熟的路径，我们称之为“**基于模拟原型进行设计**”。其背后的逻辑是：

1.  **模拟滤波器理论非常成熟**：经过数十年的发展，模拟滤波器的设计理论（如巴特沃思、切比雪夫、椭圆滤波器等）已经非常完善，有现成的公式、图表和简便的设计步骤。
2.  **“借力打力”**：我们完全可以先利用这些成熟的理论，在模拟域设计出一个满足我们性能指标的模拟滤波器 $H_a(s)$。
3.  **巧妙转换**：然后，通过特定的数学变换方法（比如本章将要学习的“冲激响应不变法”和“双线性变换法”），将这个设计好的模拟滤波器 $H_a(s)$ 巧妙地转换为我们最终需要的数字滤波器 $H(z)$。

所以，当你看到章节中出现 $s$ 平面、$\Omega$ (模拟角频率)、巴特沃思逼近等概念时，请记住，它们都是我们设计数字滤波器 $H(z)$ 的重要“中间步骤”和“理论基础”。理解这些模拟域的概念，将帮助我们更好地掌握如何获得高性能的IIR数字滤波器。

带着这个“先设计模拟，再转换数字”的整体思路，相信你会更容易理解本章的讲述流程和各个知识点之间的联系。

祝你学习愉快！🚀

---
### 1. 引言：为何关注IIR数字滤波器？

在数字信号处理的广阔天地中，IIR (Infinite Impulse Response) 数字滤波器扮演着不可或缺的角色 🌱。它们以其高效性和灵活性，在众多领域大放异彩。

*   **它们的身影无处不在** 💡：
    *   **音频处理**: 从音乐播放器中的均衡器，到手机通话的降噪，再到语音识别与合成，IIR滤波器都在默默工作。
    *   **图像图形处理**: 图像的锐化、模糊、边缘检测，视频压缩与增强，乃至计算机动画的特效，都离不开滤波技术。
    *   **通信系统**: 无论是老式的数字按键电话，还是现代的IP电话、软件无线电，IIR滤波器在信号恢复、均衡、加密等方面都发挥着关键作用。
    *   **消费电子及其他**: 数字电视、CD/DVD播放器、数码相机，甚至在工业控制、医疗设备和军事应用中，IIR滤波器也是核心组件之一。

在我们深入探讨如何设计它们之前，让我们先回顾一些滤波器的基本概念。

#### 1.1 滤波器的基本语言 📊

*   **滤波器 (Filter)**: 想象一个筛子，它能让特定大小的颗粒通过，而阻挡其他大小的颗粒。滤波器就是信号处理中的“筛子”，用于选择性地通过某些频率的信号，同时抑制其他频率的信号。
*   **通带 (Passband)**: 允许信号“畅通无阻”通过的频率范围。其边界频率称为 **通带截止频率** (通常用 $\omega_p$ 表示数字角频率，或 $\Omega_p$ 表示模拟角频率)。
*   **阻带 (Stopband)**: 需要将信号或噪声“拒之门外”的频率范围。其边界频率称为 **阻带起始频率** ($\omega_s$ 或 $\Omega_s$)。
*   **过渡带 (Transition Band)**: 从通带到阻带的“缓冲区”，频率特性在这里急剧变化。
    ![](Pic/Pasted%20image%2020250430110126.png)

#### 1.2 滤波器的家族分类 📚

滤波器可以从不同角度进行分类：

*   **按信号类型**:
    *   **模拟滤波器**: 处理连续时间信号。
    *   **数字滤波器**: 处理离散时间信号，这是我们本章的焦点。
*   **按通过的频带**:
    *   **低通滤波器 (LPF)**: 只允许低频信号通过，像“低音炮”的原理。
    *   **高通滤波器 (HPF)**: 只允许高频信号通过，滤除直流和低频干扰。
    *   **带通滤波器 (BPF)**: 只允许特定频段的信号通过，像收音机选择电台。
    *   **带阻滤波器 (BRF)**: 抑制特定频段的信号，例如滤除交流哼声。
*   **按冲激响应特性 (与网络结构相关)**:
    *   **IIR 数字滤波器 (IIR DF)**: 无限长冲激响应滤波器。它们的特点是通常可以用较少的阶数实现陡峭的过渡带，但可能存在相位非线性问题。
    *   **FIR 数字滤波器 (FIR DF)**: 有限长冲激响应滤波器。它们总是稳定的，且容易实现线性相位，但通常需要更高的阶数来实现与IIR相当的幅度响应。

本章，我们的主角是 **IIR 数字滤波器**。

### 2. IIR 数字滤波器的“成绩单”：技术指标 ✨

要评价一个IIR数字滤波器设计得好不好，我们需要一套明确的技术指标。这些指标通常围绕其 **幅频特性** $|H(e^{j\omega})|$ 来定义（$\omega$ 是归一化的数字角频率，范围 $0 \le \omega \le \pi$）。

*   **核心性能参数**:
    *   **通带截止频率 ($\omega_p$)**: 通带的边缘。
    *   **通带波动 (或称通带纹波, Passband Ripple)**: 衡量通带内幅度响应的平坦程度。
        *   **相对指标**: $A_p$ (dB)，表示通带内允许的最大衰减。
        *   **绝对指标**: 通带容限 $\delta_p$，定义了通带内幅度变化的范围。
    *   **阻带起始频率 ($\omega_s$)**: 阻带的开始。
    *   **阻带衰减 (Stopband Attenuation)**: 衡量阻带对不必要信号的抑制能力。
        *   **相对指标**: $A_s$ (dB)，表示阻带内要求的最小衰减。
        *   **绝对指标**: 阻带容限 $\delta_s$，定义了阻带内幅度的上限。
*   **图示说明**:
    ![](Pic/Pasted%20image%2020250430110430.png)
*   **设计要点**:
    *   我们的主要任务就是找到一个系统函数 $H(z)$，使其幅频特性 $|H(e^{j\omega})|$ 能够满足上述指标。
    *   相位特性 $\phi(\omega)$ 虽然也很重要，但在初步设计IIR滤波器时，通常先满足幅度指标，如有必要再通过全通滤波器等手段进行相位校正。
    *   由于数字滤波器的频率响应 $H(e^{j\omega})$ 是以 $2\pi$ 为周期的，并且对于实系数滤波器，幅度响应是偶对称的，所以我们通常只关注 $0 \le \omega \le \pi$ 这个区间。

#### 2.1 绝对指标与相对指标的换算 🔄

在实际设计中，我们经常需要在绝对指标 ($\delta_p, \delta_s$) 和相对指标 ($A_p, A_s$) 之间进行转换。假设滤波器的最大通带增益已归一化为1 (即 $|H(e^{j\omega})|_{max} = 1$)：

*   **通带要求**: $1-\delta_p \le |H(e^{j\omega})| \le 1$, 对于 $|\omega| \le \omega_p$
*   **阻带要求**: $|H(e^{j\omega})| \le \delta_s$, 对于 $\omega_s \le |\omega| \le \pi$

它们之间的换算公式为：
*   $A_p = -20 \log_{10}(1-\delta_p)$ (dB)  (注意：$A_p$ 通常定义为正值，表示允许的衰减量)
*   $A_s = -20 \log_{10}(\delta_s)$ (dB) (同样，$A_s$ 通常定义为正值，表示需要的衰减量)

更一般地，任意频率点的衰减 $A(\omega)$ (dB) 可以表示为：
$\boxed{ A(\omega) \text{ (dB)} = -20 \log_{10} \frac{|H(e^{j\omega})|}{|H(e^{j\omega})|_{max}} }$
(如果 $|H(e^{j\omega})|_{max}$ 已归一化为1，则分母为1)

### 3. IIR 数字滤波器的设计蓝图：借助模拟原型 🧭

我们的目标是根据给定的数字域技术指标 ($\omega_p, \omega_s, A_p, A_s$)，求解出IIR数字滤波器的系统函数 $H(z)$。

*   **IIR 系统函数的模样**:
    $$ H(z) = \frac{\sum_{k=0}^{M} b_k z^{-k}}{1 - \sum_{k=1}^{N} a_k z^{-k}} = A \frac{\prod_{i=1}^{M} (z-c_i)}{\prod_{i=1}^{N} (z-d_i)} $$
    设计的核心就是确定这些系数 $a_k, b_k$ (递归系数和非递归系数) 或者等价地，确定系统的零点 $c_i$ 和极点 $d_i$。

*   **核心思路：为何不直接设计 H(z)？**
    直接从数字指标出发求解 $H(z)$ 的系数在数学上是复杂的。幸运的是，模拟滤波器的设计理论经过长期发展已经非常成熟和完善。因此，一个非常经典且有效的方法就是：**先设计一个满足转换后指标的模拟滤波器 $H_a(s)$，然后通过某种映射关系将其转换为数字滤波器 $H(z)$。** 这就是所谓的“基于模拟原型进行设计”。

*   **设计流程 (模拟原型法) 的两种主要途径**:

    1.  **方法1: 频率变换在模拟域完成**
        1.  **数字指标 $\rightarrow$ 模拟指标**: 将数字滤波器的频率指标 ($\omega_p, \omega_s$) 转换为模拟滤波器的频率指标 ($\Omega_p, \Omega_s$)。如果后续采用双线性变换法，这一步还需要进行“频率预畸变”处理。
        2.  **设计模拟低通原型 $H_{LP}(s')$**: 根据模拟指标，设计一个标准化的模拟低通滤波器原型 (例如，截止频率为1 rad/s)。
        3.  **模拟域频率变换 $s' \to s$**: 将模拟低通原型通过频率变换（如低通到低通、低通到高通、低通到带通/带阻）转换成我们所需要的类型的模拟滤波器 $H_a(s)$。
        4.  **模拟到数字转换 $s \to z$**: 利用冲激响应不变法或双线性变换法，将 $H_a(s)$ 转换为数字滤波器 $H(z)$。

    2.  **方法2: 频率变换在数字域完成**
        1.  **数字指标 $\rightarrow$ 模拟低通指标**: 将数字滤波器的频率指标直接映射（或预畸变后映射）为对一个模拟低通滤波器的要求。
        2.  **设计模拟低通原型 $H_{LP}(s)$**: 设计出这个模拟低通原型。
        3.  **模拟到数字转换 $s \to z$ (低通)**: 将模拟低通原型 $H_{LP}(s)$ 转换为数字低通原型 $H_{LP}(z)$。
        4.  **数字域频率变换 $z \to z'$**: 将数字低通原型 $H_{LP}(z)$ 通过数字频率变换（低通到低通/高通/带通/带阻）转换成目标数字滤波器 $H(z')$。

*   **这种方法的优势**: 我们可以充分利用模拟滤波器设计中积累的丰富成果，如各种逼近理论 (巴特沃思、切比雪夫等)、设计图表和公式，从而大大简化IIR数字滤波器的设计过程。

接下来，我们将首先回顾模拟滤波器设计的基础，这是理解整个IIR设计流程的关键。

### 4. 奠基石：模拟滤波器的设计基础 🛠️

要设计数字滤波器，我们先得学会如何设计它的“前身”——模拟滤波器 $H_a(s)$。

#### 4.1 模拟滤波器的“成绩单”：模拟域性能指标 (以低通为例)

与数字滤波器类似，模拟滤波器也有其性能指标，通常关注其频率响应 $H_a(j\Omega)$，特别是幅度平方响应 $|H_a(j\Omega)|^2$（$\Omega$ 是模拟角频率）。

*   **幅度平方响应指标** (通常基于最大幅度归一化为1)：
    *   **通带要求**: $\boxed{ \frac{1}{1+\epsilon^2} \le |H_a(j\Omega)|^2 \le 1, \quad |\Omega| \le \Omega_p }$
        *   这里 $1/(1+\epsilon^2)$ 对应的是通带内允许的最小幅度平方值。$\epsilon$ 是一个与通带波动 $A_p$ (dB) 相关的参数。当 $\epsilon=1$ 时，通带边缘衰减为 $10\log_{10}(1/2) \approx -3$dB。
    *   **阻带要求**: $\boxed{ 0 \le |H_a(j\Omega)|^2 \le \frac{1}{A^2}, \quad |\Omega| \ge \Omega_s }$
        *   这里 $1/A^2$ 对应的是阻带内允许的最大幅度平方值。$A$ 是一个与阻带衰减 $A_s$ (dB) 相关的参数。

*   **关键参数定义**:
    *   $\epsilon$: 通带波动系数，决定了通带内允许的最大衰减 $A_p$。($A_p = 10\log_{10}(1+\epsilon^2)$ dB)
    *   $A$: 阻带衰减参数，决定了阻带要求的最小衰减 $A_s$。($A_s = 20\log_{10}A$ dB)
    *   $\Omega_p$: 模拟通带截止频率。
    *   $\Omega_s$: 模拟阻带起始频率。
    *   $\Omega_c$: 模拟 -3dB 截止频率。这是 $|H_a(j\Omega_c)|^2 = 0.5$ (即幅度为 $1/\sqrt{2}$) 时的频率。对于某些滤波器类型（如巴特沃思），$\Omega_c$ 是一个核心设计参数。
    *   **归一化**: 为了简化设计和查表，我们常常将 $\Omega_p$ 或 $\Omega_c$ 归一化为 1 rad/s。

*   **图示**: ![](Pic/Pasted%20image%2020250430111526.png)

#### 4.2 模拟滤波器的逼近艺术：为何需要“逼近”？ 🤔

*   **理想很丰满，现实很骨感**
    *   我们梦想中的理想滤波器（例如理想低通）应该具有完美的矩形幅度响应（通带内恒定增益，阻带内零增益）和完美的线性相位响应（保证信号无失真传输）。
    *   ![](Pic/Pasted%20image%2020250430111808.png)
    *   然而，这样的理想滤波器是**无法物理实现**的。为什么？因为它们的冲激响应 $h_a(t)$ 必须是无限长的，并且是非因果的 (例如，理想低通滤波器的冲激响应是 $sinc(t)$ 函数，它在 $t<0$ 时不为零)。

*   **逼近：退而求其次的智慧**
    *   既然理想无法实现，我们就需要用一个**可实现的系统函数 $H_a(s)$** (通常是 $s$ 的有理分式) 来逼近理想滤波器的特性。
    *   “逼近”的目标是，让 $H_a(s)$ 的频率响应 $H_a(j\Omega)$ 在我们关心的通带和阻带内，尽可能地接近理想特性，并且严格满足给定的技术指标 ($\Omega_p, \Omega_s, \epsilon, A$)。

#### 4.3 从幅度特性到系统函数：$|H_a(j\Omega)|^2 \rightarrow H_a(s)$ 的桥梁 🧠

在模拟滤波器设计中，我们往往先根据指标确定满足要求的**幅度平方函数 $|H_a(j\Omega)|^2$**，然后再从中反求出系统函数 $H_a(s)$。这个过程至关重要。

*   **关键的数学关系**:
    $\boxed{ |H_a(j\Omega)|^2 = H_a(s)H_a(-s)|_{s=j\Omega} }$

*   **推导思路简述**:
    1.  对于一个实系数的物理可实现系统，其冲激响应 $h_a(t)$ 是实函数。其频率响应 $H_a(j\Omega)$ 具有共轭对称性：$H_a(-j\Omega) = H_a^*(j\Omega)$。
    2.  因此，幅度平方可以写为：$|H_a(j\Omega)|^2 = H_a(j\Omega) H_a^*(j\Omega) = H_a(j\Omega) H_a(-j\Omega)$。
    3.  通过解析延拓，将 $j\Omega$ 替换为复变量 $s$ (即令 $s=j\Omega$, 或 $\Omega = s/j = -js$)，我们就得到了 $s$ 域的表达式：$|H_a(j\Omega)|^2|_{\Omega^2=-s^2}$ 可以记作 $|H_a(s)|^2$ (这是一个符号滥用，更准确的应为 $G(s^2)$)，它等于 $H_a(s)H_a(-s)$。这个函数是关于 $s^2$ 的实系数有理函数。

*   **求解 $H_a(s)$ 的步骤**:
    1.  **构造 $H_a(s)H_a(-s)$**: 根据选定的逼近方法（如巴特沃思、切比雪夫等）和技术指标，得到幅度平方函数 $|H_a(j\Omega)|^2$ 的表达式，然后将其中的 $\Omega^2$ 替换为 $-s^2$，得到 $H_a(s)H_a(-s)$。
    2.  **寻找零极点**: 求出 $H_a(s)H_a(-s)$ 的所有零点和极点。一个重要的特性是，这些零极点在 $s$ 平面上是成对出现的：如果 $p_0$ 是一个极点，那么 $-p_0$ 也是一个极点；如果 $z_0$ 是一个零点，那么 $-z_0$ 也是一个零点。如果系数是实的，它们还会关于实轴共轭对称。
    3.  **选择极点 (为了稳定与因果)**: 要想得到一个**稳定且因果**的滤波器 $H_a(s)$，我们必须选择 $H_a(s)H_a(-s)$ 在 **$s$ 左半平面 (LHP)** 的所有极点作为 $H_a(s)$ 的极点。
    4.  **选择零点 (根据需求)**:
        *   **最小相位系统**: 如果要求滤波器是最小相位的（即所有零点也在LHP），则选择 $H_a(s)H_a(-s)$ 在 $s$ 左半平面的所有零点作为 $H_a(s)$ 的零点。
        *   **非最小相位系统**: 如果没有最小相位要求，零点的选择就比较灵活。可以将LHP和RHP (右半平面) 的零点任意分配给 $H_a(s)$ 和 $H_a(-s)$，只要能保证 $H_a(s)$ 的系数是实的（即复数零点必须共轭成对出现）。对于纯虚轴上的零点，它们必须是偶数阶的，由 $H_a(s)$ 和 $H_a(-s)$ 各取其半。
    5.  **确定增益因子**: 最后，根据滤波器在某个特定频率（如 $s=0$ 对于低通，或 $s=\infty$ 对于高通）的增益要求，确定比例因子 $K_0$。

*   **$H_a(s)$ 的一般形式**:
    $$ H_a(s) = K_0 \frac{\prod (s-z_i)}{\prod (s-p_k)} $$
    其中 $p_k$ 均为LHP极点，$z_i$ 为所选零点。

*   **示例回顾**:
    *   给定 $|H(j\Omega)|^2 = \frac{4(\Omega^4+64)}{\Omega^4 - 10\Omega^2 + 169}$
    *   令 $\Omega^2 = -s^2$, 得 $H(s)H(-s) = \frac{4(s^4+64)}{s^4 + 10s^2 + 169}$
    *   求得 $H(s)H(-s)$ 的极点: $\pm 2 \pm 3j$ (四个)；零点: $\pm 2 \pm 2j$ (四个)。
    *   为了稳定， $H(s)$ 的极点选择LHP的: $p_1 = -2+3j, p_2 = -2-3j$。
    *   若要求最小相位，$H(s)$ 的零点选择LHP的: $z_1 = -2+2j, z_2 = -2-2j$。
    *   构成 $H(s) = K_0 \frac{(s - (-2+2j))(s - (-2-2j))}{(s - (-2+3j))(s - (-2-3j))} = K_0 \frac{s^2+4s+8}{s^2+4s+13}$。
    *   根据低频增益 $|H(j0)|^2 = 4 \times 64 / 169 \Rightarrow |H(j0)| = 16/13$。而从 $H(s)$ 看，$H(0) = K_0 \frac{8}{13}$。若要求直流增益为正且等于$|H(j0)|$，则 $K_0 \frac{8}{13} = \frac{16}{13} \Rightarrow K_0 = 2$。
    *   最终 $H(s) = \frac{2(s^2+4s+8)}{s^2+4s+13} = \frac{2s^2+8s+16}{s^2+4s+13}$。

#### 4.4 主流的模拟滤波器逼近方法概述

我们已经知道要用可实现函数去“逼近”理想特性。那么，具体有哪些成熟的逼近方法呢？
这些方法通常是先构造一个所谓的 **特征函数 (Characteristic Function) $K(j\Omega)$** (或其平方 $|K(j\Omega)|^2$)，然后通过它来间接定义 $|H_a(j\Omega)|^2$。

*   **特征函数 $K(j\Omega)$ 与 $|H_a(j\Omega)|^2$ 的关系**:
    一个常见的关系式是：
    $\boxed{ |H_a(j\Omega)|^2 = \frac{1}{1+|K(j\Omega)|^2} }$
    或者，如果考虑归一化到通带最大增益为 $H_0$：
    $|H_a(j\Omega)|^2 = \frac{H_0^2}{1+|K(j\Omega)|^2}$

    从这个关系式可以看出：
    *   在**通带**，我们希望 $|K(j\Omega)|^2 \approx 0$，这样 $|H_a(j\Omega)|^2 \approx 1$ (或 $H_0^2$)。
    *   在**阻带**，我们希望 $|K(j\Omega)|^2 \gg 1$，这样 $|H_a(j\Omega)|^2 \ll 1$ (或 $H_0^2$)。

    因此，设计目标就转化为：找到一个合适的关于 $\Omega$ 的**多项式或有理函数** $K(j\Omega)$，使其满足上述在通带和阻带的要求。

*   **几种经典的逼近类型**:
    1.  **巴特沃思 (Butterworth) 逼近**: 特点是**最大平坦幅度响应**。通带和阻带都是单调变化的。它的 $K(j\Omega) = (\Omega/\Omega_c)^N$。
    2.  **切比雪夫 (Chebyshev) 逼近**:
        *   **I 型**: 通带内等波纹（在允许的范围内波动），阻带单调下降。过渡带比同阶巴特沃思窄。
        *   **II 型 (逆切比雪夫)**: 通带单调（通常是平坦的），阻带内等波纹。
    3.  **椭圆 (Elliptic / Cauer) 逼近**: 通带和阻带都呈现等波纹特性。在阶数相同的情况下，它具有最窄的过渡带，逼近效果最好，但相位特性也最差，设计也最复杂。

    我们首先详细学习最基础也是最经典的巴特沃思滤波器。

### 5. 巴特沃思 (Butterworth) 低通滤波器设计：追求极致平坦 ⭐

巴特沃思滤波器，因其在通带和阻带都具有单调的、在 $\Omega=0$ 附近“最大程度平坦”的幅度响应而闻名。

#### 5.1 Butterworth 逼近的鲜明特性

*   **幅度平方函数的定义**:
    巴特沃思低通滤波器的幅度平方响应由下式给出：
    $\boxed{ |H_a(j\Omega)|^2 = \frac{1}{1+(\Omega/\Omega_c)^{2N}} }$
    这里：
    *   $N$: 滤波器的 **阶数 (Order)**，是一个正整数。阶数越高，滤波器性能越接近理想。
    *   $\Omega_c$: **-3dB 截止频率 (Cutoff Frequency)**。在该频率点，幅度平方响应 $|H_a(j\Omega_c)|^2 = 1/(1+1^{2N}) = 1/2$，即幅度为 $1/\sqrt{2}$，衰减约为 3dB。

*   **巴特沃思滤波器的“个性签名”**:
    1.  **恒定的 -3dB 点**: 无论阶数 $N$ 如何变化，在 $\Omega = \Omega_c$ 处，幅度衰减总是 3dB。因此，$\Omega_c$ 也常被称为“3dB带宽”。
    2.  **单调性**: 幅度响应 $|H_a(j\Omega)|$ 在整个频率轴 ($0 \le \Omega < \infty$) 上是单调递减的。通带内没有波纹，阻带内也没有波纹。
    3.  **最大平坦性 (Maximally Flat)**: 这是巴特沃思滤波器的核心特征。在 $\Omega=0$ (直流) 附近，其幅度响应曲线尽可能地平坦。具体来说，$|H_a(j\Omega)|^2$ 对 $\Omega$ 的各阶导数，在 $\Omega=0$ 处的前 $(2N-1)$ 阶都为零。
        *   当 $\Omega \to 0$ 时， $|H_a(j\Omega)|^2 \to 1$ (直流增益为1，或无衰减)。
        *   当 $\Omega \to \infty$ 时， $|H_a(j\Omega)|^2 \to 0$。在高频区域，其衰减速率为 $-20N$ dB/十倍频程 (即频率增加10倍，衰减增加 $20N$ dB)。

*   **阶数 $N$ 的影响**:
    *   $N$ 越大，通带（尤其在 $\Omega=0$ 附近）就越平坦，过渡带就越窄（即从通带到阻带的衰减变化越陡峭），阻带衰减也越大。总的来说，N 越大，滤波器特性越接近理想的矩形低通滤波器。
    *   ![](Pic/Pasted%20image%2020250430132322.png)
*   **重要性质总结**:
    *   $N$ 越大，特性越逼近理想。
    *   它是 "全极点型" 滤波器，意味着其系统函数 $H_a(s)$ 的所有有限零点都在无穷远处 (即分子为常数)。

#### 5.2 按部就班：Butterworth 低通滤波器的设计步骤 (公式法)

假设我们得到了模拟低通滤波器的技术指标：通带截止频率 $\Omega_p$、通带最大衰减 $A_p$ (dB)、阻带起始频率 $\Omega_s$、阻带最小衰减 $A_s$ (dB)。

1.  **第一步：确定滤波器的阶数 N** 🚩
    *   我们需要找到满足给定指标的最小整数阶数 $N$。
    *   根据 $A_p$ 和 $A_s$ 的定义以及巴特沃思幅度平方公式：
        *   在通带边缘 $\Omega_p$: $A_p = 10 \log_{10} [1 + (\Omega_p/\Omega_c)^{2N}]$
        *   在阻带边缘 $\Omega_s$: $A_s = 10 \log_{10} [1 + (\Omega_s/\Omega_c)^{2N}]$
    *   从这两个式子中消去未知的 $\Omega_c$，或者更常见的是，利用 $\epsilon^2 = 10^{0.1A_p}-1$ 和 $A^2 = 10^{0.1A_s}-1$ (这里的 $A$ 是之前定义的阻带衰减参数，不是 $A_s$)，并结合 $|H_a(j\Omega_p)|^2 = 1/(1+\epsilon^2)$ 和 $|H_a(j\Omega_s)|^2 \le 1/A^2$，可以推导出计算 $N$ 的公式：
        $\boxed{ N \ge \frac{\log_{10}[(10^{0.1A_s}-1)/(10^{0.1A_p}-1)]}{2 \log_{10}(\Omega_s/\Omega_p)} }$
        (这个公式更常用，其中 $10^{0.1A_s}-1$ 对应 $(\Omega_s/\Omega_c)^{2N}$，而 $10^{0.1A_p}-1$ 对应 $(\Omega_p/\Omega_c)^{2N}$，两者相除消去 $\Omega_c$)
    *   计算出的 $N$ 值通常不是整数，**必须向上取整**，即取不小于计算结果的最小整数。

2.  **第二步：确定 -3dB 截止频率 $\Omega_c$** ⏱️
    *   一旦确定了整数阶数 $N$，我们就可以利用任一边界条件（通带或阻带）来精确计算 $\Omega_c$。
    *   **通常做法是让滤波器在某个频点“刚好”满足指标**。例如，如果我们选择让滤波器在通带截止频率 $\Omega_p$ 处精确达到 $A_p$ 的衰减，则：
        $\boxed{ \Omega_c = \frac{\Omega_p}{(10^{0.1A_p}-1)^{1/(2N)}} }$
    *   或者，如果我们选择让滤波器在阻带起始频率 $\Omega_s$ 处精确达到 $A_s$ 的衰减，则：
        $\boxed{ \Omega_c = \frac{\Omega_s}{(10^{0.1A_s}-1)^{1/(2N)}} }$
    *   **如何选择？**
        *   如果用 $\Omega_p$ 和 $A_p$ 计算 $\Omega_c$，则滤波器在 $\Omega_p$ 处的衰减恰好为 $A_p$，而在 $\Omega_s$ 处的衰减将 $\ge A_s$ (有裕量)。
        *   如果用 $\Omega_s$ 和 $A_s$ 计算 $\Omega_c$，则滤波器在 $\Omega_s$ 处的衰减恰好为 $A_s$，而在 $\Omega_p$ 处的衰减将 $\le A_p$ (有裕量)。
        *   实际应用中，可以都算一下，选择一个使得两个指标都能满足且对设计更有利的值（例如，有时希望通带尽可能宽，有时希望阻带衰减尽快开始）。一个常见的策略是选择较小的 $\Omega_c$ 值，以确保两个指标都得到满足或有裕量。
        *   **特殊情况**: 如果通带指标恰好是 $A_p = 3$dB，那么 $10^{0.1A_p}-1 = 1$, 此时 $\Omega_c = \Omega_p$。

3.  **第三步：构建归一化巴特沃思低通原型 $H(p)$** 
    *   为了简化计算和利用标准化的表格，我们通常先设计一个 **归一化 (Normalized)** 的巴特沃思低通滤波器，其 -3dB 截止频率为 1 rad/s。我们用复频率变量 $p = s/\Omega_c$ 来表示归一化频率。
    *   归一化后的幅度平方函数为：$|H(p)|^2|_{p=j\lambda} = \frac{1}{1+\lambda^{2N}}$ (其中 $\lambda = \Omega/\Omega_c$ 是归一化频率)。
    *   对应的 $H(p)H(-p)$ 表达式为: $H(p)H(-p) = \frac{1}{1+(-1)^N p^{2N}}$ (因为 $p=s/\Omega_c$, $s=j\Omega$, $\lambda = \Omega/\Omega_c$, 所以 $p=j\lambda$, $p^2=-\lambda^2$, $\lambda^2=-p^2$。代入 $1/(1+\lambda^{2N})$ 得到 $1/(1+(-p^2)^N) = 1/(1+(-1)^N p^{2N})$)。
    *   **关键：寻找归一化极点 $p_k$**
        $H(p)H(-p)$ 的极点是方程 $1+(-1)^N p^{2N} = 0$ 的根。这些根可以统一表示为：
        $\boxed{ p_k = e^{j\frac{\pi(2k+N+1)}{2N}}, \quad k=0, 1, \dots, 2N-1 }$
        这 $2N$ 个极点均匀分布在 $p$ 平面的**单位圆**上，相邻极点之间的角间距为 $\pi/N$。
        *   **极点分布特点**:
            *   它们关于虚轴对称。
            *   没有极点恰好落在虚轴上。
            *   如果 $N$ 是奇数，则 $p=-1$ (即 $e^{j\pi}$) 是一个极点。如果 $N$ 是偶数，则实轴上没有极点。
            *   ![](Pic/Pasted%20image%2020250430135417.png) (图示为巴特沃思极点在单位圆上的分布)
    *   **选择稳定的极点**: 为了得到稳定因果的 $H(p)$，我们只选择位于 $p$ **左半平面 (LHP)** 的 $N$ 个极点。这些LHP极点通常对应于 $k=0, 1, \dots, N-1$ 在上述通式中的特定取值范围，确保角度在 $(\pi/2, 3\pi/2)$ 之间。更简洁的LHP极点表达式是:
        $\boxed{ p_k = e^{j\left(\frac{\pi}{2} + \frac{(2k+1)\pi}{2N}\right)}, \quad k=0, 1, \dots, N-1 }$
    *   **归一化系统函数 $H(p)$**:
        由于巴特沃思是全极点滤波器，且通常要求 $H(0)=1$ (直流增益为1)，所以：
        $\boxed{ H(p) = \frac{1}{\prod_{k=0}^{N-1} (p - p_k)} }$
        其中 $p_k$ 是选出的 $N$ 个LHP极点。

4.  **第四步：反归一化得到实际系统函数 $H_a(s)$** 
    *   最后一步，我们将归一化变量 $p$ 替换回 $s/\Omega_c$:
        $\boxed{ H_a(s) = H(p)|_{p=s/\Omega_c} = \frac{1}{\prod_{k=0}^{N-1} (s/\Omega_c - p_k)} = \frac{(\Omega_c)^N}{\prod_{k=0}^{N-1} (s - p_k \Omega_c)} }$
        这样，我们就得到了目标模拟低通滤波器的系统函数 $H_a(s)$。

#### 5.3 便捷之路：Butterworth 设计的查表/图法 📈📉

除了公式计算，对于常见的阶数，巴特沃思滤波器的设计参数也可以通过查表或查图来快速获得。

1.  **频率参数的归一化 (通常以 $\Omega_p$ 为参考)**:
    *   定义一个归一化系数，例如 $\lambda_s = \Omega_s / \Omega_p$。此时，通带边缘的归一化频率为1。
    *   例如：设计要求 $\Omega_p=100 rad/s, A_p=1dB, \Omega_s=200 rad/s, A_s=20dB$。则 $\lambda_s = 200/100 = 2$。我们需要在 $\lambda=1$ 处衰减 $\le 1dB$，在 $\lambda=2$ 处衰减 $\ge 20dB$。

2.  **查阅归一化衰减特性图确定阶数 N**:
    *   存在各种巴特沃思滤波器归一化幅度特性图，通常横轴是归一化频率 ($\Omega/\Omega_c$ 或 $\Omega/\Omega_p$)，纵轴是衰减 (dB)。
    *   根据计算出的 $\lambda_s$ 和要求的 $A_s$ (以及在 $\lambda_p=1$ 处的 $A_p$)，在图上找到能够同时满足这些条件的最低阶数 $N$ 的曲线。
    *   ![](Pic/Pasted%20image%2020250430135702.png) (右图更实用，纵轴表示总衰减)

3.  **查表确定归一化低通原型 $H(p)$ 的分母多项式 $B_N(p)$**:
    *   一旦确定了阶数 $N$，就可以查阅“归一化巴特沃思低通滤波器分母多项式表”。这些表通常直接给出 $H(p) = 1/B_N(p)$ 中 $B_N(p)$ 的系数，或者其因式分解形式。
    *   $B_N(p) = (p-p_0)(p-p_1)\cdots(p-p_{N-1})$。
    *   ![](Pic/Pasted%20image%2020250430140002.png)

4.  **精确计算（或修正）$\Omega_c$**:
    *   如果查图时参考的是 $\Omega_c$ (例如图的横轴是 $\Omega/\Omega_c$)，并且 $A_p$ 恰好是3dB，那么 $\Omega_c = \Omega_p$。
    *   如果 $A_p \ne 3dB$，或者查图时参考的是 $\Omega_p$，则在确定 $N$ 之后，仍需要使用 5.2 节中的公式来精确计算 $\Omega_c$，通常是基于 $A_p$ 和 $\Omega_p$ 来计算，以确保通带指标被精确满足: $\Omega_c = \Omega_p / (10^{0.1A_p}-1)^{1/(2N)}$。

5.  **反归一化得到 $H_a(s)$**:
    *   将 $p = s/\Omega_c$ 代入查表得到的 $H(p) = 1/B_N(p)$，即 $H_a(s) = 1/B_N(s/\Omega_c)$。如果 $B_N(p)$ 是 $p^N + b_{N-1}p^{N-1} + \dots + b_1p + b_0$ 的形式，那么 $H_a(s)$ 的分母将是 $(s/\Omega_c)^N + b_{N-1}(s/\Omega_c)^{N-1} + \dots + b_0$。整理后分子会是 $(\Omega_c)^N$。

*   **查表法示例**:
    *   指标: $\Omega_p = 2\pi \cdot 5k \text{ rad/s}$, $A_p=3dB$, $\Omega_s = 2\pi \cdot 10k \text{ rad/s}$, $A_s=30dB$。
    *   (1) 由于 $A_p=3dB$, 所以 $\Omega_c = \Omega_p = 2\pi \cdot 5k$。归一化阻带频率 $\lambda_s = \Omega_s/\Omega_c = (2\pi \cdot 10k) / (2\pi \cdot 5k) = 2$。
    *   (2) 查巴特沃思衰减图 (横轴 $\Omega/\Omega_c$，纵轴衰减dB): 在 $\Omega/\Omega_c = 2$ 处，要求衰减 $A_s \ge 30dB$。
        *   N=4 时，衰减约 $10\log_{10}(1+2^{2\cdot 4}) = 10\log_{10}(1+256) \approx 10\log_{10}(257) \approx 24.1$dB (不够)。
        *   N=5 时，衰减约 $10\log_{10}(1+2^{2\cdot 5}) = 10\log_{10}(1+1024) \approx 10\log_{10}(1025) \approx 30.1$dB (满足)。
        所以选择阶数 $N=5$。
    *   (3) 查 $N=5$ 的巴特沃思归一化分母多项式表:
        $B_5(p) = (p+1)(p^2+0.6180p+1)(p^2+1.6180p+1)$。
        所以 $H(p) = \frac{1}{(p+1)(p^2+0.6180p+1)(p^2+1.6180p+1)}$。
    *   (4) $\Omega_c$ 已确定为 $\Omega_p = 2\pi \cdot 5000 = \pi \cdot 10^4$ rad/s。
    *   (5) 反归一化，令 $p = s/\Omega_c = s/(\pi \cdot 10^4)$:
        $H_a(s) = \frac{1}{(\frac{s}{\Omega_c}+1)((\frac{s}{\Omega_c})^2+0.6180\frac{s}{\Omega_c}+1)((\frac{s}{\Omega_c})^2+1.6180\frac{s}{\Omega_c}+1)}$
        将其整理可得：
        $H_a(s) = \frac{(\Omega_c)^5}{(s+\Omega_c)(s^2+0.6180\Omega_c s+\Omega_c^2)(s^2+1.6180\Omega_c s+\Omega_c^2)}$
        代入 $\Omega_c = \pi \cdot 10^4$ 即可。

#### 5.4 借助现代工具：Matlab 实现 💻

Matlab 提供了强大的函数来简化巴特沃思模拟滤波器的设计：

*   `[n, Wn] = buttord(Wp, Ws, Rp, Rs, 's')`:
    *   功能: 根据给定的通带和阻带指标，自动计算巴特沃思滤波器的最低阶数 `n` ($N$) 和实际的 -3dB 截止频率 `Wn` ($\Omega_c$)。
    *   参数:
        *   `Wp`, `Ws`: 模拟通带截止频率 $\Omega_p$ 和模拟阻带起始频率 $\Omega_s$ (单位: rad/s)。
        *   `Rp`, `Rs`: 通带最大衰减 $A_p$ 和阻带最小衰减 $A_s$ (单位: dB，注意是正值)。
        *   `'s'`: 关键参数，指明是设计模拟滤波器 (analog filter)。
*   `[z, p, k] = buttap(n)`:
    *   功能: 计算 `n` 阶 **归一化** (即 $\Omega_c=1$ rad/s) 巴特沃思模拟低通滤波器的零点 `z` (对于巴特沃思，`z` 是空矩阵)、极点 `p` 和增益 `k`。
*   `[b, a] = zp2tf(z, p, k)`:
    *   功能: 将零点-极点-增益形式的滤波器表示转换为传递函数系数形式 (分子多项式系数 `b`，分母多项式系数 `a`)。
*   `[b, a] = butter(n, Wn, 's')`:
    *   功能: **一步到位**设计出 $N$ 阶、-3dB截止频率为 $Wn (\Omega_c)$ 的巴特沃思模拟低通滤波器，直接返回其传递函数的分子 `b` 和分母 `a` 系数。这通常是最便捷的函数。
    *   `'ftype'` (可选): 可以是 `'low'` (默认低通), `'high'` (高通), `'bandpass'`, `'stop'`。
*   `H = tf(b, a)`:
    *   功能: 根据分子分母系数创建一个传递函数模型对象 `H`，方便后续分析。
*   `[mag, phase, wout] = freqs(b, a, N_points)` 或 `freqs(b, a, w_vector)`:
    *   功能: 计算模拟滤波器的频率响应。返回幅值 `mag`、相位 `phase`，以及对应的频率点 `wout`。

**使用流程示例 (推荐)**:
1.  用 `buttord` 确定阶数 `n` 和截止频率 `Wn`。
    `[n, Wn] = buttord(Omega_p, Omega_s, Ap, As, 's');`
2.  用 `butter` 直接得到滤波器系数。
    `[b, a] = butter(n, Wn, 's');`
3.  (可选) 用 `freqs` 分析频率响应。
    `freqs(b, a);`

#### 5.5 巴特沃思设计的反思：优点与局限性

*   **设计流程总结图**: ![](Pic/Pasted%20image%2020250430140120.png)
*   **巴特沃思滤波器的优点**:
    *   设计简单，公式明确。
    *   通带和阻带特性都是单调的，在 $\Omega=0$ 处具有最大平坦特性，这对于某些要求信号幅度在低频段尽可能不失真的应用很有利。
*   **巴特沃思滤波器的缺点 (B 型滤波器的代价)**:
    *   **过渡带相对较宽**: 为了追求通带内的极致平坦（尤其是在 $\Omega=0$ 附近），巴特沃思滤波器牺牲了过渡带的陡峭程度。在相同的阶数 $N$ 下，其过渡带通常比切比雪夫或椭圆滤波器要宽。
    *   **通带边缘逼近不佳**: 除非阶数 $N$ 非常高，否则在通带截止频率 $\Omega_p$ 附近，其幅度响应下降较缓。衰减从 $\Omega=0$ 处的 0dB 开始，缓慢增加到 $\Omega_c$ 处的 3dB，然后再加速下降。如果 $A_p$ 要求很小 (例如 0.1dB)，那么实际的 -3dB 点 $\Omega_c$ 就会远小于 $\Omega_p$，导致有效通带变窄。

*   **如何改进？——走向等波纹逼近**:
    如果我们需要更窄的过渡带，或者在整个通带/阻带内更有效地利用允许的误差，我们就需要考虑其他逼近方法，如**切比雪夫滤波器**或**椭圆滤波器**。这些滤波器允许在通带或阻带（或两者都）出现等幅度的波纹，以此为代价换取更陡峭的过渡特性。

---

**下一站预告：** 我们将继续探索其他类型的模拟滤波器逼近方法，例如切比雪夫滤波器。然后，我们将学习如何将这些精心设计的模拟滤波器 $H_a(s)$ 转换为我们最终需要的数字滤波器 $H(z)$，主要方法包括**冲激响应不变法**和**双线性变换法**。敬请期待！