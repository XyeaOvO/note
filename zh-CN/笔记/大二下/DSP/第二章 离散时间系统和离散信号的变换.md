# 第二章 离散时间系统和离散信号的变换 

### 主要内容概览 ✨

*   模拟信号与数字信号间的转换 (A/D, D/A)
*   离散系统的基本知识 (定义, 分类, LTI 系统)
*   离散信号的两种主要变换形式 (时域 vs 频域)
*   离散时间傅里叶变换 (DTFT)、Z 变换
*   系统函数、零极点、稳定性分析
*   离散傅里叶级数 (DFS)

---

### 1. 模拟信号和数字信号间的转换 🔄

#### 1.1 整体流程

典型的数字信号处理流程包括：
模拟输入信号 $x_a(t)$ ➡️ 限带滤波 (抗混叠) ➡️ A/D 转换 (取样+量化) ➡️ 数字信号处理 (DSP) ➡️ D/A 转换 (内插) ➡️ 平滑滤波 (抗镜像) ➡️ 模拟输出信号 $y_a(t)$
![](Pic/Pasted%20image%2020250421081033.png)
1.  **抗混叠** 🚫
    *   **方法**: 在进行 A/D 取样**之前**，使用一个**低通滤波器**（称为**抗混叠滤波器**）将模拟信号中高于 $f_s/2$ 的频率成分滤除或大幅衰减。这样，进入取样器的信号就近似满足了带限条件，从而避免了高频成分混叠到有用频带内。

2.  **抗镜像** 🚫
    *   **方法**: 在 D/A 转换器**之后**（通常在零阶保持器等初步重建电路之后），使用一个**低通滤波器**（称为**平滑滤波器**或**抗镜像滤波器**）来保留基带频谱（通常是 $0$ 到 $f_s/2$），同时衰减掉 $f_s$ 及其倍数附近的高频镜像频谱。

**简单来说：**

*   **抗混叠**是在 **A/D 前**做低通滤波，防止高频“捣乱分子”混进来。
*   **抗镜像**是在 **D/A 后**做低通滤波，去除 D/A 过程产生的“多余影子”。

两者都使用低通滤波器，但目的和在信号处理链中的位置不同。

#### 1.2 取样 (Sampling)

*   **定义**: 从连续时间信号 $x_a(t)$ 中提取离散样本 $x[n]$ 的过程，即时间轴上的离散化。
    ![](Pic/Pasted%20image%2020250421082600.png)
*   **数学表示**:
    $$
    x[n] = x_a(t)|_{t=nT} = x_a(nT)
    $$
*   **关键参数**:
    *   $T$: **取样周期**
    *   $f_s = 1/T$: **取样频率**
    *   $\Omega_s = 2\pi f_s$: **取样角频率**
#### 1.3 取样定理📜

*   **定理内容**: 对于一个**带宽有限**的信号 $x_a(t)$，其频谱 $X_a(j\Omega)$ 的最高频率分量为 $f_m$ (或 $\Omega_m = 2\pi f_m$)，如果取样频率 $f_s$ 满足：
    $$
    \boxed{f_s \ge 2f_m \quad (\text{或 } \Omega_s \ge 2\Omega_m)}
    $$
    则 $x_a(t)$ 可以由其取样值 $x[n]=x_a(nT)$ 唯一表示，且可以无失真恢复。
*   **奈奎斯特频率/速率**: 最低允许的取样频率 $\boxed{f_s = 2f_m}$ 称为奈奎斯特取样频率。
*   **取样间隔**: $T = 1/f_s \le 1/(2f_m)$。

#### 1.4 取样的时域分析 ⏱️

*   **模型**: 理想取样可以看作是将 $x_a(t)$ 乘以一个冲击串 $\delta_T(t) = \sum_{n=-\infty}^{\infty} \delta(t-nT)$。
*   **取样后信号**:
    $$
    \hat{x}_a(t) = x_a(t) \cdot \delta_T(t) = x_a(t) \sum_{n=-\infty}^{\infty} \delta(t-nT)
    $$
    利用 $\delta$ 函数的取样特性：
    $$
    \boxed{\hat{x}_a(t) = \sum_{n=-\infty}^{\infty} x_a(nT) \delta(t-nT)}
    $$
    这表示取样后的信号 $\hat{x}_a(t)$ 是一个无穷多个等间隔的 $\delta$ 函数的加权序列，权重就是 $x_a(t)$ 在 $t=nT$ 处的取样值。
    ![](Pic/Pasted%20image%2020250421083223.png)

#### 1.5 取样的频域分析 📊

*   🧠 **回顾**: 时域相乘 对应 频域卷积。
*   **冲击串的傅里叶变换**: $\delta_T(t) \stackrel{\mathcal{F}}{\longleftrightarrow} \frac{2\pi}{T} \sum_{k=-\infty}^{\infty} \delta(\Omega - k\Omega_s) = \Omega_s \sum_{k=-\infty}^{\infty} \delta(\Omega - k\Omega_s)$
*   **取样信号的频谱**:
    $$
    \hat{X}_a(j\Omega) = \frac{1}{2\pi} [X_a(j\Omega) * (\Omega_s \sum_{k=-\infty}^{\infty} \delta(\Omega - k\Omega_s))]
    $$
    $$
    \boxed{\hat{X}_a(j\Omega) = \frac{1}{T} \sum_{k=-\infty}^{\infty} X_a(j(\Omega - k\Omega_s))}
    $$
    这表明，取样信号 $\hat{x}_a(t)$ 的频谱是原始信号频谱 $X_a(j\Omega)$ 以 $\Omega_s$ 为周期进行周期性延拓，并且幅度乘以 $1/T$。
    ![](Pic/Pasted%20image%2020250421083605.png)
*   **频谱混叠**:
    *   如果 $\Omega_s \ge 2\Omega_m$ (满足采样定理)，则周期延拓后的频谱在各周期之间没有重叠。可以通过一个理想低通滤波器 (截止频率 $\Omega_c$ 满足 $\Omega_m \le \Omega_c \le \Omega_s - \Omega_m$) 完整恢复出原始频谱 $X_a(j\Omega)$（乘以 $T$ 即可）。
    *   如果 $\Omega_s < 2\Omega_m$ (不满足采样定理)，则周期延拓后的频谱会发生重叠，高频成分混叠到低频区域，导致无法通过低通滤波无失真恢复原始信号。这就是**频谱混叠**现象。
*   **取样率选择**:
    *   并非越高越好，需权衡精度、速度、存储等因素，选择适中的值。体现了“矛盾统一”和“过犹不及”的思想。
#### 1.7 取样定理应用示例 💡

*   **例1**: 信号 $x(t)$ 最高频率 $f_m$。求 $y_1(t)=x(2t)$, $y_2(t)=x(t)\cdot x(2t)$, $y_3(t)=x(t)*x(2t)$ 的奈奎斯特频率。
    *   🧠 **回顾**: 时域压缩 $x(at)$ ➡️ 频域扩展 $\frac{1}{|a|}X(j\Omega/a)$；时域相乘 ➡️ 频域卷积；时域卷积 ➡️ 频域相乘。
    *   $x(2t)$：频域扩展 2 倍，最高频率 $2f_m$。奈奎斯特频率 $2(2f_m) = 4f_m$。
    *   $x(t)\cdot x(2t)$：频域卷积。$X(j\Omega)$ 带宽 $[-f_m, f_m]$，$X(j\Omega/2)/2$ 带宽 $[-2f_m, 2f_m]$。卷积后带宽 $[-3f_m, 3f_m]$。最高频率 $3f_m$。奈奎斯特频率 $2(3f_m) = 6f_m$。
    *   $x(t)*x(2t)$：频域相乘。乘积的带宽取决于带宽较宽者。$X(j\Omega)$ 带宽 $[-f_m, f_m]$，$X(j\Omega/2)/2$ 带宽 $[-2f_m, 2f_m]$。相乘后最高频率仍为 $f_m$ （因为 $X(j\Omega)=0$ for $|\Omega|>2\pi f_m$）。奈奎斯特频率 $2f_m$。

#### 1.8 工程应用拓展 🛠️

1.  **带通信号 (Bandpass Signal) 取样**:
    *   信号频谱主要集中在 $[f_L, f_H]$，带宽 $B = f_H - f_L$。
    *   若直接用 $f_s \ge 2f_H$ 可能采样率过高。
    *   可以通过**带通采样定理**，在满足特定条件时使用较低的采样率 $f_s$（通常 $f_s \ge 2B$ 但需满足特定约束），避免混叠。
        $$
        \frac{2f_H}{m} \le f_s \le \frac{2f_L}{m-1}, \quad \text{其中 } 1 \le m \le \lfloor \frac{f_H}{B} \rfloor \text{ 是整数}
        $$
    *   当 $f_H=mB$ 时，最低采样率为 $f_s = 2B$。工程上常将 $f_H$ 设计为带宽 $B$ 的整数倍。

2.  **非带限信号取样**:
    *   实际信号往往不是严格带限的。
    *   **解决方法**: 在 A/D 前使用**抗混叠滤波器** (Anti-aliasing Filter)，通常是一个模拟低通滤波器，滤除高于 $f_s/2$ 的频率成分，使信号近似带限，减小混叠。
    *   **误差**:
![](Pic/Pasted%20image%2020250421123254.png)

#### 1.9 内插 (Interpolation) / D/A 变换

*   **目的**: 从离散样本 $x[n]$ 恢复连续信号 $x_a(t)$。
*   **原理**: 实质上是让取样信号 $\hat{x}_a(t) = \sum x_a(nT)\delta(t-nT)$ 通过一个**低通滤波器 (LPF)** $h(t)$。
    $$
    y_a(t) = \hat{x}_a(t) * h(t)
    $$
*   **理想内插**: 使用理想低通滤波器，其频率响应 $H(j\Omega)$ 为：
    $$
    H(j\Omega) = \begin{cases} T, & |\Omega| < \Omega_c \\ 0, & |\Omega| \ge \Omega_c \end{cases}
    $$
    其中 $\Omega_m \le \Omega_c \le \Omega_s - \Omega_m$。（通常取 $\Omega_c = \Omega_s/2 = \pi/T$）

*   **理想内插滤波器的冲激响应**:
    $$
    h(t) = \mathcal{F}^{-1}[H(j\Omega)] = \frac{T}{2\pi} \int_{-\pi/T}^{\pi/T} e^{j\Omega t} d\Omega = \frac{\sin(\pi t / T)}{\pi t / T} = \text{sinc}(\frac{t}{T})
    $$
*   **时域内插公式 (信号重构)**:
    $$
    y_a(t) = \hat{x}_a(t) * h(t) = \sum_{n=-\infty}^{\infty} x_a(nT) \delta(t-nT) * \text{sinc}(\frac{t}{T})
    $$
    $$
    \boxed{ y_a(t) = \sum_{n=-\infty}^{\infty} x_a(nT) \frac{\sin[\pi(t-nT)/T]}{\pi(t-nT)/T} }
    $$
    这表明恢复的信号是无穷多个 sinc 函数的叠加，每个 sinc 函数以 $t=nT$ 为中心，幅度为 $x_a(nT)$。
![](Pic/Pasted%20image%2020250421125917.png)
![](Pic/Pasted%20image%2020250421125929.png)
*   **理想 D/A 的条件**:
    1.  原始信号 $x_a(t)$ **带限**。
    2.  满足采样定理 $\Omega_s \ge 2\Omega_m$。
    3.  使用**理想低通滤波器** (Sinc 内插函数)。
*   **实际 D/A**: 理想 LPF 物理不可实现 (非因果，无限长)。实际中用**近似**的模拟 LPF。
    *   **零阶保持器 (Zero-Order Hold, ZOH)**: 将每个样本值保持一个采样周期 $T$。相当于冲激响应为 $h_0(t) = 1$ for $0 \le t < T$，0 otherwise。
    *   **一阶保持器 (First-Order Hold, FOH)**: 用直线连接相邻样本点。
    *   **高阶保持器/样条内插**等。
    *   通常 ZOH/FOH 后还需接一个**平滑滤波器 (Smoothing Filter)** 来更好地抑制高频镜像成分。![](Pic/Pasted%20image%2020250421130100.png)

---

### 2. 离散系统的基本知识 🧱

#### 2.1 离散时间序列运算 🔢

*   **线性卷积**: LTI 系统输出的计算基础。
    $$
    \boxed{ y[n] = x[n] * h[n] = \sum_{k=-\infty}^{\infty} x[k]h[n-k] }
    $$
    两个序列卷积的结果仍是一个序列。
*   **累加**:
    $$
    \boxed{ y[n] = \sum_{k=-\infty}^{n} x[k] }
    $$

#### 2.2 常用离散时间序列 📉

*   **单位脉冲序列**: $\delta[n] = \begin{cases} 1, & n=0 \\ 0, & n \ne 0 \end{cases}$
*   **单位阶跃序列 (Unit Step Sequence)**: $u[n] = \begin{cases} 1, & n \ge 0 \\ 0, & n < 0 \end{cases}$
*   **正弦序列**: $x[n] = A\sin(\omega_0 n + \phi)$ or $A\cos(\omega_0 n + \phi)$
    *   $\omega_0$: 数字角频率，单位是弧度/样本。
    *   模拟角频率 $\Omega$ (rad/s) 和数字角频率 $\omega$ (rad/sample) 的关系: $\boxed{\omega = \Omega T_s = \frac{\Omega}{f_s}}$
    *   解释：[数字角频率和模拟角频率的关系](推导/数字角频率和模拟角频率的关系.md)
*   **复指数序列**: $x[n] = A e^{j(\omega_0 n + \phi)}$

#### 2.3 离散序列的周期性 🔄

*   **定义**: 序列 $x[n]$ 是周期的，如果存在一个整数 $N>0$，使得 $x[n] = x[n+N]$ 对所有 $n$ 成立。最小的 $N$ 称为**基本周期**。
*   **正弦/复指数序列的周期性**: $x[n] = A e^{j(\omega_0 n + \phi)}$ (或其实部/虚部) 是周期的，当且仅当其数字角频率 $\omega_0$ 满足:
    $$
    \omega_0 = \frac{2\pi k}{N}
    $$
    或者说 $\frac{\omega_0}{2\pi} = \frac{k}{N}$ 是一个**有理数**。此时，基本周期 $N$ 是满足上式的最小正整数 (取 $k/N$ 为最简分数)。
*   **判别**:
    1.  计算 $\frac{2\pi}{\omega_0}$。
    2.  如果结果是**整数** $N$，则序列周期为 $N$。
    3.  如果结果是**有理数** $N/M$ (最简形式)，则序列周期为 $N$。($M$ 表示序列的一个周期覆盖了模拟信号的 $M$ 个周期)。
    4.  如果结果是**无理数**，则序列**非周期**。
*   **示例**:
    *   $x[n]=\sin(0.4n)$: $\omega_0=0.4$, $2\pi/0.4 = 5\pi$ (无理数)，非周期。
    *   $x[n]=\sin(4\pi n/11)$: $\omega_0=4\pi/11$, $2\pi/\omega_0 = 11/2$ (有理数, N=11, M=2)，周期为 $N=11$。
    *   $e^{j(2\pi/3)n} - e^{j(4\pi/5)n}$: 第一项周期 $N_1=3$，第二项周期 $N_2=5$。和的周期是 $N = \text{LCM}(N_1, N_2) = \text{LCM}(3,5) = 15$。

#### 2.4 离散时间系统 ⚙️

*   **定义**: 将输入序列 $x[n]$ 变换成输出序列 $y[n]$ 的一种运算或规则，记作 $y[n] = T[x[n]]$。

*   **系统分类 (基本性质)**:
    1.  **线性**: 满足叠加原理。
        $$
        \boxed{ T[a x_1[n] + b x_2[n]] = a T[x_1[n]] + b T[x_2[n]] }
        $$
        *   检查方法：分别计算左边和右边，看是否相等。注意任何非零的常数项或非线性运算 (如平方、乘积) 都会破坏线性。
        *   例: $y[n]=3x[n]+4$ 是**非线性**的 (因为+4)。
    2.  **时不变性**: 系统特性不随时间变化。输入延迟 $n_0$，输出也延迟 $n_0$。
        $$
        \boxed{ \text{If } y[n]=T[x[n]], \text{ then } y[n-n_0] = T[x[n-n_0]] }
        $$
        *   检查方法：计算 $T[x[n-n_0]]$，再计算 $y[n-n_0]$ (将 $y[n]$ 表达式中的 $n$ 换成 $n-n_0$)，看两者是否相等。
        *   例: $y[n]=3x[n]+4$ 是**时不变**的。
    3.  **因果性**: 输出 $y[n]$ 只取决于当前和过去的输入 $x[k]$ ($k \le n$)，不依赖于未来的输入 ($k>n$)。
        *   检查方法：看 $y[n]$ 的表达式中是否出现 $x[k]$ 且 $k>n$。
    4.  **稳定性**: 有界输入产生有界输出 (Bounded-Input Bounded-Output，BIBO)。
        $$
        \boxed{ \text{If } |x[n]| \le M_x < \infty \text{ for all } n, \text{ then } |y[n]| \le M_y < \infty \text{ for all } n }
        $$
        *   检查方法：假设输入有界，看输出是否有界。对于 LTI 系统有更简单的判据。

#### 2.5 线性时不变 (LTI) 系统 ⭐

*   **重要性**: LTI 系统理论完善，应用广泛。
*   **输入输出关系**: 完全由其**单位冲激响应** $h[n]$ 决定。
    $$
    h[n] = T[\delta[n]]
    $$
    输出 $y[n]$ 是输入 $x[n]$ 与冲激响应 $h[n]$ 的**线性卷积**：
    $$
    \boxed{ y[n] = x[n] * h[n] = \sum_{k=-\infty}^{\infty} x[k]h[n-k] = \sum_{k=-\infty}^{\infty} h[k]x[n-k] }
    $$
*   **LTI 系统的性质判据**:
    *   **因果性**: 当且仅当 $\boxed{h[n] = 0 \text{ for } n < 0}$。
    *   **稳定性 (BIBO)**: 当且仅当冲激响应 $h[n]$ 是**绝对可和** 的。
        $$
        \boxed{ \sum_{n=-\infty}^{\infty} |h[n]| < \infty }
        $$
    *   **示例**: $h[n] = a^n u[n]$。
        *   因果性：是，因为 $u[n]=0$ for $n<0$。
        *   稳定性：$\sum_{n=0}^{\infty} |a^n| = \sum_{n=0}^{\infty} |a|^n$。此几何级数收敛当且仅当 $|a|<1$。因此，系统稳定 $\iff |a|<1$。

#### 2.6 常系数线性差分方程 (LCCDE) 📝

*   **描述**: 许多 LTI 系统可以用 LCCDE 描述输入 $x[n]$ 和输出 $y[n]$ 的关系：
    $$
    \boxed{ \sum_{k=0}^{N} a_k y[n-k] = \sum_{k=0}^{M} b_k x[n-k] } \quad (a_0 \text{ 通常规范化为 } 1)
    $$
*   **分类**:
    *   **递归 (Recursive) / 无限冲激响应 (IIR - Infinite Impulse Response)**: 如果至少有一个 $a_k \ne 0$ ($k \ge 1$)。输出依赖于过去的输出 (反馈)。$h[n]$ 通常是无限长的。
        $$
        y[n] = \sum_{k=0}^{M} b_k x[n-k] - \sum_{k=1}^{N} a_k y[n-k]
        $$
    *   **非递归 (Non-recursive) / 有限冲激响应 (FIR - Finite Impulse Response)**: 如果所有 $a_k = 0$ for $k \ge 1$ (即 $N=0$)。输出只依赖于当前和过去的输入 (无反馈)。$h[n]$ 是有限长的 ($h[n] = b_n/a_0$ for $0 \le n \le M$，否则为 0)。
        $$
        y[n] = \sum_{k=0}^{M} b_k x[n-k] \quad (\text{若 } a_0=1)
        $$

---

### 3. 离散时间傅里叶变换 (DTFT)  

#### 3.1 定义 ✒️

*   **目的**: 将离散时间序列 $x[n]$ 变换到连续的频率域 $X(e^{j\omega})$。
*   🧠 **回顾**: 连续时间傅里叶变换 (CTFT)。
*   **DTFT 变换对**:
    *   **分析式 (DTFT)**:
        $$
        \boxed{ X(e^{j\omega}) = \mathcal{F}\{x[n]\} = \sum_{n=-\infty}^{\infty} x[n] e^{-j\omega n} }
        $$
    *   **综合式 (IDTFT)**:
        $$
        \boxed{ x[n] = \mathcal{F}^{-1}\{X(e^{j\omega})\} = \frac{1}{2\pi} \int_{-\pi}^{\pi} X(e^{j\omega}) e^{j\omega n} d\omega }
        $$
*   **特点**:
    *   $n$ 是离散整数变量。
    *   $\omega$ 是连续实数变量 (数字角频率)。
    *   $X(e^{j\omega})$ 是关于 $\omega$ 的**周期函数**，周期为 $2\pi$。
*   **收敛条件**: DTFT 存在的充分条件是 $x[n]$ 绝对可和: $\sum_{n=-\infty}^{\infty} |x[n]| < \infty$。

#### 3.2 DTFT 示例 💡

*   **例1**: $x[n] = a^n u[n]$, $|a|<1$。
    $$
    X(e^{j\omega}) = \sum_{n=0}^{\infty} a^n e^{-j\omega n} = \sum_{n=0}^{\infty} (a e^{-j\omega})^n = \boxed{\frac{1}{1 - a e^{-j\omega}}} \quad (\text{因为 } |ae^{-j\omega}| = |a| < 1)
    $$
*   **例2**: $x[n] = \delta[n-n_0]$。
    $$
    X(e^{j\omega}) = \sum_{n=-\infty}^{\infty} \delta[n-n_0] e^{-j\omega n} = e^{-j\omega n_0}
    $$
*   **例3**: 有限长序列 $x[n] = \{ \underset{\uparrow}{1}, 2, 3, 1 \}$ (n=0, 1, 2, 3)。
    $$
    X(e^{j\omega}) = 1 e^0 + 2 e^{-j\omega} + 3 e^{-j2\omega} + 1 e^{-j3\omega}
    $$

#### 3.3 DTFT 的重要性质 ⭐

1.  **周期性**:
    $$
    X(e^{j(\omega + 2\pi)}) = X(e^{j\omega})
    $$
    *   因此，分析 $X(e^{j\omega})$ 只需在一个 $2\pi$ 区间内进行，如 $[-\pi, \pi]$ 或 $[0, 2\pi]$。
2.  **线性**:
    $$
    a x_1[n] + b x_2[n] \stackrel{\mathcal{F}}{\longleftrightarrow} a X_1(e^{j\omega}) + b X_2(e^{j\omega})
    $$
3.  **时移与频移**:
    $$
    x[n-n_0] \stackrel{\mathcal{F}}{\longleftrightarrow} e^{-j\omega n_0} X(e^{j\omega})
    $$
    $$
    e^{j\omega_0 n} x[n] \stackrel{\mathcal{F}}{\longleftrightarrow} X(e^{j(\omega - \omega_0)})
    $$
4.  **卷积定理**:
    *   **时域卷积**:
        $$
        \boxed{ x[n] * h[n] \stackrel{\mathcal{F}}{\longleftrightarrow} X(e^{j\omega}) H(e^{j\omega}) }
        $$
    *   **频域卷积 (时域相乘)**:
        $$
        x[n] h[n] \stackrel{\mathcal{F}}{\longleftrightarrow} \frac{1}{2\pi} X(e^{j\omega}) * H(e^{j\omega}) = \frac{1}{2\pi} \int_{-\pi}^{\pi} X(e^{j\theta}) H(e^{j(\omega-\theta)}) d\theta
        $$
5.  **对称性**:
    *   对于**任意序列** $x[n]$:
        *   $x[n] = x_e[n] + x_o[n]$ (共轭对称 + 共轭反对称)
        *   $X(e^{j\omega}) = X_e(e^{j\omega}) + X_o(e^{j\omega})$
    *   对于**实序列** $x[n]$ ($x[n]=x^*[n]$):
        *   $X(e^{j\omega}) = X^*(e^{-j\omega})$ (**共轭对称**)
        *   $|X(e^{j\omega})|$ 是 $\omega$ 的**偶函数**。
        *   $\angle X(e^{j\omega})$ 是 $\omega$ 的**奇函数**。
        *   $\text{Re}[X(e^{j\omega})]$ 是 $\omega$ 的**偶函数** ($x_{even}[n] \leftrightarrow \text{Re}[X]$)。
        *   $\text{Im}[X(e^{j\omega})]$ 是 $\omega$ 的**奇函数** ($x_{odd}[n] \leftrightarrow j\text{Im}[X]$)。[推导-1](推导/推导-1.md)
        *   因此，对于实序列，只需分析 $0 \le \omega \le \pi$ 区间的频谱特性即可。
6.  **帕塞瓦尔定理 (Parseval's Theorem - 能量守恒)**:
    $$
    \boxed{ \sum_{n=-\infty}^{\infty} |x[n]|^2 = \frac{1}{2\pi} \int_{-\pi}^{\pi} |X(e^{j\omega})|^2 d\omega }
    $$
    时域能量等于频域能量密度积分 (乘以 $1/2\pi$)。

#### 3.4 LTI 系统的频率响应 H(e^{jω})

*   **定义**: LTI 系统的频率响应是其**冲激响应 $h[n]$ 的 DTFT**。
    $$
    \boxed{ H(e^{j\omega}) = \sum_{n=-\infty}^{\infty} h[n] e^{-j\omega n} }
    $$
*   **意义**:
    *   当输入为复指数 $e^{j\omega n}$ 时，LTI 系统的输出为 $y[n] = H(e^{j\omega}) e^{j\omega n}$。即 $H(e^{j\omega})$ 是系统对频率 $\omega$ 的**特征值**。
    *   对于任意输入 $x[n]$，其输出的 DTFT 为 $Y(e^{j\omega}) = H(e^{j\omega}) X(e^{j\omega})$。
*   **表示**: $H(e^{j\omega})$ 是复函数，可表示为:
    $$
    H(e^{j\omega}) = |H(e^{j\omega})| e^{j \phi(\omega)}
    $$
    *   $|H(e^{j\omega})|$: **幅度响应** 或 **增益**。表示系统对不同频率分量的放大或衰减程度。
    *   $\phi(\omega) = \angle H(e^{j\omega})$: **相位响应**。表示系统对不同频率分量引入的相位移。
*   **群延迟**: 描述不同频率分量通过系统时的时间延迟差异。
    $$
    \boxed{ \tau_g(\omega) = -\frac{d\phi(\omega)}{d\omega} }
    $$
    *   **线性相位 (Linear Phase)**: $\phi(\omega) = -k\omega + \beta$。此时群延迟 $\tau_g(\omega) = k$ 为常数，意味着所有频率分量具有相同的延迟，波形不会失真 (只有幅度变化和整体时移)。

#### 3.5 频率响应计算示例 🧮

*   **例1**: $y[n] = -0.85y[n-1] + 0.5x[n]$。
    对差分方程两边取 DTFT：
    $Y(e^{j\omega}) = -0.85 e^{-j\omega} Y(e^{j\omega}) + 0.5 X(e^{j\omega})$
    $Y(e^{j\omega}) (1 + 0.85 e^{-j\omega}) = 0.5 X(e^{j\omega})$
    $$
    H(e^{j\omega}) = \frac{Y(e^{j\omega})}{X(e^{j\omega})} = \boxed{\frac{0.5}{1 + 0.85 e^{-j\omega}}}
    $$
*   **例2**: $h[n] = 0.9^n u[n]$。
    $$
    H(e^{j\omega}) = \frac{1}{1 - 0.9 e^{-j\omega}}
    $$
    幅度响应: $|H(e^{j\omega})| = \frac{1}{|1 - 0.9e^{-j\omega}|} = \frac{1}{\sqrt{(1-0.9\cos\omega)^2 + (-0.9\sin\omega)^2}} = \frac{1}{\sqrt{1.81 - 1.8\cos\omega}}$
    相位响应: $\phi(\omega) = -\angle(1 - 0.9e^{-j\omega}) = -\arctan\left(\frac{-0.9\sin\omega}{1-0.9\cos\omega}\right)$

---

### 4. Z 变换 (Z-Transform) 💤

#### 4.1 引入动机 💡

*   DTFT 不适用于所有序列 (如 $a^n u[n]$ 当 $|a| \ge 1$)。
*   DTFT 求解 LCCDE 较为复杂。
*   Z 变换是 DTFT 的推广，类似拉普拉斯变换之于傅里叶变换。可以将差分方程转化为代数方程，便于系统分析和设计。

#### 4.2 定义 ✒️

*   **双边 Z 变换**:
    $$
    \boxed{ X(z) = Z\{x[n]\} = \sum_{n=-\infty}^{\infty} x[n] z^{-n} }
    $$
    其中 $z$ 是一个复变量。
*   **单边 Z 变换**: (常用于因果系统或已知初始条件)
    $$
    X(z) = \sum_{n=0}^{\infty} x[n] z^{-n}
    $$
    (本笔记主要关注双边 Z 变换)

#### 4.3 收敛域 (ROC) 🌐

*   **定义**: Z 变换 $X(z)$ 是一个关于 $z$ 的幂级数，它只在某些 $z$ 值下收敛。使 $X(z)$ 的求和绝对收敛的 $z$ 值集合称为**收敛域 (ROC)**。
    $$
    \text{ROC} = \{ z \in \mathbb{C} \mid \sum_{n=-\infty}^{\infty} |x[n] z^{-n}| < \infty \}
    $$
*   **重要性**: Z 变换表达式本身不足以唯一确定序列 $x[n]$，必须**同时指定 ROC**。
*   **ROC 的性质**:
    1.  ROC 是 Z 平面上的一个**环状区域**: $r_1 < |z| < r_2$。可能扩展到 $r_1=0$ 或 $r_2=\infty$。
    2.  ROC **不包含任何极点**。$X(z)$ 在 ROC 内是解析函数。
    3.  对于**有限长序列** (Finite-duration Sequence)，ROC 是整个 Z 平面，可能除去 $z=0$ 或 $z=\infty$。
    4.  对于**右边序列** (Right-sided Sequence, $x[n]=0$ for $n<N_1$)，ROC 是某个圆 $|z|=r_1$ 的**外部区域** ($|z|>r_1$)，并可能包含 $z=\infty$。
    5.  对于**左边序列** (Left-sided Sequence, $x[n]=0$ for $n>N_2$)，ROC 是某个圆 $|z|=r_2$ 的**内部区域** ($|z|<r_2$)，并可能包含 $z=0$。
    6.  对于**双边序列** (Two-sided Sequence)，ROC 是环状区域 $r_1 < |z| < r_2$ (如果存在)。
    7.  ROC 必定是一个**连通区域**。

#### 4.4 Z 反变换 (Inverse Z-Transform, IZT) 🔙

*   **目的**: 从 $X(z)$ 和 ROC 恢复 $x[n]$。
*   **方法**:
    1.  **幂级数展开法 (长除法)**: 将 $X(z)$ 展开成 $z^{-1}$ 的幂级数 (用于因果序列) 或 $z$ 的幂级数 (用于反因果序列)。系数即为 $x[n]$。
    2.  **部分分式展开法 (Partial Fraction Expansion, PFE)**: 将有理函数 $X(z)$ 分解为简单分式的和，然后利用已知的 Z 变换对查表得到各项对应的 $x[n]$。需要结合 ROC 判断序列是左边还是右边。
    3.  **围线积分法 (留数法 - Residue Method)**: 基于复变函数理论。
        $$
        \boxed{ x[n] = \frac{1}{2\pi j} \oint_C X(z) z^{n-1} dz }
        $$
        其中 $C$ 是在 ROC 内包围原点的逆时针简单闭合围线。根据留数定理，积分值等于围线 $C$ 内部 $X(z)z^{n-1}$ 所有极点的留数之和。
        $$
        x[n] = \sum_{\text{poles } z_k \text{ inside } C} \text{Res}[X(z)z^{n-1}, z_k]
        $$
        *   **注意**: 求解 $x[n]$ 时，被积函数是 $X(z)z^{n-1}$，其极点可能与 $X(z)$ 不同 (尤其在 $z=0$ 处)。
        *   **留数计算**:
            *   单极点 $z_0$: $\lim_{z \to z_0} (z-z_0) X(z)z^{n-1}$
            *   $K$ 阶极点 $z_0$: $\frac{1}{(K-1)!} \lim_{z \to z_0} \frac{d^{K-1}}{dz^{K-1}} [(z-z_0)^K X(z)z^{n-1}]$
        *   **留数辅助定理**: 如果 $X(z)z^{n-1}$ 在 $|z|=\infty$ 处留数为零 (通常分母z的最高次幂比分子高至少2)，则 $x[n] = - \sum_{\text{poles } z_m \text{ outside } C} \text{Res}[X(z)z^{n-1}, z_m]$。这在围线外极点简单时有用。
        *   **结合 ROC**:
            *   若 $x[n]$ 为右边序列 (ROC: $|z|>r_1$)，通常计算 $n \ge 0$ 的值，围线 $C$ 取在 ROC 内，包含所有 $X(z)$ 的极点。
            *   若 $x[n]$ 为左边序列 (ROC: $|z|<r_2$)，通常计算 $n < 0$ 的值，此时用留数辅助定理，计算围线外极点 (包括 $z=\infty$，但通常为 0) 的留数和，再取负。
            *   若 $x[n]$ 为双边序列 (ROC: $r_1<|z|<r_2$)，则 $n \ge 0$ 时用围线内极点 ($|z_k|<r_2$) 计算，$n<0$ 时用留数辅助定理，计算围线外极点 ($|z_m|>r_1$) 的留数和取负。

#### 4.5 Z 变换示例 💡

*   **例**: $X(z) = \frac{-3z}{2(z-2)(z-0.5)}$。
    *   **Case 1**: ROC $0.5 < |z| < 2$ (双边)。
        *   For $n \ge 0$: 极点 $z=0.5$ 在 ROC 内。 $x[n] = \text{Res}[X(z)z^{n-1}, 0.5] = (0.5)^n$。
        *   For $n < 0$: 极点 $z=2$ 在 ROC 外。 $x[n] = -\text{Res}[X(z)z^{n-1}, 2] = -(-2^n) = 2^n$。
        *   $x[n] = (0.5)^n u[n] + 2^n u[-n-1]$。
    *   **Case 2**: ROC $|z| > 2$ (右边/因果)。
        *   For $n \ge 0$: 极点 $z=0.5$ 和 $z=2$ 都在 ROC 内 (围线可选 $|z|>2$)。
        *   $x[n] = \text{Res}[..., 0.5] + \text{Res}[..., 2] = (0.5)^n + (-2^n)$。
        *   $x[n] = [(0.5)^n - 2^n] u[n]$。
    *   **Case 3**: ROC $|z| < 0.5$ (左边/反因果)。
        *   For $n < 0$: 极点 $z=0.5, 2$ 都在 ROC 外。
        *   $x[n] = -(\text{Res}[..., 0.5] + \text{Res}[..., 2]) = -((0.5)^n + (-2^n))$。
        *   $x[n] = [- (0.5)^n + 2^n] u[-n-1]$。

---

### 5. LTI 系统的 Z 域分析 📈

#### 5.1 系统函数 H(z)

*   **定义**: LTI 系统的冲激响应 $h[n]$ 的 Z 变换。
    $$
    H(z) = Z\{h[n]\} = \sum_{n=-\infty}^{\infty} h[n] z^{-n}
    $$
*   **输入输出关系**: 对于 LTI 系统 $y[n]=x[n]*h[n]$，两边取 Z 变换得到：
    $$
    Y(z) = X(z) H(z)
    $$
    因此，系统函数也等于输出 Z 变换与输入 Z 变换之比：
    $$
    \boxed{ H(z) = \frac{Y(z)}{X(z)} } \quad (\text{需要指定 ROC})
    $$
	*   **对于 LCCDE 系统**:
	    $$
	    H(z) = \frac{\sum_{k=0}^{M} b_k z^{-k}}{\sum_{k=0}^{N} a_k z^{-k}} = z^{N-M} \frac{\sum_{k=0}^{M} b_k z^{M-k}}{\sum_{k=0}^{N} a_k z^{N-k}} = \frac{B(z)}{A(z)}
	    $$
	    $H(z)$ 是一个有理函数。

#### 5.2 LTI 系统的稳定性与因果性 (Z 域判据) ⭐

*   **稳定性**: LTI 系统稳定 $\iff \sum |h[n]| < \infty \iff H(z)$ 的 **ROC 包含单位圆** $|z|=1$。
*   **因果性**: LTI 系统因果 $\iff h[n]=0$ for $n<0 \iff H(z)$ 的 **ROC 是某个圆 $|z|=r_{max}$ 的外部区域**，且 $H(z)$ 在 $z=\infty$ 处收敛 (即 $H(z)$ 的分子 $z$ 次幂不高于分母)。
*   **因果 LTI 系统的稳定性**:
    *   一个因果 LTI 系统是稳定的 $\iff$ **$H(z)$ 的所有极点都在单位圆内部** ($|p_k|<1$)。
    *   此时 ROC 为 $|z| > \max_k |p_k|$，且由于 $\max_k |p_k| < 1$，该 ROC 必然包含单位圆。

#### 5.3 零极点 📍

*   **定义**:
    *   **零点 (Zeros)**: 使 $H(z)=0$ 的 $z$ 值 (通常指 $B(z)=0$ 的根)。
    *   **极点 (Poles)**: 使 $H(z)=\infty$ 的 $z$ 值 (通常指 $A(z)=0$ 的根)。
*   **表示**: $H(z)$ 可以表示为零极点形式：
    $$
    H(z) = A \frac{\prod_{i=1}^{M} (z-c_i)}{\prod_{k=1}^{N} (z-d_k)}
    $$
    $c_i$ 是零点，$d_k$ 是极点，$A$ 是增益常数。
*   **零极点图**: 在 Z 平面上标记出零点 (用 'o') 和极点 (用 'x') 的位置。结合 ROC 可以完全描述一个 LTI 系统。

#### 5.4 零极点与频率响应的关系 📉➡️📈

*   **频率响应**: $H(e^{j\omega}) = H(z)|_{z=e^{j\omega}}$ (要求单位圆在 ROC 内)。
*   **几何解释**:
    *   **幅度响应**:
        $$
        |H(e^{j\omega})| = |A| \frac{\prod_{i=1}^{M} |e^{j\omega}-c_i|}{\prod_{k=1}^{N} |e^{j\omega}-d_k|} = |A| \frac{\text{到各零点的距离之积}}{\text{到各极点的距离之积}}
        $$
        *   当 $e^{j\omega}$ 靠近极点 $d_k$ 时，分母小，幅度 $|H|$ 增大 (产生**峰值**)。
        *   当 $e^{j\omega}$ 靠近零点 $c_i$ 时，分子小，幅度 $|H|$ 减小 (产生**谷值**)。
        *   极点在单位圆上 $\implies$ 响应无限大 (不稳定)。零点在单位圆上 $\implies$ 响应为零。
    *   **相位响应**:
        $$
        \angle H(e^{j\omega}) = \angle A + \sum_{i=1}^{M} \angle(e^{j\omega}-c_i) - \sum_{k=1}^{N} \angle(e^{j\omega}-d_k)
        $$
        等于 (从零点到 $e^{j\omega}$ 的向量角之和) - (从极点到 $e^{j\omega}$ 的向量角之和) + $\angle A$。
*   **滤波特性**: 通过配置零极点的位置，可以设计出具有特定频率响应 (如低通、高通、带通、带阻) 的滤波器。
    *   低通: 极点靠近 $z=1$ ($\omega=0$)，零点靠近 $z=-1$ ($\omega=\pi$)。
    *   高通: 极点靠近 $z=-1$，零点靠近 $z=1$。
    *   带通: 极点靠近单位圆上 $\omega_0$ 对应的 $e^{j\omega_0}$ 处，零点在 $z=1$ 和 $z=-1$ 处。
    *   带阻: 零点靠近单位圆上 $\omega_0$ 对应的 $e^{j\omega_0}$ 处，极点用于调整通带特性。

#### 5.5 Z 变换与 DTFT 的关系 🔗

*   **DTFT 是 Z 变换在单位圆上的特殊情况**:
    $$
    \boxed{ X(e^{j\omega}) = X(z)|_{z=e^{j\omega}} }
    $$
*   这要求 $X(z)$ 的 **ROC 包含单位圆**。
*   DTFT 的所有性质都可以看作是 Z 变换性质在单位圆上的体现。


---

### 6. 特殊类型的 LTI 系统 🌟

#### 6.1 全通系统

*   **定义**: 幅度响应 $|H(e^{j\omega})|$ 在所有频率上恒为常数 (通常为 1) 的系统。
    $$
    |H_{ap}(e^{j\omega})| = \text{Constant} \quad (\text{e.g., } 1)
    $$
*   **系统函数结构**: 对于实系数因果稳定全通系统，其零极点具有**共轭倒数**关系。如果 $d_k$ 是极点，则 $1/d_k^*$ 是零点。
    $$
    H_{ap}(z) = A \prod_{k} \frac{z^{-1} - d_k^*}{1 - d_k z^{-1}} \quad \text{or} \quad H_{ap}(z) = A z^{-N} \frac{A(z^{-1})}{A(z)}
    $$
    极点 $d_k$ 在单位圆内，对应的零点 $1/d_k^*$ 在单位圆外。
![](Pic/Pasted%20image%2020250421160616.png)
*   **作用**: 主要用于**相位补偿**或**相位均衡**，不改变信号幅度谱。

#### 6.2 最小相位系统

*   **定义**: 一个因果稳定的 LTI 系统，其**所有零点都在单位圆内部** ($|c_i|<1$)。
*   **性质**:
    1.  系统函数 $H(z)$ 和其逆系统 $1/H(z)$ 都是因果稳定的。
    2.  在所有具有相同幅度响应 $|H(e^{j\omega})|$ 的系统中，最小相位系统具有**最小的群延迟**和**最小的能量延迟**。
*   **分解**: 任何有理的因果稳定系统函数 $H(z)$ 都可以分解为一个最小相位系统 $H_{min}(z)$ 和一个全通系统 $H_{ap}(z)$ 的级联：
    $$
    H(z) = H_{min}(z) H_{ap}(z)
    $$
    $H_{ap}(z)$ 将 $H(z)$ 中位于单位圆外的零点通过共轭倒数关系移到内部，形成 $H_{min}(z)$。
*   **相位关系**: $\angle H(e^{j\omega}) = \angle H_{min}(e^{j\omega}) + \angle H_{ap}(e^{j\omega})$。

---

### 7. 离散傅里叶级数 (DFS) 🔄∑

#### 7.1 定义 ✒️

*   **适用对象**: 周期为 $N$ 的离散时间序列 $\tilde{x}[n]$。
*   **目的**: 将周期序列表示为一组 $N$ 个**谐波相关的复指数序列**的线性组合。
*   **DFS 变换对**:
    *   **综合式**:
        $$
        \boxed{ \tilde{x}[n] = \frac{1}{N} \sum_{k=0}^{N-1} \tilde{X}[k] e^{j (2\pi/N) kn} = \frac{1}{N} \sum_{k=0}^{N-1} \tilde{X}[k] W_N^{-kn} } \quad (W_N = e^{-j 2\pi/N})
        $$
    *   **分析式**:
        $$
        \boxed{ \tilde{X}[k] = \sum_{n=0}^{N-1} \tilde{x}[n] e^{-j (2\pi/N) kn} = \sum_{n=0}^{N-1} \tilde{x}[n] W_N^{kn} }
        $$
*   $\tilde{X}[k]$ 称为 $\tilde{x}[n]$ 的 **离散傅里叶级数系数**，它本身也是一个周期为 $N$ 的序列。

#### 7.2 DFS 的性质与理解 🤔

*   **周期性**: $\tilde{X}[k]$ 是周期为 $N$ 的序列，$\tilde{X}[k] = \tilde{X}[k+N]$。
*   **时域与频域**: $\tilde{x}[n]$ (时域，周期N) 与 $\tilde{X}[k]$ (频域，周期N) 构成一个变换对。
*   **频率成分**:
    *   **直流分量 (DC Component)**: $k=0$ 对应的系数 $\tilde{X}[0] = \sum_{n=0}^{N-1} \tilde{x}[n]$，表示序列在一个周期内的和。平均值为 $\tilde{X}[0]/N$。
    *   **基波/一次谐波**: $k=1$ 对应的频率 $\omega_1 = 2\pi/N$。
    *   **k 次谐波**: $k$ 对应的频率 $\omega_k = k(2\pi/N)$。$\tilde{X}[k]$ 反映了第 $k$ 次谐波分量的复幅度。
*   **与 DTFT 的关系**: 如果 $x[n]$ 是一个长度为 $N$ 的有限长序列，将其周期延拓得到 $\tilde{x}[n]$。则 $\tilde{x}[n]$ 的 DFS 系数 $\tilde{X}[k]$ 是 $x[n]$ 的 DTFT $X(e^{j\omega})$ 在 $\omega = 2\pi k / N$ 处的**采样值**。
    $$
    \tilde{X}[k] = X(e^{j\omega})|_{\omega = 2\pi k / N}
    $$
*   **频谱**: DFS 得到的是**离散频谱 (线谱)**，只在 $N$ 个谐波频率点上有值。而 DTFT 得到的是**连续频谱**。

#### 7.3 DFS 示例 💡

*   **例**: $\tilde{x}[n] = \{..., 0, 1, 2, 3, 0, 1, 2, 3, ...\}$, 周期 N=4。
    计算 $\tilde{X}[k]$ for $k=0, 1, 2, 3$ ($W_4 = e^{-j2\pi/4} = -j$):
    *   $\tilde{X}[0] = x[0]W_4^0 + x[1]W_4^0 + x[2]W_4^0 + x[3]W_4^0 = 0+1+2+3 = 6$
    *   $\tilde{X}[1] = x[0]W_4^0 + x[1]W_4^1 + x[2]W_4^2 + x[3]W_4^3 = 0(1) + 1(-j) + 2(-j)^2 + 3(-j)^3 = -j + 2(-1) + 3(j) = -2 + 2j$
    *   $\tilde{X}[2] = x[0]W_4^0 + x[1]W_4^2 + x[2]W_4^4 + x[3]W_4^6 = 0(1) + 1(-1) + 2(1) + 3(-1) = -1 + 2 - 3 = -2$
    *   $\tilde{X}[3] = x[0]W_4^0 + x[1]W_4^3 + x[2]W_4^6 + x[3]W_4^9 = 0(1) + 1(j) + 2(-1) + 3(-j) = j - 2 - 3j = -2 - 2j$

---

### 本章小结 📌

*   ✅ **取样定理**: 熟练掌握 $f_s \ge 2f_m$ 的条件和奈奎斯特频率的概念，理解混叠现象。
*   ✅ **序列**: 掌握序列的概念、基本运算 (卷积、累加)、常用序列 (脉冲、阶跃、正弦、复指数) 及其周期性判别。
*   ✅ **LTI 系统**: 掌握线性、时不变、因果、稳定等概念及判断方法。理解 LTI 系统由 $h[n]$ 完全描述，输出是 $x[n]*h[n]$。掌握 LTI 系统因果性和稳定性的充要条件 ($\sum|h[n]|<\infty$, $h[n]=0 \text{ for } n<0$)。
*   ✅ **DTFT**: 掌握 DTFT 定义、性质 (周期性、线性、卷积、对称性、Parseval)，理解频率响应 $H(e^{j\omega})$ 的概念及其与 $h[n]$ 的关系。
*   ✅ **Z 变换**: 掌握 Z 变换定义、ROC 的概念和性质、反变换方法 (特别是留数法)。
*   ✅ **系统函数**: 理解 $H(z)$ 的定义、与 LCCDE 的关系、零极点的概念。
*   ✅ **稳定性与频响**: 掌握 Z 域中判断因果 LTI 系统稳定性的方法 (所有极点在单位圆内)，理解零极点位置对频率响应 $|H(e^{j\omega})|$ 和 $\angle H(e^{j\omega})$ 的几何影响。
*   ✅ **DFS**: 理解对周期序列的频域表示方法，掌握 DFS 变换对，了解其与 DTFT 的关系 (采样关系)。
*   ✅ **变换关系**: 理解 DTFT 是 Z 变换在单位圆上的体现。

---